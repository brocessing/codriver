!function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/copilote/",e(e.s=107)}([function(t,e,n){"use strict";var i=n(16),o="__STORE.",r={},a={watch:function(t,e){i.a.on(o+t,e)},watchOnce:function(t,e){i.a.once(o+t,e)},unwatch:function(t,e){i.a.off(o+t,e)},get:function(t){return r[t]},set:function(t,e){r[t]=e,i.a.emit(o+t,e)}};e.a=a},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(146),o=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,o.default)(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}()},function(t,e,n){t.exports={default:n(144),__esModule:!0}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(94),o=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":(0,o.default)(e))&&"function"!=typeof e?t:e}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var o=n(161),r=i(o),a=n(165),s=i(a),u=n(94),c=i(u);e.default=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":(0,c.default)(e)));t.prototype=(0,s.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(r.default?(0,r.default)(t,e):t.__proto__=e)}},function(t,e,n){"use strict";var i=n(0),o=n(133),r=n(134),a=window.location.hash&&"#lofi"===window.location.hash;e.a={lofi:a,datgui:!1,fpsCounter:0,enableSpeech:!0,quickstart:0,manualDrive:0,speechDebug:!1,locDebug:!1,debug:!1,p2steps:1/60,viewDistance:3,chunkSize:11,background:a?0:9228700,cullingMin:a?.1:.07,cullingMax:a?5:9,vendors:["vendors/dat.gui.min.js","vendors/howler.min.js","vendors/p2.min.js","vendors/three.min.js"],threeDependencies:["vendors/three/EffectComposer.js","vendors/three/CopyShader.js","vendors/three/ShaderPass.js","vendors/three/RenderPass.js","vendors/three/OutlinePass.js","vendors/three/LuminosityHighPassShader.js","vendors/three/UnrealBloomPass.js"],blobs:{"ui/button.gif":"cta","ui/button-back.gif":"cta.shadow","ui/button-ground.gif":"cta.ground","ui/logo.gif":"logo"},images:{"ui/faces/face-0-0.gif":"face.0.0","ui/faces/face-0-1.gif":"face.0.1","ui/faces/face-0-2.gif":"face.0.2","ui/faces/face-1-0.gif":"face.1.0","ui/faces/face-1-1.gif":"face.1.1","ui/faces/face-1-2.gif":"face.1.2","ui/faces/face-2-0.gif":"face.2.0","ui/faces/face-2-1.gif":"face.2.1","ui/faces/face-2-2.gif":"face.2.2","ui/right.gui.gif":"gui.right","ui/left.gui.gif":"gui.left","ui/left.gui.panic.gif":"gui.left.panic","ui/bubbles/straight.png":"bubble.straight","ui/bubbles/right.png":"bubble.right","ui/bubbles/uturn.png":"bubble.uturn","ui/bubbles/left.png":"bubble.left","ui/bubbles/speedup.png":"bubble.speedup","ui/bubbles/speeddown.png":"bubble.speeddown","ui/bubbles/wheel.png":"bubble.wheel","ui/bubbles/radio.png":"bubble.radio"},cube:["cube/px.jpg","cube/nx.jpg","cube/py.jpg","cube/ny.jpg","cube/pz.jpg","cube/nz.jpg"],initCommonMaterials:function(){i.a.set("mat.ground",new THREE.MeshBasicMaterial({color:16767560})),i.a.set("mat.orange",new THREE.MeshBasicMaterial({color:16169033})),i.a.set("mat.red",new THREE.MeshBasicMaterial({color:16711680})),i.a.set("mat.green",new THREE.MeshBasicMaterial({color:65280})),i.a.set("mat.blue",new THREE.MeshBasicMaterial({color:255})),i.a.set("mat.gray",new THREE.MeshBasicMaterial({color:5921370})),i.a.set("mat.shadow",new THREE.MeshBasicMaterial({color:0,transparent:!0,opacity:.7})),i.a.set("mat.wireframe",new THREE.MeshBasicMaterial({color:16711680,wireframe:!0})),i.a.set("mat.wfwhite",new THREE.MeshBasicMaterial({color:16777215,wireframe:!0})),i.a.set("mat.wfgray",new THREE.MeshBasicMaterial({color:10066329,wireframe:!0}))},initCommonGeometries:function(){i.a.set("geo.box",new THREE.BoxBufferGeometry(1,1,1)),i.a.set("geo.plane",new THREE.PlaneBufferGeometry(1,1))},textures:{"textures/smoke.png":function(t){t.format=THREE.RGBFormat,t.magFilter=THREE.NearestFilter,t.minFilter=THREE.NearestFilter,t.needsUpdate=!0,i.a.set("tex.smoke",t)},"textures/vehicles.png":function(t){t.format=THREE.RGBFormat,t.magFilter=THREE.NearestFilter,t.minFilter=THREE.LinearFilter,t.needsUpdate=!0,i.a.set("tex.vehicles",t)},"textures/props.png":function(t){t.format=THREE.RGBFormat,t.magFilter=THREE.NearestFilter,t.minFilter=THREE.LinearFilter,t.needsUpdate=!0,i.a.set("tex.props",t)},"textures/skybox.png":function(t){t.format=THREE.RGBFormat,t.magFilter=THREE.NearestFilter,t.minFilter=THREE.LinearFilter,t.needsUpdate=!0,t.needsUpdate=!0,i.a.set("tex.landscape",t)},"textures/roads.png":function(t){var e=[];if(i.a.set("geo.roads",e),a){i.a.set("mat.road",i.a.get("mat.wfgray"));for(var n=Object(o.a)({x:0,y:1,tileSize:1,texSize:1}),s=0;s<5;s++)e[s]=n}else t.format=THREE.RGBFormat,t.magFilter=THREE.NearestFilter,t.minFilter=THREE.LinearFilter,t.needsUpdate=!0,i.a.set("tex.road",t),i.a.set("mat.road",r.a.getMaterial()),e[0]=Object(o.a)({x:1,y:129,tileSize:126,texSize:512}),e[1]=Object(o.a)({x:1,y:385,tileSize:126,texSize:512}),e[2]=Object(o.a)({x:129,y:129,tileSize:126,texSize:512}),e[3]=Object(o.a)({x:1,y:257,tileSize:126,texSize:512}),e[4]=Object(o.a)({x:129,y:257,tileSize:126,texSize:512}),e[5]=Object(o.a)({x:257,y:129,tileSize:126,texSize:512}),e[6]=Object(o.a)({x:257,y:385,tileSize:126,texSize:512}),e[7]=Object(o.a)({x:385,y:129,tileSize:126,texSize:512}),e[8]=Object(o.a)({x:257,y:257,tileSize:126,texSize:512}),e[9]=Object(o.a)({x:385,y:257,tileSize:126,texSize:512}),e[10]=Object(o.a)({x:129,y:385,tileSize:126,texSize:512})}},objects:{"models/bandit.json":function(t,e){t.scale(.4,.4,.4),t.translate(0,0,0);var n=(new THREE.BufferGeometry).fromGeometry(t);i.a.set("geo.bandit",n)},"models/cop.json":function(t,e){t.scale(.4,.4,.4),t.translate(0,0,0);var n=(new THREE.BufferGeometry).fromGeometry(t);i.a.set("geo.cop",n)},"models/siren.json":function(t,e){t.scale(.4,.4,.4),t.translate(0,0,0);var n=(new THREE.BufferGeometry).fromGeometry(t);i.a.set("geo.siren",n)},"models/bank.json":function(t,e){t.scale(.5,.5,.5),t.translate(0,0,1);var n=(new THREE.BufferGeometry).fromGeometry(t);i.a.set("geo.bank",n)},"models/farm.json":function(t,e){t.scale(.5,.5,.5),t.translate(-2,0,-1);var n=(new THREE.BufferGeometry).fromGeometry(t);i.a.set("geo.farm",n)},"models/hangar.json":function(t,e){t.scale(.5,.5,.5),t.translate(-2,0,1);var n=(new THREE.BufferGeometry).fromGeometry(t);i.a.set("geo.hangar",n)},"models/station.json":function(t,e){t.scale(.5,.5,.5),t.translate(-1,0,1);var n=(new THREE.BufferGeometry).fromGeometry(t);i.a.set("geo.station",n)},"models/house.json":function(t,e){t.scale(.5,.5,.5),t.translate(4,0,1);var n=(new THREE.BufferGeometry).fromGeometry(t);i.a.set("geo.house",n)},"models/trashyard.json":function(t,e){t.scale(.5,.5,.5),t.translate(1,0,-1);var n=(new THREE.BufferGeometry).fromGeometry(t);i.a.set("geo.trashyard",n)},"models/rock_2x.json":function(t,e){t.scale(.5,.5,.5),t.translate(4,0,-2);var n=(new THREE.BufferGeometry).fromGeometry(t);i.a.set("geo.rock.2x",n)},"models/rock_medium.json":function(t,e){t.scale(.5,.5,.5),t.translate(3,0,-1);var n=(new THREE.BufferGeometry).fromGeometry(t);i.a.set("geo.rock.medium",n)},"models/rock_small.json":function(t,e){t.scale(.5,.5,.5),t.translate(2,0,-1);var n=(new THREE.BufferGeometry).fromGeometry(t);i.a.set("geo.rock.small",n)},"models/cactus.json":function(t,e){t.scale(.5,.5,.5),t.translate(-3,0,1);var n=(new THREE.BufferGeometry).fromGeometry(t);i.a.set("geo.cactus",n)},"models/nature_2x.json":function(t,e){t.scale(.5,.5,.5),t.translate(-4,0,-2);var n=(new THREE.BufferGeometry).fromGeometry(t);i.a.set("geo.nature2x",n)},"models/ad.json":function(t,e){t.scale(.5,.5,.5),t.translate(2,0,1);var n=(new THREE.BufferGeometry).fromGeometry(t);i.a.set("geo.ad",n)},"models/sign.json":function(t,e){t.scale(.5,.5,.5),t.translate(1,0,1);var n=(new THREE.BufferGeometry).fromGeometry(t);i.a.set("geo.sign",n)},"models/accident.json":function(t,e){t.scale(.5,.5,.5),t.translate(3,0,1);var n=(new THREE.BufferGeometry).fromGeometry(t);i.a.set("geo.accident",n)},"models/motel.json":function(t,e){t.scale(.5,.5,.5),t.translate(-1,0,-1);var n=(new THREE.BufferGeometry).fromGeometry(t);i.a.set("geo.motel",n)},"models/cigarette.json":function(t,e){t.scale(.5,.5,.5),t.translate(0,0,-1);var n=(new THREE.BufferGeometry).fromGeometry(t);i.a.set("geo.cigarette",n)}},chunks:{folder:"chunks",count:16,onchunkload:function(t,e){i.a.get("map.chunks")||i.a.set("map.chunks",[]),i.a.get("map.chunks")[t]=e}}}},function(t,e,n){"use strict";function i(t){C=new p2.World({gravity:[0,0]}),S=new THREE.Scene,w.a.setup(),P=w.a.getCamera(),T=new THREE.WebGLRenderer({antialias:!b.a.lofi}),T.setClearColor(9228700,1),g.a.set("pixelratio","HD"===g.a.get("quality")?Math.min(window.devicePixelRatio,1.5):1),T.setPixelRatio(g.a.get("pixelratio")),b.a.fpsCounter&&(O=Object(E.a)(T)),o(),_.a.setup();var e=M()(l,250);g.a.watch("size",e),l(g.a.get("size")),t.appendChild(T.domElement),C.on("impact",r),C.solver.tolerance=2,T.autoClear=!1}function o(){var t=new THREE.RenderPass(S,P);t.renderToScreen=!0,R=new THREE.EffectComposer(T),R.addPass(t),I=!1}function r(t){var e=t.bodyA,n=t.bodyB;if(e&&e.propType&&n&&n.propType){var i=e.propType,o=n.propType;i===o&&(e.impactCallback?e.impactCallback({impactType:o}):n.impactCallback&&n.impactCallback({impactType:i})),e.impactCallback&&e.impactCallback({impactType:o}),n.impactCallback&&n.impactCallback({impactType:i})}}function a(){m.a.add(h)}function s(){m.a.remove(h)}function u(t){S&&!~F.indexOf(t)&&t.group&&(S.add(t.group),F.push(t))}function c(t){var e=F.indexOf(t);S&&~e&&t.group&&(S.remove(t.group),F.splice(e,1))}function h(t){C.step(b.a.p2steps),F.forEach(function(e){return e.update(t)}),T.clear(),T.render(_.a.scene,_.a.camera),T.render(S,P),O&&O.update()}function l(t){if(T){P.aspect=t.w/t.h,P.updateProjectionMatrix(),T.setSize(t.w,t.h);var e=T.getPixelRatio(),n=Math.floor(t.w/e)||1,i=Math.floor(t.h/e)||1;R.setSize(n,i),F.forEach(function(e){return e.resize(t)})}}function d(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;e.position.x=-t.position[0]-n,e.position.z=t.position[1]-i,e.rotation.y=t.angle}function f(t){u(new x.a(t))}function p(){return S||null}function v(){return T||null}function y(){return C||null}var m=(n(47),n(34)),g=n(0),b=n(6),x=n(143),w=n(25),k=n(89),M=n.n(k),_=n(101),E=n(210),S=void 0,T=void 0,C=void 0,P=void 0,O=void 0,R=void 0,I=void 0,F=[];e.a={setup:i,start:a,stop:s,debugBody:f,bodyCopy:d,addComponent:u,removeComponent:c,getScene:p,getRenderer:v,getWorld:y}},function(t,e,n){"use strict";function i(t){c=t,h=u(c)}function o(){return h.nextFloat()}function r(t,e){return Math.floor(h.nextFloat()*(e-t+1))+t}function a(t,e){return Math.abs(Math.sin(Math.sin(15.31*t)+Math.cos(11.33*e*(c+1))+t+c))}function s(t,e,n,i){return Math.floor(a(t,e)*(i-n+1))+n}var u=n(137),c=0,h=u(c);e.a={setSeed:i,random:o,randomInt:r,hash2d:a,hash2dInt:s}},function(t,e,n){"use strict";var i=n(1),o=n.n(i),r=n(2),a=n.n(r),s=n(7),u=function(){function t(){o()(this,t),this.scene=s.a.getScene(),this.world=s.a.getWorld(),this.meshes={},this.geometries={},this.materials={},this.components=[],this.contactMaterials=[],this.group=new THREE.Group,this.setup.apply(this,arguments),this.body&&this.world.addBody(this.body),this.vehicle&&this.vehicle.addToWorld(this.world)}return a()(t,[{key:"addComponent",value:function(t){if(!~this.components.indexOf(t)&&t.group)return this.group.add(t.group),this.components.push(t),t}},{key:"removeComponent",value:function(t){var e=this.components.indexOf(t);if(~e&&t.group)return this.group.remove(t.group),this.components.splice(e,1),null}},{key:"bindFuncs",value:function(t){var e=this;t.forEach(function(t){e[t]=e[t].bind(e)})}},{key:"setup",value:function(){}},{key:"update",value:function(t){this.components.forEach(function(e){return e.update(t)})}},{key:"resize",value:function(t){this.components.forEach(function(e){return e.resize(t)})}},{key:"destroy",value:function(){var t=this;if(!this.destroyed){this.destroyed=!0,this.components.forEach(function(t){return t.destroy()});for(var e in this.meshes)this.meshes[e].parent.remove(this.meshes[e]);for(var n=this.group.children.length-1;n>=0;n--)this.group.remove(this.group.children[n]);for(var i in this.materials)this.materials[i].dispose(),delete this.materials[i];for(var o in this.geometries)this.geometries[o].dispose(),delete this.geometries[o];this.group.parent&&this.group.parent.remove(this.group),this.group=void 0,this.components=[],this.meshes={},this.geometries={},this.materials={},this.body&&this.world.removeBody(this.body),this.vehicle&&this.vehicle.removeFromWorld(),this.contactMaterials.forEach(function(e){return t.world.removeContactMaterial(e)}),this.contactMaterials=[],this.shape=void 0,this.body=void 0,this.vehicle=void 0,this.scene=void 0,this.world=void 0}}}]),t}();e.a=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var o=n(3),r=i(o),a=n(176),s=i(a);e.default=function t(e,n,i){null===e&&(e=Function.prototype);var o=(0,s.default)(e,n);if(void 0===o){var a=(0,r.default)(e);return null===a?void 0:t(a,n,i)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(i)}},function(t,e,n){"use strict";var i=n(29),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=function(){function t(e){a()(this,t),this.refs={},this.anims={},this.timers=[],this.didInit(e)}return u()(t,[{key:"render",value:function(){}},{key:"show",value:function(){}},{key:"hide",value:function(){}},{key:"didInit",value:function(){}},{key:"willMount",value:function(){}},{key:"didMount",value:function(){}},{key:"willUnmount",value:function(){}},{key:"hydrate",value:function(t){t&&!this.mounted&&(this.willMount(t),this.refs.base=t,this.mounted=!0,this.didMount(t))}},{key:"mount",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t&&!this.mounted){var n=this.render();n&&(this.willMount(n),e?t.insertBefore(n,e):t.appendChild(n),this.refs.base=n,this.mounted=!0,this.didMount(n))}}},{key:"bindFuncs",value:function(t){var e=this;t.forEach(function(t){e[t]=e[t].bind(e)})}},{key:"timer",value:function(t,e){var n=this;return new o.a(function(i,o){function r(){var t=a.timers.indexOf(s);~t&&a.timers.splice(t,1),i(),e&&e()}var a=n;e&&(e=e.bind(a));var s=window.setTimeout(r,t);a.timers.push(s)})}},{key:"destroy",value:function(){if(this.mounted){this.willUnmount(this.refs.base),this.refs.base&&this.refs.base.parentNode&&this.refs.base.parentNode.removeChild(this.refs.base);for(var t in this.refs)delete this.refs[t];for(var e in this.anims)"function"==typeof this.anims[e].pause&&this.anims[e].pause(),delete this.anims[e];this.timers.forEach(function(t){return window.clearTimeout(t)}),this.anims=void 0,this.timers=void 0,this.refs=void 0,this.mounted=!1}}}]),t}();e.a=c},function(t,e){var n=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},function(t,e,n){"use strict";function i(){c=new THREE.ShaderMaterial({vertexShader:a.a,fragmentShader:u.a,uniforms:{texture:{type:"t",value:o.a.get("tex.props")}},side:THREE.DoubleSide})}var o=n(0),r=n(201),a=n.n(r),s=n(202),u=n.n(s),c=void 0;e.a={setup:i,getMaterial:function(){return c||i(),c}}},function(t,e,n){var i=n(62)("wks"),o=n(43),r=n(15).Symbol,a="function"==typeof r;(t.exports=function(t){return i[t]||(i[t]=a&&r[t]||(a?r:o)("Symbol."+t))}).store=i},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){"use strict";function i(t,e){return(c[t]||(c[t]=[])).push(e),this}function o(t,e){function n(){r(t,n),e.apply(void 0,arguments)}return n._=e,i(t,n)}function r(t,e){var n=c[t],i=[];if(n&&e)for(var o=0;o<n.length;o++)n[o]!==e&&n[o]._!==e&&i.push(n[o]);i.length?c[t]=i:delete c[t]}function a(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var o=n.length>1?n.pop():null,r=(c[t]||[]).slice();if(o){for(var a=[],s=0;s<r.length;s++)a.push(r[s].apply(r,n));u.a.all(a).then(o)}else for(var h=0;h<r.length;h++)r[h].apply(r,n)}var s=n(29),u=n.n(s),c={},h={on:i,once:o,off:r,emit:a};e.a=h},function(t,e,n){"use strict";function i(){for(var t=0;t<z*L;t++){H[t]=[];for(var e=0;e<z*L;e++)H[t][e]=0}}function o(){var t=A.chunkX-j,e=A.chunkY-j;H.forEach(function(n,i){for(var o=i%z,r=Math.floor(i/z),a=e+r,s=0;s<L;s++){var u=t+s;D[u+"."+a],n.splice.apply(n,[s*z,z].concat(C()(D[u+"."+a].map[o])))}})}function r(){S()(D).forEach(function(t){F.emit("chunk-removed",D[t]),delete D[t]}),W=[0,0];for(var t=-j,e=j,n=-j,i=j,r=t;r<=e;r++)for(var a=n;a<=i;a++){var u=r+"."+a;D[u]=s(r,a),F.emit("chunk-added",D[u])}A=b(0,0),o(),w(0,0,!0)}function a(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];B=O.a.get("map.chunks"),t||i();for(var e=-j,n=j,r=-j,a=j,u=e;u<=n;u++)for(var c=r;c<=a;c++){var h=u+"."+c;D[h]=s(u,c),F.emit("chunk-added",D[h])}A=b(0,0),o(),w(0,0,!0)}function s(t,e){var n=t+"."+e,i=B.length-2,o="0.0"!==n?1+I.a.hash2dInt(t,e,0,i):0,r=B[o];return{id:n,poolId:o,chunkX:t,chunkY:e,x:t*z-z/2,y:e*z-z/2,road:r.road,map:r.map,buildings:r.buildings,props:r.props,svg:r.svg}}function u(t,e){var n=t+"."+e;D[n]||(D[n]=s(t,e),F.emit("chunk-added",D[n]))}function c(t,e){var n=t+"."+e;D[n]&&(F.emit("chunk-removed",D[n]),delete D[n])}function h(t,e,n,i){var o=n-t,r=i-e;if(0!==o){for(var a=t-j*o,s=n+j*o,h=e-j,l=e+j,d=h;d<=l;d++)c(a,d),u(s,d);t=n}if(0!==r)for(var f=e-j*r,p=i+j*r,v=t-j,y=t+j,m=v;m<=y;m++)c(m,f),u(m,p)}function l(){return A}function d(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=void 0!==e.middleX?e.middleX:A.chunkX,i=void 0!==e.middleY?e.middleY:A.chunkY;return t.forEach(function(t){t.x=Math.ceil(t.x-z*(j-n+.5)),t.y=Math.ceil(t.y-z*(j-i+.5))}),t}function f(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=void 0!==n.middleX?n.middleX:A.chunkX,o=void 0!==n.middleY?n.middleY:A.chunkY,r=t-z*(j-i+.5),a=e-z*(j-o+.5);return[Math.ceil(r),Math.ceil(a)]}function p(t,e){return v(Math.floor(Math.round(t)+z/2),Math.floor(Math.round(e)+z/2))}function v(t,e){return[t+z*(j-A.chunkX),e+z*(j-A.chunkY)]}function y(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return m(Math.floor(Math.round(t)+z/2),Math.floor(Math.round(e)+z/2),n)}function m(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=b(t,e,n);if(!i)return null;var o=t<0?(t%z+z)%z:t%z,r=e<0?(e%z+z)%z:e%z,a=o+"."+r;return i.road[a]?i.road[a]:null}function g(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return b(Math.floor(Math.round(t)+z/2),Math.floor(Math.round(e)+z/2),n)}function b(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Math.floor(t/z),o=Math.floor(e/z),r=i+"."+o;return D[r]?D[r]:n?null:s(i,o)}function x(t,e){return[Math.floor(Math.round(t)+z/2),Math.floor(Math.round(e)+z/2)]}function w(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Math.round(t),r=Math.round(e);t=Math.floor(Math.round(t)+z/2),e=Math.floor(Math.round(e)+z/2);var a=b(t,e);if(null!==a&&a!==A&&(h(A.chunkX,A.chunkY,a.chunkX,a.chunkY),A=a,o()),R.a.locDebug&&(W[0]!==t||W[1]!==e||n)){W[0]=t,W[1]=e;var s=b(t,e),u=t<0?(t%z+z)%z:t%z,c=e<0?(e%z+z)%z:e%z,l=p(i,r),d=f(l[0],l[1]);V.innerHTML="three: "+i+" "+r+" | pos: "+t+" "+e+" | chunk: "+s.chunkX+" "+s.chunkY+" | chunkPos: "+u+" "+c+" | walkPos: "+l[0]+" "+l[1]+" | walk2Three: "+d[0]+" "+d[1]+" | isRoad: "+H[l[1]][l[0]]}}function k(){return z}function M(){return H}function _(){for(var t=[],e=0;e<H.length;e++)t[e]=H[e].slice();return t}var E=n(41),S=n.n(E),T=n(170),C=n.n(T),P=n(46),O=n(0),R=n(6),I=n(8),F=Object(P.a)(),L=R.a.viewDistance,z=R.a.chunkSize,j=(L-1)/2,B=[],A=null,D={},H=[],W=[0,0],V=void 0;R.a.locDebug&&(V=document.createElement("pre"),V.style.zIndex=1e4,V.style.position="fixed",V.style.fontSize="10px",V.style.bottom=0,V.style.padding="10px",V.style.right=0,V.style.color="white",V.style.background="rgba(0, 0, 0, 0.3)",document.body.appendChild(V)),e.a={init:a,updateCenter:w,getChunkSize:k,getChunkFromPos:b,getChunkFromThreePos:g,getRoadFromPos:m,getRoadFromThreePos:y,getWalkCoordFromPos:v,getWalkCoordFromThreePos:p,convertWalkPathToThreePos:d,getPosFromThreePos:x,getChunkFromPool:s,getCurrentMiddleChunk:l,getWalkMap:M,copyWalkMap:_,on:F.on,reset:r}},function(t,e,n){(function(n){var i,o,r,a={scope:{}};a.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){if(n.get||n.set)throw new TypeError("ES3 does not support getters and setters.");t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},a.getGlobal=function(t){return"undefined"!=typeof window&&window===t?t:void 0!==n&&null!=n?n:t},a.global=a.getGlobal(this),a.SYMBOL_PREFIX="jscomp_symbol_",a.initSymbol=function(){a.initSymbol=function(){},a.global.Symbol||(a.global.Symbol=a.Symbol)},a.symbolCounter_=0,a.Symbol=function(t){return a.SYMBOL_PREFIX+(t||"")+a.symbolCounter_++},a.initSymbolIterator=function(){a.initSymbol();var t=a.global.Symbol.iterator;t||(t=a.global.Symbol.iterator=a.global.Symbol("iterator")),"function"!=typeof Array.prototype[t]&&a.defineProperty(Array.prototype,t,{configurable:!0,writable:!0,value:function(){return a.arrayIterator(this)}}),a.initSymbolIterator=function(){}},a.arrayIterator=function(t){var e=0;return a.iteratorPrototype(function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}})},a.iteratorPrototype=function(t){return a.initSymbolIterator(),t={next:t},t[a.global.Symbol.iterator]=function(){return this},t},a.array=a.array||{},a.iteratorFromArray=function(t,e){a.initSymbolIterator(),t instanceof String&&(t+="");var n=0,i={next:function(){if(n<t.length){var o=n++;return{value:e(o,t[o]),done:!1}}return i.next=function(){return{done:!0,value:void 0}},i.next()}};return i[Symbol.iterator]=function(){return i},i},a.polyfill=function(t,e,n,i){if(e){for(n=a.global,t=t.split("."),i=0;i<t.length-1;i++){var o=t[i];o in n||(n[o]={}),n=n[o]}t=t[t.length-1],i=n[t],e=e(i),e!=i&&null!=e&&a.defineProperty(n,t,{configurable:!0,writable:!0,value:e})}},a.polyfill("Array.prototype.keys",function(t){return t||function(){return a.iteratorFromArray(this,function(t){return t})}},"es6-impl","es3");var s=this;!function(n,a){o=[],i=a,void 0!==(r="function"==typeof i?i.apply(e,o):i)&&(t.exports=r)}(0,function(){function t(t){if(!A.col(t))try{return document.querySelectorAll(t)}catch(t){}}function e(t,e){for(var n=t.length,i=2<=arguments.length?arguments[1]:void 0,o=[],r=0;r<n;r++)if(r in t){var a=t[r];e.call(i,a,r,t)&&o.push(a)}return o}function n(t){return t.reduce(function(t,e){return t.concat(A.arr(e)?n(e):e)},[])}function i(e){return A.arr(e)?e:(A.str(e)&&(e=t(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function o(t,e){return t.some(function(t){return t===e})}function r(t){var e,n={};for(e in t)n[e]=t[e];return n}function a(t,e){var n,i=r(t);for(n in t)i[n]=e.hasOwnProperty(n)?e[n]:t[n];return i}function u(t,e){var n,i=r(t);for(n in e)i[n]=A.und(t[n])?e[n]:t[n];return i}function c(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,n,i){return e+e+n+n+i+i});var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);t=parseInt(e[1],16);var n=parseInt(e[2],16),e=parseInt(e[3],16);return"rgba("+t+","+n+","+e+",1)"}function h(t){function e(t,e,n){return 0>n&&(n+=1),1<n&&--n,n<1/6?t+6*(e-t)*n:.5>n?e:n<2/3?t+(e-t)*(2/3-n)*6:t}var n=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(t);t=parseInt(n[1])/360;var i=parseInt(n[2])/100,o=parseInt(n[3])/100,n=n[4]||1;if(0==i)o=i=t=o;else{var r=.5>o?o*(1+i):o+i-o*i,a=2*o-r,o=e(a,r,t+1/3),i=e(a,r,t);t=e(a,r,t-1/3)}return"rgba("+255*o+","+255*i+","+255*t+","+n+")"}function l(t){if(t=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(t))return t[2]}function d(t){return-1<t.indexOf("translate")||"perspective"===t?"px":-1<t.indexOf("rotate")||-1<t.indexOf("skew")?"deg":void 0}function f(t,e){return A.fnc(t)?t(e.target,e.id,e.total):t}function p(t,e){if(e in t.style)return getComputedStyle(t).getPropertyValue(e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase())||"0"}function v(t,e){return A.dom(t)&&o(B,e)?"transform":A.dom(t)&&(t.getAttribute(e)||A.svg(t)&&t[e])?"attribute":A.dom(t)&&"transform"!==e&&p(t,e)?"css":null!=t[e]?"object":void 0}function y(t,n){var i=d(n),i=-1<n.indexOf("scale")?1:0+i;if(!(t=t.style.transform))return i;for(var o=[],r=[],a=[],s=/(\w+)\((.+?)\)/g;o=s.exec(t);)r.push(o[1]),a.push(o[2]);return t=e(a,function(t,e){return r[e]===n}),t.length?t[0]:i}function m(t,e){switch(v(t,e)){case"transform":return y(t,e);case"css":return p(t,e);case"attribute":return t.getAttribute(e)}return t[e]||0}function g(t,e){var n=/^(\*=|\+=|-=)/.exec(t);if(!n)return t;var i=l(t)||0;switch(e=parseFloat(e),t=parseFloat(t.replace(n[0],"")),n[0][0]){case"+":return e+t+i;case"-":return e-t+i;case"*":return e*t+i}}function b(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function x(t){t=t.points;for(var e,n=0,i=0;i<t.numberOfItems;i++){var o=t.getItem(i);0<i&&(n+=b(e,o)),e=o}return n}function w(t){if(t.getTotalLength)return t.getTotalLength();switch(t.tagName.toLowerCase()){case"circle":return 2*Math.PI*t.getAttribute("r");case"rect":return 2*t.getAttribute("width")+2*t.getAttribute("height");case"line":return b({x:t.getAttribute("x1"),y:t.getAttribute("y1")},{x:t.getAttribute("x2"),y:t.getAttribute("y2")});case"polyline":return x(t);case"polygon":var e=t.points;return x(t)+b(e.getItem(e.numberOfItems-1),e.getItem(0))}}function k(t,e){function n(n){return n=void 0===n?0:n,t.el.getPointAtLength(1<=e+n?e+n:0)}var i=n(),o=n(-1),r=n(1);switch(t.property){case"x":return i.x;case"y":return i.y;case"angle":return 180*Math.atan2(r.y-o.y,r.x-o.x)/Math.PI}}function M(t,e){var n,i=/-?\d*\.?\d+/g;if(n=A.pth(t)?t.totalLength:t,A.col(n))if(A.rgb(n)){var o=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(n);n=o?"rgba("+o[1]+",1)":n}else n=A.hex(n)?c(n):A.hsl(n)?h(n):void 0;else o=(o=l(n))?n.substr(0,n.length-o.length):n,n=e&&!/\s/g.test(n)?o+e:o;return n+="",{original:n,numbers:n.match(i)?n.match(i).map(Number):[0],strings:A.str(t)||e?n.split(i):[]}}function _(t){return t=t?n(A.arr(t)?t.map(i):i(t)):[],e(t,function(t,e,n){return n.indexOf(t)===e})}function E(t){var e=_(t);return e.map(function(t,n){return{target:t,id:n,total:e.length}})}function S(t,e){var n=r(e);if(A.arr(t)){var o=t.length;2!==o||A.obj(t[0])?A.fnc(e.duration)||(n.duration=e.duration/o):t={value:t}}return i(t).map(function(t,n){return n=n?0:e.delay,t=A.obj(t)&&!A.pth(t)?t:{value:t},A.und(t.delay)&&(t.delay=n),t}).map(function(t){return u(t,n)})}function T(t,e){var n,i={};for(n in t){var o=f(t[n],e);A.arr(o)&&(o=o.map(function(t){return f(t,e)}),1===o.length&&(o=o[0])),i[n]=o}return i.duration=parseFloat(i.duration),i.delay=parseFloat(i.delay),i}function C(t){return A.arr(t)?D.apply(this,t):H[t]}function P(t,e){var n;return t.tweens.map(function(i){i=T(i,e);var o=i.value,r=m(e.target,t.name),a=n?n.to.original:r,a=A.arr(o)?o[0]:a,s=g(A.arr(o)?o[1]:o,a),r=l(s)||l(a)||l(r);return i.from=M(a,r),i.to=M(s,r),i.start=n?n.end:t.offset,i.end=i.start+i.delay+i.duration,i.easing=C(i.easing),i.elasticity=(1e3-Math.min(Math.max(i.elasticity,1),999))/1e3,i.isPath=A.pth(o),i.isColor=A.col(i.from.original),i.isColor&&(i.round=1),n=i})}function O(t,i){return e(n(t.map(function(t){return i.map(function(e){var n=v(t.target,e.name);if(n){var i=P(e,t);e={type:n,property:e.name,animatable:t,tweens:i,duration:i[i.length-1].end,delay:i[0].delay}}else e=void 0;return e})})),function(t){return!A.und(t)})}function R(t,e,n,i){var o="delay"===t;return e.length?(o?Math.min:Math.max).apply(Math,e.map(function(e){return e[t]})):o?i.delay:n.offset+i.delay+i.duration}function I(t){var e,n=a(z,t),i=a(j,t),o=E(t.targets),r=[],s=u(n,i);for(e in t)s.hasOwnProperty(e)||"targets"===e||r.push({name:e,offset:s.offset,tweens:S(t[e],i)});return t=O(o,r),u(n,{children:[],animatables:o,animations:t,duration:R("duration",t,n,i),delay:R("delay",t,n,i)})}function F(t){function n(){return window.Promise&&new Promise(function(t){return l=t})}function i(t){return f.reversed?f.duration-t:t}function o(t){for(var n=0,i={},o=f.animations,r=o.length;n<r;){var a=o[n],s=a.animatable,u=a.tweens,c=u.length-1,h=u[c];c&&(h=e(u,function(e){return t<e.end})[0]||h);for(var u=Math.min(Math.max(t-h.start-h.delay,0),h.duration)/h.duration,l=isNaN(u)?1:h.easing(u,h.elasticity),u=h.to.strings,d=h.round,c=[],v=void 0,v=h.to.numbers.length,y=0;y<v;y++){var m=void 0,m=h.to.numbers[y],g=h.from.numbers[y],m=h.isPath?k(h.value,l*m):g+l*(m-g);d&&(h.isColor&&2<y||(m=Math.round(m*d)/d)),c.push(m)}if(h=u.length)for(v=u[0],l=0;l<h;l++)d=u[l+1],y=c[l],isNaN(y)||(v=d?v+(y+d):v+(y+" "));else v=c[0];W[a.type](s.target,a.property,v,i,s.id),a.currentValue=v,n++}if(n=Object.keys(i).length)for(o=0;o<n;o++)L||(L=p(document.body,"transform")?"transform":"-webkit-transform"),f.animatables[o].target.style[L]=i[o].join(" ");f.currentTime=t,f.progress=t/f.duration*100}function r(t){f[t]&&f[t](f)}function a(){f.remaining&&!0!==f.remaining&&f.remaining--}function s(t){var e=f.duration,s=f.offset,p=s+f.delay,v=f.currentTime,y=f.reversed,m=i(t);if(f.children.length){var g=f.children,b=g.length;if(m>=f.currentTime)for(var x=0;x<b;x++)g[x].seek(m);else for(;b--;)g[b].seek(m)}(m>=p||!e)&&(f.began||(f.began=!0,r("begin")),r("run")),m>s&&m<e?o(m):(m<=s&&0!==v&&(o(0),y&&a()),(m>=e&&v!==e||!e)&&(o(e),y||a())),r("update"),t>=e&&(f.remaining?(c=u,"alternate"===f.direction&&(f.reversed=!f.reversed)):(f.pause(),f.completed||(f.completed=!0,r("complete"),"Promise"in window&&(l(),d=n()))),h=0)}t=void 0===t?{}:t;var u,c,h=0,l=null,d=n(),f=I(t);return f.reset=function(){var t=f.direction,e=f.loop;for(f.currentTime=0,f.progress=0,f.paused=!0,f.began=!1,f.completed=!1,f.reversed="reverse"===t,f.remaining="alternate"===t&&1===e?2:e,o(0),t=f.children.length;t--;)f.children[t].reset()},f.tick=function(t){u=t,c||(c=u),s((h+u-c)*F.speed)},f.seek=function(t){s(i(t))},f.pause=function(){var t=V.indexOf(f);-1<t&&V.splice(t,1),f.paused=!0},f.play=function(){f.paused&&(f.paused=!1,c=0,h=i(f.currentTime),V.push(f),G||U())},f.reverse=function(){f.reversed=!f.reversed,c=0,h=i(f.currentTime)},f.restart=function(){f.pause(),f.reset(),f.play()},f.finished=d,f.reset(),f.autoplay&&f.play(),f}var L,z={update:void 0,begin:void 0,run:void 0,complete:void 0,loop:1,direction:"normal",autoplay:!0,offset:0},j={duration:1e3,delay:0,easing:"easeOutElastic",elasticity:500,round:0},B="translateX translateY translateZ rotate rotateX rotateY rotateZ scale scaleX scaleY scaleZ skewX skewY perspective".split(" "),A={arr:function(t){return Array.isArray(t)},obj:function(t){return-1<Object.prototype.toString.call(t).indexOf("Object")},pth:function(t){return A.obj(t)&&t.hasOwnProperty("totalLength")},svg:function(t){return t instanceof SVGElement},dom:function(t){return t.nodeType||A.svg(t)},str:function(t){return"string"==typeof t},fnc:function(t){return"function"==typeof t},und:function(t){return void 0===t},hex:function(t){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)},rgb:function(t){return/^rgb/.test(t)},hsl:function(t){return/^hsl/.test(t)},col:function(t){return A.hex(t)||A.rgb(t)||A.hsl(t)}},D=function(){function t(t,e,n){return(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t}return function(e,n,i,o){if(0<=e&&1>=e&&0<=i&&1>=i){var r=new Float32Array(11);if(e!==n||i!==o)for(var a=0;11>a;++a)r[a]=t(.1*a,e,i);return function(a){if(e===n&&i===o)return a;if(0===a)return 0;if(1===a)return 1;for(var s=0,u=1;10!==u&&r[u]<=a;++u)s+=.1;--u;var u=s+(a-r[u])/(r[u+1]-r[u])*.1,c=3*(1-3*i+3*e)*u*u+2*(3*i-6*e)*u+3*e;if(.001<=c){for(s=0;4>s&&0!==(c=3*(1-3*i+3*e)*u*u+2*(3*i-6*e)*u+3*e);++s)var h=t(u,e,i)-a,u=u-h/c;a=u}else if(0===c)a=u;else{var u=s,s=s+.1,l=0;do{h=u+(s-u)/2,c=t(h,e,i)-a,0<c?s=h:u=h}while(1e-7<Math.abs(c)&&10>++l);a=h}return t(a,n,o)}}}}(),H=function(){function t(t,e){return 0===t||1===t?t:-Math.pow(2,10*(t-1))*Math.sin(2*(t-1-e/(2*Math.PI)*Math.asin(1))*Math.PI/e)}var e,n="Quad Cubic Quart Quint Sine Expo Circ Back Elastic".split(" "),i={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],t],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(e,n){return 1-t(1-e,n)}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(e,n){return.5>e?t(2*e,n)/2:1-t(-2*e+2,n)/2}]},o={linear:D(.25,.25,.75,.75)},r={};for(e in i)r.type=e,i[r.type].forEach(function(t){return function(e,i){o["ease"+t.type+n[i]]=A.fnc(e)?e:D.apply(s,e)}}(r)),r={type:r.type};return o}(),W={css:function(t,e,n){return t.style[e]=n},attribute:function(t,e,n){return t.setAttribute(e,n)},object:function(t,e,n){return t[e]=n},transform:function(t,e,n,i,o){i[o]||(i[o]=[]),i[o].push(e+"("+n+")")}},V=[],G=0,U=function(){function t(){G=requestAnimationFrame(e)}function e(e){var n=V.length;if(n){for(var i=0;i<n;)V[i]&&V[i].tick(e),i++;t()}else cancelAnimationFrame(G),G=0}return t}();return F.version="2.2.0",F.speed=1,F.running=V,F.remove=function(t){t=_(t);for(var e=V.length;e--;)for(var n=V[e],i=n.animations,r=i.length;r--;)o(t,i[r].animatable.target)&&(i.splice(r,1),i.length||n.pause())},F.getValue=m,F.path=function(e,n){var i=A.str(e)?t(e)[0]:e,o=n||100;return function(t){return{el:i,property:t,totalLength:w(i)*(o/100)}}},F.setDashoffset=function(t){var e=w(t);return t.setAttribute("stroke-dasharray",e),e},F.bezier=D,F.easings=H,F.timeline=function(t){var e=F(t);return e.pause(),e.duration=0,e.add=function(n){return e.children.forEach(function(t){t.began=!0,t.completed=!0}),i(n).forEach(function(n){var i=u(n,a(j,t||{}));i.targets=i.targets||t.targets,n=e.duration;var o=i.offset;i.autoplay=!1,i.direction=e.direction,i.offset=A.und(o)?n:g(o,n),e.began=!0,e.completed=!0,e.seek(i.offset),i=F(i),i.began=!0,i.completed=!0,i.duration>n&&(e.duration=i.duration),e.children.push(i)}),e.seek(0),e.reset(),e.autoplay&&e.restart(),e},e},F.random=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},F})}).call(e,n(91))},function(t,e,n){var i=n(15),o=n(12),r=n(30),a=n(26),s=function(t,e,n){var u,c,h,l=t&s.F,d=t&s.G,f=t&s.S,p=t&s.P,v=t&s.B,y=t&s.W,m=d?o:o[e]||(o[e]={}),g=m.prototype,b=d?i:f?i[e]:(i[e]||{}).prototype;d&&(n=e);for(u in n)(c=!l&&b&&void 0!==b[u])&&u in m||(h=c?b[u]:n[u],m[u]=d&&"function"!=typeof b[u]?n[u]:v&&c?r(h,i):y&&b[u]==h?function(t){var e=function(e,n,i){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,i)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(h):p&&"function"==typeof h?r(Function.call,h):h,p&&((m.virtual||(m.virtual={}))[u]=h,t&s.R&&g&&!g[u]&&a(g,u,h)))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,t.exports=s},function(t,e,n){var i=n(22),o=n(75),r=n(58),a=Object.defineProperty;e.f=n(23)?Object.defineProperty:function(t,e,n){if(i(t),e=r(e,!0),i(n),o)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){"use strict";e.a=function(){}},function(t,e,n){var i=n(31);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){t.exports=!n(32)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var i=n(78),o=n(55);t.exports=function(t){return i(o(t))}},function(t,e,n){"use strict";function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A;L=F,A=t,j=new THREE.Vector3(0,0,0),B=new THREE.Vector3(0,0,0),z=0}function o(){h(p.a.get("player.vehicle"))}function r(){var t=y.a.getAlive();t.length<1||(D>t.length-1&&(D=0),H=t[D],h(H),D=D+1>=t.length?0:D+1)}function a(){R=new THREE.Object3D,f.a.getScene().add(R),_=new THREE.Vector3(_[0],_[1],[_[2]]).setLength(S),O.pos=new THREE.Vector3(0,0,0),O.lookAt=new THREE.Vector3(0,0,0);var t="HD"===p.a.get("quality")?.1:.2,e="HD"===p.a.get("quality")?9:7.2;T=new THREE.PerspectiveCamera(x?55:75,window.innerWidth/window.innerHeight,t,e),P=new THREE.Frustum,j=new THREE.Vector3(0,0,0),B=new THREE.Vector3(0,0,0);var n={switchToCop:r,switchToPlayer:o};v.a.add(n,"switchToCop"),v.a.add(n,"switchToPlayer")}function s(){O.use?(R.position.copy(O.pos),R.rotation.y=O.ang,S=O.dist):(R.position.copy(C.group.position.clone()),R.rotation.y=C.chassis.rotation.y,S=Math.min(k,Math.max(w,C.speed*M)))}function u(t){if(C&&T){var e=L>0;if(E.curpos+=.005*(E.pos-E.curpos),E.curlookAt+=.005*(E.lookAt-E.curlookAt),E.curcameraDist+=.005*(E.cameraDist-E.curcameraDist),j.lerp(B,.1),O.use?(R.position.lerp(O.pos,E.curpos),R.rotation.y+=(O.ang-R.rotation.y)*E.ang,S+=(O.dist-S)*E.curcameraDist):(R.position.lerp(C.group.position.clone(),E.curpos),R.rotation.y+=(C.chassis.rotation.y-R.rotation.y)*E.ang,S+=(Math.min(k,Math.max(w,C.speed*M))-S)*E.curcameraDist),T.position.copy(R.localToWorld(_.clone().setLength(S))),O.use){var n=T.quaternion.clone();T.lookAt(O.lookAt);var i=T.quaternion.clone();T.setRotationFromQuaternion(n),T.quaternion.slerp(i,E.curlookAt)}else{var o=T.quaternion.clone();T.lookAt(C.group.position);var r=T.quaternion.clone();T.setRotationFromQuaternion(o),T.quaternion.slerp(r,E.curlookAt)}T.rotation.z+=.5*j.z,T.rotation.y+=.4*j.z,T.rotation.x+=.5*j.x,g.a.updateCoords(T.position,T.rotation.y);var a=T.getWorldDirection(),s=Math.atan2(a.x,a.z);if(b.a.setAngle(s),e){var u=L/F;z%Math.floor(3*(1-u))||(B.x=u*(2*m.a.random()-1)*2.5*A,B.y=u*(2*m.a.random()-1)*1.9*A,B.z=u*(2*m.a.random()-1)*2.5*A),L-=t*u,z+=1}T.updateMatrix(),T.updateMatrixWorld(),T.matrixWorldInverse.getInverse(T.matrixWorld),P.setFromMatrix((new THREE.Matrix4).multiplyMatrices(T.projectionMatrix,T.matrixWorldInverse))}}function c(t){return P.containsPoint(t)}function h(t){C=t,T.position.copy(C.group.position).add(_),T.lookAt(C.group.position),I.fromLerp=C.chassis?C.chassis.rotation.y:C.group.rotation.y,R.position.copy(C.group.position)}function l(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];O.use=!1,t?s():(E.curpos=0,E.curlookAt=0,E.curcameraDist=.06)}function d(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];O.use=!0,O.pos.set(1,.6,0),O.dist=-.2,O.lookAt.set(0,.4,0),t?s():(E.curpos=0,E.curlookAt=0,E.curcameraDist=.06)}var f=n(7),p=n(0),v=n(47),y=(n(6),n(96)),m=n(8),g=n(35),b=n(101),x=!0,w=1.1,k=1.5,M=1.3,_=x?[0,.9,-1.8]:[0,.9,-.8],E={curpos:1,curlookAt:.8,curcameraDist:.01,pos:1,ang:x?.03:.01,angVel:.04,lookAt:.8,cameraDist:.01},S=w,T=void 0,C=void 0,P=void 0,O={pos:null,ang:0,dist:0,lookAt:0,use:!1},R=void 0,I={fromLerp:0,angVel:0},F=250,L=0,z=0,j=void 0,B=void 0,A=2,D=0,H=void 0;e.a={setup:a,instantUpdate:s,update:u,setTarget:h,addCameraShake:i,isPointVisible:c,bankView:d,normalView:l,specialTarget:O,getCamera:function(){return T}}},function(t,e,n){var i=n(20),o=n(37);t.exports=n(23)?function(t,e,n){return i.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){"use strict";var i={},o={};i["preloader.loading"]="chargement",o["preloader.loading"]="loading...",i["preloader.permission"]="C'est un hold-up ! Donne nous ta voix !",o["preloader.permission"]="This is a hold-up! Give us your voice!",i["preloader.refresh"]='Le microphone est accessible et rien ne se passe ? <a href="./">Recharge la page !</a>',o["preloader.refresh"]='The mic is enabled and nothing happens ? <a href="./">Reload the page!</a>',i["preloader.refresh.nolink"]="Le microphone est accessible et rien ne se passe ? Recharge la page !",o["preloader.refresh.nolink"]="The mic is enabled and nothing happens ? Reload the page!",i["error.webspeech"]="Les vrais braqueurs sont sur Chrome...",i["error.webspeech.subtitle"]="Le braquage nécessite la Webspeech API pour se dérouler correctement (diponible sur Chrome)",o["error.webspeech"]="Armed robbers are on Chrome browser...",o["error.webspeech.subtitle"]="The heist needs the Webspeech API in order to take place (available on Chrome) ",i["error.notallowed"]="Hé, on t'entend pas !",i["error.notallowed.subtitle"]="Active ton micro, puis recharge ton flingue et la page !",o["error.notallowed"]="We can't hear you!",o["error.notallowed.subtitle"]="Switch your mic on, then reload your gun and the page!",i["error.unknown"]="Erreur !",o["error.unknown"]="Error!",i["home.cta"]="jouer!",o["home.cta"]="play!",i["home.lang"]=["français","anglais"],o["home.lang"]=["french","english"],i["home.quality"]=["basse qualité","haute définition"],o["home.quality"]=["low quality","high quality"],i["intro.button.next"]="Suivant",o["intro.button.next"]="Next",i["intro.button.start"]="On y va!",o["intro.button.start"]="Let's go!",i["intro.button.skip"]="Passer",o["intro.button.skip"]="Skip",i["intro.gps"]="Faut qu'on s'échappe de là !\n Tu es notre GPS alors utilise ta voix pour nous guider !\n Joue ton rôle à fond, on compte sur toi !",o["intro.gps"]="We need to escape from the police!\n You are our GPS, so use your voice to guide us!\n Don't mess around, we lean on you!",i["intro.police"]="On a piraté les ondes radios de la police !\n Anticipe leur mouvements avec le radar à l'écran !\n Fais gaffe : la voiture est résistante mais 4 chocs et on est cuit !",o["intro.police"]="We hacked police's radios!\n So try to predict their movements with the radar on the screen!\n Be careful : the car is tough but it explodes after 4 bumps!",i["intro.stress"]="Sois précis sur tes instructions sinon c'est la panique !\n Garde un oeil sur la jauge de stress ! \n Allez, on se taille de là !",o["intro.stress"]="Your instructions needs to be accurate or it will be too much pressure!\n Keep an eye on the stress bar ! \n Alright, let's get out of here!",i["intro.wakeup"]="Hé, t'es muet ou quoi ?!\n On va à gauche ou à droite ?",o["intro.wakeup"]="Hey, are you dumb or what?!\n We go left or right?",i["over.title"]="Coffré!",o["over.title"]="Wasted!",i["over.sub"]=["Pfff... La prochaine fois, on télécharge Waze...",'Dans 500 mètres, prends la sortie "recommence"',"On y était presque... Dommage que tu finisses en pièce à conviction."],o["over.sub"]=["Uhhh... Next time, we'll use Waze instead...",'In 500 meters, take the exit "start again"',"That was close... It's too bad that you end up as an evidence."],i["over.cta"]="Recidiver",o["over.cta"]="Reoffend",e.a={fr:i,en:o}},function(t,e,n){t.exports={default:n(109),__esModule:!0}},function(t,e,n){var i=n(56);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,o){return t.call(e,n,i,o)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var i=n(77),o=n(63);t.exports=Object.keys||function(t){return i(t,o)}},function(t,e,n){"use strict";function i(t,e){var n=v,i=1e3/t,o=-1;return function(){(o=-1===o?i:v-n)>=i&&(e(o),n=v-o%i)}}function o(){c.a.fpsCounter&&d.begin(),v=Date.now();for(var t=v-y,e=0;e<f.length;e++)f[e](t);y=v,c.a.fpsCounter&&d.end(),p=window.requestAnimationFrame(o)}function r(){p||(y=Date.now(),o())}function a(){p&&(window.cancelAnimationFrame(p),p=null)}function s(t){~f.indexOf(t)||(f.push(t),r())}function u(t){var e=f.indexOf(t);~e&&(f.splice(e,1),0===f.length&&a())}var c=n(6),h=n(142),l=n.n(h),d=void 0;c.a.fpsCounter&&(d=new l.a,d.showPanel(0),document.body.appendChild(d.dom));var f=[],p=null,v=Date.now(),y=v;e.a={start:r,stop:a,add:s,remove:u,fpsLimiter:i}},function(t,e,n){"use strict";function i(){_.bg=new Howl({src:["sfx/bg-loop-bass.mp3"],loop:!0,volume:.1}),_.engine=new Howl({src:["sfx/engine-loop.mp3"],loop:!0,volume:.5}),_.siren1=new Howl({src:["sfx/siren1.wav"],loop:!0,volume:.2}),_.blast1=new Howl({src:["sfx/explosion-crash-1.mp3"],volume:.1}),_.blast2=new Howl({src:["sfx/explosion-crash-2.mp3"],volume:.1}),_.police0=new Howl({src:["sfx/police-1.mp3"],volume:.4}),_.police1=new Howl({src:["sfx/police-2.mp3"],volume:.4}),_.police2=new Howl({src:["sfx/police-3.mp3"],volume:.4}),_.bank=new Howl({src:["sfx/alarm-loop.mp3"],volume:.1,loop:!0}),_.radio=new Howl({src:["sfx/1077.mp3"],volume:.2,onend:function(){b.a.get("player.dead")||s()}}),k.a.add(f)}function o(t,e){I.bg&&I.bg.pause(),I.bg=g()({targets:C,bgVol:t,easing:"linear",duration:e?0:1500,update:function(){E.bg&&_.bg.volume(C.bgVol,E.bg)}})}function r(){a(),E.bank=_.bank.play(),F=new THREE.Vector3(-1,0,0)}function a(){E.bank&&(_.bank.stop(E.bank),E.bank=null)}function s(){E.radio&&(_.radio.stop(E.radio),E.radio=null),u(),E.bg=_.bg.play(),_.bg.volume(C.bgVol,E.bg)}function u(){E.bg&&_.bg.stop(E.bg)}function c(t,e){S[0]=t.x,S[1]=t.z,T=e}function h(t,e){var n=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments[3]);E.engine||n||(E.engine=_.engine.play());var i=t[0]*t[0]+t[1]*t[1];i-=Math.max(1,1.6*i/2)-1;var o=Math.max(0,i-1.91);O=(i/1.81*1.5+.5+7*o)*!n,P+=.08*(O-P)+Math.abs(e)%1*.04,R=P<1?0:1,P-=.04*R,_.engine.rate(P,E.engine)}function l(t){L[t]||(L[t]={id:t},L[t].siren=_.siren1.play())}function d(t){var e="police"+j;z.instance&&_[e].stop(z.instance),j=j>=2?0:j+1,e="police"+j,z.method=e,z.instance=_[e].play(),z.id=t,z.timer=6500+2e3*(2*w.a.random()-1)}function f(t){if(z.timer>0&&(z.timer-=t),E.bank){var e=Math.pow(F.x-S[0],2)+Math.pow(F.z-S[1],2),n=.04*Math.max(0,e-.1);n=Math.max(0,Math.min(1,1/n*.04));var i=x.a.getCamera().worldToLocal(F.clone()).normalize();_.bank.volume(.14*n,E.bank),_.bank.stereo(i.x,E.bank)}}function p(t,e,n){if(L[t]){var i=Math.pow(e.x-S[0],2)+Math.pow(e.z-S[1],2),o=.04*Math.max(0,i-.1);o=Math.max(0,Math.min(1,1/o*.06));var r=x.a.getCamera().worldToLocal(e.clone()).normalize();i<8&&z.timer<=0&&d(t),z.id===t&&z.timer>0&&z.instance&&(_[z.method].volume(o,z.instance),_[z.method].stereo(r.x,z.instance)),_.siren1.volume(.8*o,L[t].siren),_.siren1.stereo(r.x,L[t].siren)}}function v(t){z.id===t&&z.timer>0&&(z.timer=2e3,z.id=null,z.instance&&(_[z.method].stop(z.instance),z.instance=null)),L[t]&&(_.siren1.stop(L[t].siren),delete L[t])}function y(t){B=!B;var e=B?"blast1":"blast2",n=_[e].play(),i=Math.pow(t.x-S[0],2)+Math.pow(t.z-S[1],2);i=.04*Math.max(0,i-.1),i=Math.max(0,Math.min(1,1/i*.06));var o=x.a.getCamera().worldToLocal(t.clone()).normalize();_[e].volume(.4*i,n),_[e].stereo(o.x,n),_[e].rate(1+.3*(2*w.a.random()-1),n)}var m=n(18),g=n.n(m),b=n(0),x=(n(50),n(25)),w=n(8),k=n(34),M=n(36),_={},E={},S=[0,0],T=0,C={bgVol:0},P=.5,O=.5,R=0,I={};M.a.on("radioOn",function(){u(),E.radio=_.radio.play()});var F=void 0,L={},z={timer:0},j=0,B=!1;e.a={setup:i,updateEngine:h,addCop:l,updateCop:p,removeCop:v,updateCoords:c,stopBg:u,startBg:s,updateBgVolume:o,blast:y,startBank:r,stopBank:a}},function(t,e,n){"use strict";function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"fr";w=v[t]}function o(){x||(h.a.on("result",s),h.a.on("end",a),x=!0)}function r(){x&&(h.a.off("result",s),h.a.off("end",a),x=!1)}function a(){M.forEach(function(t){t.dom&&t.dom.parentNode.removeChild(t.dom)}),M=[]}function s(t){if(x)for(var e=t.resultIndex;e<t.results.length;e++)u(e,t.results[e],e+1>=t.results.length)}function u(t,e,n){M[t]||(M[t]={value:"",matches:[],dom:null,final:!1},m&&(M[t].dom=document.createElement("pre"),M[t].dom.style.color="rgba(255, 255, 255, 0.8)",g.appendChild(M[t].dom)));var i=M[t];if(e.isFinal)i.value=e[0].transcript,i.final=!0,c(i.value,!0),k=[];else if(i.value=e[0].transcript,n){var o=M[t-1]&&!M[t-1].final?M[t-1].value:"";c(o+i.value)}m&&(i.dom.innerHTML="index: "+t+"\nvalue: "+i.value+"\nfinal:"+i.final)}function c(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t=t.toLowerCase(),w.replacers.forEach(function(e){t=t.replace(e.reg,e.to)}),k.forEach(function(e){t=t.replace(e," ")});for(var n=0;n<w.max;n++){for(var i in w.orders){(function(i){if(n>=w.maxs[i])return"continue";var o=w.orders[i][n].regex,r=w.orders[i][n].opts;if(!r.continuous&&!e)return"continue";if(r.capture)for(var a=o.exec(t);a;){t=t.replace(a[1]," "),k.push(a[1]),a.shift();var s={type:i,transcript:a[0].trim(),capture:a,finale:!!e};y.emit(":all",s),y.emit(i,s),m&&(b.innerHTML+=i+"\n"),a=o.exec(t)}else{var u=t.match(o);if(!u)return"continue";u.forEach(function(n){t=t.replace(n," "),k.push(n);var o={type:i,transcript:n.trim(),capture:[n],finale:!!e};m&&(b.innerHTML+=i+"\n"),y.emit(":all",o),y.emit(i,o)})}})(i)}}}var h=n(45),l=n(194),d=n(195),f=n(46),p=n(6),v={fr:l.a,en:d.a},y=Object(f.a)(),m=p.a.speechDebug,g=void 0,b=void 0,x=!1;m&&(g=document.createElement("div"),g.style.zIndex="1000",g.style.position="absolute",g.style.top="45px",g.style.left="0",g.style.fontSize="10px",g.style.lineHeight="100%",g.style.margin="0",g.style.padding="10px",g.style.color="white",g.style.background="rgba(0, 0, 0, 0.8)",g.style.pointerEvents="none",b=document.createElement("pre"),g.appendChild(b),document.body.appendChild(g));var w=v.fr,k=[],M=[];e.a={listen:o,unlisten:r,on:y.on,off:y.off,setLang:i}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){t.exports={}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var i=n(55);t.exports=function(t){return Object(i(t))}},function(t,e,n){t.exports={default:n(168),__esModule:!0}},function(t,e){t.exports=!0},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},function(t,e,n){var i=n(20).f,o=n(27),r=n(14)("toStringTag");t.exports=function(t,e,n){t&&!o(t=n?t:t.prototype,r)&&i(t,r,{configurable:!0,value:e})}},function(t,e,n){"use strict";function i(){for(var t,e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];x&&(t=console).log.apply(t,["[Speech]"].concat(n))}function o(){return"webkitSpeechRecognition"in window||"SpeechRecognition"in window}function r(t){t.results.length>8&&a()}function a(){return i("reboot"),new p.a(function(t){c().then(u).then(t)})}function s(){k&&a(),_=null}function u(t){return i("start"),new p.a(function(t,e){function n(){return m.off("error",i),m.off("start",n),k=!0,M=!1,window.clearTimeout(_),_=window.setTimeout(s,w),t()}function i(t){return m.off("error",i),m.off("start",n),k=!1,M=!1,e(t)}return S?k||"start"===M?e(new Error("Speech already started.")):(h(E),M="start",m.on("start",n),m.on("error",i),void S.start()):e(new Error("Web Speech API unavailable."))})}function c(){return i("stop"),new p.a(function(t,e){function n(){return m.off("end",n),k=!1,M=null,window.clearTimeout(_),_=null,t()}return S?k&&"stop"!==M?(M="stop",m.on("end",n),void S.stop()):e(new Error("Speech already stopped.")):e(new Error("Web Speech API unavailable."))})}function h(t){t&&b[t]&&S&&(E=t,S.lang=b[t],c().then(u).catch(function(){}))}function l(){return!!k}function d(){return S}var f=n(29),p=n.n(f),v=n(46),y=n(6),m=Object(v.a)(),g=window.SpeechRecognition||window.webkitSpeechRecognition,b={fr:"fr-FR",en:"en-EN"},x=y.a.speechDebug,w=2e4,k=!1,M=!1,_=null,E="fr",S=o()?new g:null;S&&(S.continuous=!0,S.interimResults=!0,S.maxAlternatives=10,S.onstart=function(t){m.emit("start",t)},S.onerror=function(t){m.emit("error",t)},S.onresult=function(t){m.emit("result",t)},S.onend=function(t){m.emit("end",t)},m.on("result",r),m.on("error",function(t){i("ERROR",t)}),m.on("end",function(t){window.clearTimeout(_),k&&!M&&(i("reboot from end"),k=!1,u()),i("END",t)})),e.a={isAvailable:o,isRecognizing:l,start:u,stop:c,setLang:h,getInstance:d,getPending:function(){return M},on:m.on,off:m.off}},function(t,e,n){"use strict";function i(t){return t=t||Object.create(null),{on:function(e,n){(t[e]||(t[e]=[])).push(n)},off:function(e,n){t[e]&&t[e].splice(t[e].indexOf(n)>>>0,1)},emit:function(e,n){(t[e]||[]).map(function(t){t(n)}),(t["*"]||[]).map(function(t){t(e,n)})}}}e.a=i},function(t,e,n){"use strict";function i(){u=new dat.GUI,u.close(),u.domElement.parentNode.style.zIndex="1000",s.a.datgui||u.domElement.parentNode.parentNode.removeChild(u.domElement.parentNode)}function o(t,e){return u||i(),u.add(t,e)}function r(t,e){return u||i(),u.addColor(t,e)}function a(t){return u||i(),u.addFolder(t)}var s=n(6),u=void 0;e.a={add:o,addColor:r,folder:a}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){t.exports={default:n(183),__esModule:!0}},function(t,e,n){"use strict";function i(t,e){return(t%e+e)%e}e.a=i},function(t,e,n){"use strict";function i(){E=!("HD"!==h.a.get("quality")),_="HD"===h.a.get("quality")?800:350,p=d.a.getMaterial(),g=new Float32Array(3*_),y=new Float32Array(3*_),b=new Float32Array(3*_),x=new Float32Array(_),m=new Float32Array(_),v=new THREE.BufferGeometry,v.addAttribute("scale",new THREE.BufferAttribute(x,1)),v.addAttribute("bornData",new THREE.BufferAttribute(b,3));var t=new THREE.BufferAttribute(y,3);t.setDynamic(!0),v.addAttribute("position",t),t=new THREE.BufferAttribute(m,1),t.setDynamic(!0),v.addAttribute("life",t),w=new THREE.Points(v,p),w.frustumCulled=!1;for(var e=0;e<_;e++)s(e);c.a.getScene().add(w),u(1)}function o(t){var e=t.x,n=t.y,i=t.z,o=t.type,r=t.amount,s=E?r:Math.ceil(r/2),u=[];k.length>0&&(u=k.splice(0,s)),s-=u.length,s>0&&(u=u.concat(M.splice(0,s))),u.forEach(function(t){return a(t,e,n,i,o)})}function r(t){if(M.length){v.attributes.position.needsUpdate=!0,v.attributes.life.needsUpdate=!0;for(var e=M.length-1;e>=0;e--){var n=M[e],i=b[3*n],o=b[3*n+1],r=m[n];0===i||4===i?(y[3*n+0]+=g[3*n+0]*(1-r),y[3*n+1]+=g[3*n+1],y[3*n+2]+=g[3*n+2]*(1-r)):1===i&&(y[3*n+0]+=g[3*n+0]*(1-r),y[3*n+1]+=g[3*n+1],y[3*n+2]+=g[3*n+2]*(1-r)),2===i?(g[3*n+0]*=.9,g[3*n+1]-=.001*f,g[3*n+1]*=.98,g[3*n+2]*=.9,y[3*n+0]+=g[3*n+0],y[3*n+1]+=g[3*n+1],y[3*n+2]+=g[3*n+2]):3===i&&(g[3*n+0]*=.96,g[3*n+1]-=.01*f,y[3*n+1]<=.01&&(g[3*n+1]*=-.8),g[3*n+1]*=.98,g[3*n+2]*=.96,y[3*n+0]+=g[3*n+0],y[3*n+1]+=g[3*n+1],y[3*n+2]+=g[3*n+2]),m[n]-=o,m[n]<=0&&s(n)}}}function a(t,e,n,i,o){if(m[t]=1,y[3*t+0]=e,y[3*t+1]=n,y[3*t+2]=i,b[3*t+0]=o,0===o){b[3*t+1]=.01+.001*(2*l.a.random()-1),b[3*t+2]=(2*l.a.random(0,1)-1)*Math.PI;var r=Math.floor(Math.abs(e)/1);g[3*t+0]=.009*(2*l.a.hash2d(r,r)-1),g[3*t+1]=.001*l.a.random()+.001,g[3*t+2]=g[3*t+0]}else if(1===o){b[3*t+1]=.02+.001*(2*l.a.random()-1),b[3*t+2]=(2*l.a.random(0,1)-1)*Math.PI;var a=Math.floor(Math.abs(e)/1e3);g[3*t+0]=.009*(2*l.a.hash2d(a,a)-1),g[3*t+1]=.005*l.a.random()+.008,g[3*t+2]=g[3*t+0]}else if(2===o)b[3*t+1]=.013+.005*(2*l.a.random()-1),b[3*t+2]=(2*l.a.random(0,1)-1)*Math.PI,g[3*t+0]=.04*(2*l.a.random(0,1)-1),g[3*t+1]=.02*l.a.random(0,1),g[3*t+2]=.04*(2*l.a.random(0,1)-1);else if(3===o)b[3*t+1]=.01+.005*(2*l.a.random()-1),b[3*t+2]=(2*l.a.random(0,1)-1)*Math.PI,g[3*t+0]=.03*(2*l.a.random(0,1)-1),g[3*t+1]=.01*l.a.random(0,1),g[3*t+2]=.03*(2*l.a.random(0,1)-1);else if(4===o){b[3*t+1]=.04+.001*(2*l.a.random()-1),b[3*t+2]=(2*l.a.random(0,1)-1)*Math.PI;Math.floor(Math.abs(e)/1);g[3*t+0]=0,g[3*t+1]=.002*l.a.random()+.003,g[3*t+2]=0}v.attributes.position.needsUpdate=!0,v.attributes.life.needsUpdate=!0,v.attributes.bornData.needsUpdate=!0,M.push(t)}function s(t){y[3*t+0]=1*Math.random(),y[3*t+1]=1*Math.random(),y[3*t+2]=1*Math.random(),g[3*t+0]=0,g[3*t+1]=0,g[3*t+2]=0,m[t]=0;var e=M.indexOf(t);~e&&M.splice(e,1),k.push(t)}function u(t){for(var e=0;e<_;e++)x[e]=t;v.attributes.scale.needsUpdate=!0}var c=n(7),h=n(0),l=n(8),d=n(191),f=.1,p=void 0,v=void 0,y=void 0,m=void 0,g=void 0,b=void 0,x=void 0,w=void 0,k=[],M=[],_=800,E=!1;e.a={setup:i,update:r,emit:o,setScale:u}},function(t,e,n){"use strict";function i(t){s.value+t>=1&&!1===s.panic&&(s.panic=!0,r.a.set("stress.panic",!0)),s.value=Math.min(1,s.value+t)}function o(t){s.value-t<=0&&!0===s.panic&&(s.panic=!1,r.a.set("stress.panic",!1)),s.value=Math.max(0,s.value-t)}var r=n(0),a=n(16),s={value:0,panic:!1,add:i,remove:o};a.a.on("stress.add",function(t){i(t)}),a.a.on("stress.remove",function(t){o(t)}),a.a.on("waypoints.reach",function(){o(.04)}),a.a.on("waypoints.cancel",function(){i(.09)}),e.a=s},function(t,e,n){"use strict";var i=n(110)(!0);n(74)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var i=n(31),o=n(15).document,r=i(o)&&i(o.createElement);t.exports=function(t){return r?o.createElement(t):{}}},function(t,e,n){var i=n(31);t.exports=function(t,e){if(!i(t))return t;var n,o;if(e&&"function"==typeof(n=t.toString)&&!i(o=n.call(t)))return o;if("function"==typeof(n=t.valueOf)&&!i(o=n.call(t)))return o;if(!e&&"function"==typeof(n=t.toString)&&!i(o=n.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var i=n(22),o=n(112),r=n(63),a=n(61)("IE_PROTO"),s=function(){},u=function(){var t,e=n(57)("iframe"),i=r.length;for(e.style.display="none",n(79).appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;i--;)delete u.prototype[r[i]];return u()};t.exports=Object.create||function(t,e){var n;return null!==t?(s.prototype=i(t),n=new s,s.prototype=null,n[a]=t):n=u(),void 0===e?n:o(n,e)}},function(t,e,n){var i=n(54),o=Math.min;t.exports=function(t){return t>0?o(i(t),9007199254740991):0}},function(t,e,n){var i=n(62)("keys"),o=n(43);t.exports=function(t){return i[t]||(i[t]=o(t))}},function(t,e,n){var i=n(15),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e){function n(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}t.exports=n},function(t,e,n){var i=n(90),o=i.Symbol;t.exports=o},function(t,e,n){var i=n(19),o=n(12),r=n(32);t.exports=function(t,e){var n=(o.Object||{})[t]||Object[t],a={};a[t]=e(n),i(i.S+i.F*r(function(){n(1)}),"Object",a)}},function(t,e,n){e.f=n(14)},function(t,e,n){var i=n(15),o=n(12),r=n(42),a=n(67),s=n(20).f;t.exports=function(t){var e=o.Symbol||(o.Symbol=r?{}:i.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var i=n(48),o=n(37),r=n(24),a=n(58),s=n(27),u=n(75),c=Object.getOwnPropertyDescriptor;e.f=n(23)?c:function(t,e){if(t=r(t),e=a(e,!0),u)try{return c(t,e)}catch(t){}if(s(t,e))return o(!i.f.call(t,e),t[e])}},function(t,e){function n(t){return i.test(t)}var i=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");t.exports=n},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(5),d=n.n(l),f=n(11),p=n(0),v=n(34),y=n(103),m=n(28),g=n(21),b=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return d()(e,t),u()(e,[{key:"didInit",value:function(t){this.class=t.class||"",this.locCode=t.label,this.currentOff=[0,0],this.targetOff=[0,0],this.pressed=0,this.onclick=g.a,this.ix=new y.a({value:0,interpolation:"elastic",rigidity:.2,friction:10}),this.iy=new y.a({value:0,interpolation:"elastic",rigidity:.2,friction:10})}},{key:"render",value:function(){this.refs.front=document.createElement("div"),this.refs.front.classList.add("button-front"),this.refs.front.textContent=m.a[p.a.get("lang")][this.locCode],this.refs.front.dataset.filltxt=m.a[p.a.get("lang")][this.locCode],this.refs.back=document.createElement("div"),this.refs.back.classList.add("button-back"),this.refs.ground=document.createElement("div"),this.refs.ground.classList.add("button-ground");var t=document.createElement("div");return t.className=this.class,t.appendChild(this.refs.ground),t.appendChild(this.refs.back),t.appendChild(this.refs.front),t}},{key:"didMount",value:function(t){this.bindFuncs(["move","out","down","up","click","update","langChange"]),t.addEventListener("mousemove",this.move),t.addEventListener("mouseout",this.out),t.addEventListener("mousedown",this.down),t.addEventListener("mouseup",this.up),t.addEventListener("click",this.click),p.a.watch("lang",this.langChange),v.a.add(this.update)}},{key:"langChange",value:function(){this.refs.front.textContent=m.a[p.a.get("lang")][this.locCode],this.refs.front.dataset.filltxt=m.a[p.a.get("lang")][this.locCode]}},{key:"click",value:function(){this.onclick()}},{key:"out",value:function(t){this.ix.to(0),this.iy.to(0),this.ix.interpolationParams.rigidity=.1,this.iy.interpolationParams.rigidity=.1}},{key:"move",value:function(t){var e=t?t.clientX:this.mx,n=t?t.clientY:this.my;t&&(this.mx=t.clientX,this.my=t.clientY);var i=this.refs.base.getBoundingClientRect();this.ix.interpolationParams.rigidity=.2,this.iy.interpolationParams.rigidity=.2,this.ix.to(.12*-(i.left-e+i.width/2)*(1-this.pressed)),this.iy.to(.12*-(i.top-n+i.height/2)-3*(1-this.pressed))}},{key:"down",value:function(){this.pressed=1,this.move()}},{key:"up",value:function(){this.pressed=0,this.move()}},{key:"update",value:function(){this.refs&&this.refs.front&&(this.ix.update(),this.iy.update(),this.refs.front.style.transform="translate3d("+this.ix.value+"px, "+this.iy.value+"px, 0) rotate("+-this.ix.value*this.iy.value*.05+"deg)",this.refs.back.style.transform="translate3d("+.2*this.ix.value+"px, "+.2*this.iy.value+"px, 0) rotate("+.8*-this.ix.value*this.iy.value*.05+"deg)")}},{key:"willUnmount",value:function(){this.update=g.a,v.a.remove(this.update),p.a.unwatch("lang",this.langChange),this.onclick=g.a,this.refs.base.removeEventListener("click",this.click),this.refs.base.removeEventListener("mousemove",this.move),this.refs.base.removeEventListener("mouseout",this.out),this.refs.base.removeEventListener("mousedown",this.down),this.refs.base.removeEventListener("mouseup",this.up)}}]),e}(f.a);e.a=b},function(t,e){},function(t,e,n){"use strict";var i=n(42),o=n(19),r=n(76),a=n(26),s=n(27),u=n(38),c=n(111),h=n(44),l=n(80),d=n(14)("iterator"),f=!([].keys&&"next"in[].keys()),p=function(){return this};t.exports=function(t,e,n,v,y,m,g){c(n,e,v);var b,x,w,k=function(t){if(!f&&t in S)return S[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},M=e+" Iterator",_="values"==y,E=!1,S=t.prototype,T=S[d]||S["@@iterator"]||y&&S[y],C=T||k(y),P=y?_?k("entries"):C:void 0,O="Array"==e?S.entries||T:T;if(O&&(w=l(O.call(new t)))!==Object.prototype&&(h(w,M,!0),i||s(w,d)||a(w,d,p)),_&&T&&"values"!==T.name&&(E=!0,C=function(){return T.call(this)}),i&&!g||!f&&!E&&S[d]||a(S,d,C),u[e]=C,u[M]=p,y)if(b={values:_?C:k("values"),keys:m?C:k("keys"),entries:P},g)for(x in b)x in S||r(S,x,b[x]);else o(o.P+o.F*(f||E),e,b);return b}},function(t,e,n){t.exports=!n(23)&&!n(32)(function(){return 7!=Object.defineProperty(n(57)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){t.exports=n(26)},function(t,e,n){var i=n(27),o=n(24),r=n(113)(!1),a=n(61)("IE_PROTO");t.exports=function(t,e){var n,s=o(t),u=0,c=[];for(n in s)n!=a&&i(s,n)&&c.push(n);for(;e.length>u;)i(s,n=e[u++])&&(~r(c,n)||c.push(n));return c}},function(t,e,n){var i=n(39);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e,n){t.exports=n(15).document&&document.documentElement},function(t,e,n){var i=n(27),o=n(40),r=n(61)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),i(t,r)?t[r]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,n){n(115);for(var i=n(15),o=n(26),r=n(38),a=n(14)("toStringTag"),s=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],u=0;u<5;u++){var c=s[u],h=i[c],l=h&&h.prototype;l&&!l[a]&&o(l,a,c),r[c]=r.Array}},function(t,e,n){var i=n(39),o=n(14)("toStringTag"),r="Arguments"==i(function(){return arguments}()),a=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=a(e=Object(t),o))?n:r?i(e):"Object"==(s=i(e))&&"function"==typeof e.callee?"Arguments":s}},function(t,e,n){var i=n(22);t.exports=function(t,e,n,o){try{return o?e(i(n)[0],n[1]):e(n)}catch(e){var r=t.return;throw void 0!==r&&i(r.call(t)),e}}},function(t,e,n){var i=n(38),o=n(14)("iterator"),r=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||r[o]===t)}},function(t,e,n){var i=n(82),o=n(14)("iterator"),r=n(38);t.exports=n(12).getIteratorMethod=function(t){if(void 0!=t)return t[o]||t["@@iterator"]||r[i(t)]}},function(t,e,n){var i,o,r,a=n(30),s=n(122),u=n(79),c=n(57),h=n(15),l=h.process,d=h.setImmediate,f=h.clearImmediate,p=h.MessageChannel,v=0,y={},m=function(){var t=+this;if(y.hasOwnProperty(t)){var e=y[t];delete y[t],e()}},g=function(t){m.call(t.data)};d&&f||(d=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return y[++v]=function(){s("function"==typeof t?t:Function(t),e)},i(v),v},f=function(t){delete y[t]},"process"==n(39)(l)?i=function(t){l.nextTick(a(m,t,1))}:p?(o=new p,r=o.port2,o.port1.onmessage=g,i=a(r.postMessage,r,1)):h.addEventListener&&"function"==typeof postMessage&&!h.importScripts?(i=function(t){h.postMessage(t+"","*")},h.addEventListener("message",g,!1)):i="onreadystatechange"in c("script")?function(t){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),m.call(t)}}:function(t){setTimeout(a(m,t,1),0)}),t.exports={set:d,clear:f}},function(t,e,n){var i=n(14)("iterator"),o=!1;try{var r=[7][i]();r.return=function(){o=!0},Array.from(r,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!o)return!1;var n=!1;try{var r=[7],a=r[i]();a.next=function(){return{done:n=!0}},r[i]=function(){return a},t(r)}catch(t){}return n}},function(t,e,n){var i,o;!function(r){var a=!1;if(i=r,void 0!==(o="function"==typeof i?i.call(e,n,e,t):i)&&(t.exports=o),a=!0,t.exports=r(),a=!0,!a){var s=window.Cookies,u=window.Cookies=r();u.noConflict=function(){return window.Cookies=s,u}}}(function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var i in n)e[i]=n[i]}return e}function e(n){function i(e,o,r){var a;if("undefined"!=typeof document){if(arguments.length>1){if(r=t({path:"/"},i.defaults,r),"number"==typeof r.expires){var s=new Date;s.setMilliseconds(s.getMilliseconds()+864e5*r.expires),r.expires=s}r.expires=r.expires?r.expires.toUTCString():"";try{a=JSON.stringify(o),/^[\{\[]/.test(a)&&(o=a)}catch(t){}o=n.write?n.write(o,e):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)),e=e.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),e=e.replace(/[\(\)]/g,escape);var u="";for(var c in r)r[c]&&(u+="; "+c,!0!==r[c]&&(u+="="+r[c]));return document.cookie=e+"="+o+u}e||(a={});for(var h=document.cookie?document.cookie.split("; "):[],l=/(%[0-9A-Z]{2})+/g,d=0;d<h.length;d++){var f=h[d].split("="),p=f.slice(1).join("=");this.json||'"'!==p.charAt(0)||(p=p.slice(1,-1));try{var v=f[0].replace(l,decodeURIComponent);if(p=n.read?n.read(p,v):n(p,v)||p.replace(l,decodeURIComponent),this.json)try{p=JSON.parse(p)}catch(t){}if(e===v){a=p;break}e||(a[v]=p)}catch(t){}}return a}}return i.set=i,i.get=function(t){return i.call(i,t)},i.getJSON=function(){return i.apply({json:!0},[].slice.call(arguments))},i.defaults={},i.remove=function(e,n){i(e,"",t(n,{expires:-1}))},i.withConverter=e,i}return e(function(){})})},function(t,e,n){function i(t,e,n){var i=!0,s=!0;if("function"!=typeof t)throw new TypeError(a);return r(n)&&(i="leading"in n?!!n.leading:i,s="trailing"in n?!!n.trailing:s),o(t,e,{leading:i,maxWait:e,trailing:s})}var o=n(126),r=n(64),a="Expected a function";t.exports=i},function(t,e,n){var i=n(128),o="object"==typeof self&&self&&self.Object===Object&&self,r=i||o||Function("return this")();t.exports=r},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){function i(t){if("number"==typeof t)return t;if(r(t))return a;if(o(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=o(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(s,"");var n=c.test(t);return n||h.test(t)?l(t.slice(2),n?2:8):u.test(t)?a:+t}var o=n(64),r=n(93),a=NaN,s=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,h=/^0o[0-7]+$/i,l=parseInt;t.exports=i},function(t,e,n){function i(t){return"symbol"==typeof t||r(t)&&o(t)==a}var o=n(129),r=n(132),a="[object Symbol]";t.exports=i},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var o=n(149),r=i(o),a=n(151),s=i(a),u="function"==typeof s.default&&"symbol"==typeof r.default?function(t){return typeof t}:function(t){return t&&"function"==typeof s.default&&t.constructor===s.default&&t!==s.default.prototype?"symbol":typeof t};e.default="function"==typeof s.default&&"symbol"===u(r.default)?function(t){return void 0===t?"undefined":u(t)}:function(t){return t&&"function"==typeof s.default&&t.constructor===s.default&&t!==s.default.prototype?"symbol":void 0===t?"undefined":u(t)}},function(t,e,n){var i=n(77),o=n(63).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,o)}},function(t,e,n){"use strict";function i(){b=d.a.getScene(),x=f.a.getChunkSize()}function o(t){return Math.floor(Object(g.a)(-t+Math.PI+Math.PI/4,2*Math.PI)/(Math.PI/2))%4}function r(){var t=y.a.get("player.position").slice(),e=o(y.a.get("player.angle")),n=[0,0];0===e?n[1]=-1:1===e?n[0]=1:2===e?n[1]=1:3===e&&(n[0]=-1),t[0]+=n[0]*x,t[1]+=n[1]*x;var i=m.a.random()<.92;0===t[0]&&i?t[0]+=(m.a.random()>.5?1:-1)*x:0===t[1]&&i&&(t[1]+=(m.a.random()>.5?1:-1)*x);var r=f.a.getChunkFromThreePos(t[0],t[1]),u=l()(r.road),c=r.road[u[m.a.randomInt(0,u.length-1)]],h=new p.a({id:++w,x:r.x+c.p[0]+.5,y:r.y+c.p[1]+.5,angle:c.r*(Math.PI/2),onDeath:a,onRemoved:s});k.push(h),b.add(h.group),v.a.emit("cop.added",{id:h.id,position:[h.group.position.x,h.group.position.z]})}function a(t){v.a.emit("cop.removed",{id:t.id});var e=k.indexOf(t);~e&&k.splice(e,1),~(e=M.indexOf(t))||M.push(t)}function s(t){var e=k.indexOf(t);~e&&(v.a.emit("cop.removed",{id:t.id}),k.splice(e,1)),e=M.indexOf(t),~e&&M.splice(e,1),b.remove(t.group),t.destroy()}function u(t){C&&(k.length+E<_&&(E=_-k.length),T+=t,T>S&&(E--&&r(),T=0),k.forEach(function(e){return e.update(t)}),M.forEach(function(e){return e.update(t)}))}function c(t){if(t)return void(C=t);C=!1,M.forEach(function(t){return t.destroy()}),k.forEach(function(t){return t.destroy()}),k=[],M=[],S=3e3,T=4e3}var h=n(41),l=n.n(h),d=n(7),f=n(17),p=(n(25),n(175)),v=n(16),y=n(0),m=n(8),g=n(50),b=void 0,x=void 0,w=-1,k=[],M=[],_=8,E=0,S=4100,T=5e3,C=!1;e.a={setSpawn:c,setup:i,addCop:r,update:u,getAlive:function(){return k}}},function(t,e,n){"use strict";var i=n(98),o=n.n(i),r=n(3),a=n.n(r),s=n(1),u=n.n(s),c=n(2),h=n.n(c),l=n(4),d=n.n(l),f=n(10),p=n.n(f),v=n(5),y=n.n(v),m=n(9),g=n(182),b=n(99),x=(n(50),n(0),n(51)),w=n(8),k=n(17),M=n(25),_=n(35),E=function(t){function e(t){u()(this,e);var n=d()(this,(e.__proto__||a()(e)).call(this,t));return n.speed=0,n.maxSpeed=void 0!==n.maxSpeed?n.maxSpeed:1,n.limiter=n.maxSpeed,n.speedMult=1,n.dead=!1,n.maxSteer=void 0!==n.maxSteer?n.maxSteer:Math.PI/5.2,n.engineBaseForce=void 0!==n.engineBaseForce?n.engineBaseForce:2.5,n.frontWheelFriction=void 0!==n.frontWheelFriction?n.frontWheelFriction:2,n.backWheelFriction=void 0!==n.backWheelFriction?n.backWheelFriction:2.9,n.lerpSteerValue=void 0!==n.lerpSteerValue?n.lerpSteerValue:.068,n.running=!!n.running,n.useBackward=!!n.backwardDetection,n.useAntiObstacle=!!n.useAntiObstacle,n.frontWheel.setSideFriction(n.frontWheelFriction),n.backWheel.setSideFriction(n.backWheelFriction),n.needsBackwardScore=0,n.needsBackward=!1,n.antiObstacleScore=0,n.antiObstacle=!1,n.antiObstacleDir=1,n.bodyPos=n.body.position,n.bodyVel=n.body.velocity,n.waypoints=new g.a({isPlayer:!!n.isPlayer,debug:!!n.debugWaypoints,improvise:!!n.improvise,improvisationTreshold:n.improvisationTreshold,improvisationMode:n.improvisationMode,posPointer:n.bodyPos}),n.debugSteering&&(n.steeringArrow=n.addComponent(new b.a({y:.1}))),n.frontWheel.targetSteerValue=0,n.smokeDensity=0,n.smokeTimer=0,n.smokeCycle=300,n.sandDensity=0,n.sandTimer=0,n.sandCycle=300,n.steerSmokeDensity=0,n.steerSmokeTimer=0,n.steerSmokeCycle=10,n}return y()(e,t),h()(e,[{key:"limitSpeed",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.targetLimiter=this.maxSpeed*(this.isPlayer?this.speedMult:1)+t,this.limiter+=.2*(this.targetLimiter-this.limiter),this.speed>this.limiter){var e=this.limiter/this.speed;this.bodyVel[0]*=e,this.bodyVel[1]*=e,this.speed=this.limiter}}},{key:"didDie",value:function(){}},{key:"deadUpdate",value:function(t){if(this.alreadyDead||(this.backWheel.setBrakeForce(3),this.frontWheel.targetSteerValue=0,this.frontWheel.steerValue=0,this.frontWheel.engineForce=0,this.isPlayer||(this.vehicle&&this.vehicle.removeFromWorld(),this.vehicle=void 0,this.world.addBody(this.body)),this.deadForceTimer=800,this.alreadyDead=!0,this.didDie()),this.deadForceTimer>0){var e=this.deadForceTimer/800;this.body.applyForceLocal([4*e,-6*e],[0,.06*e]),this.body.applyForceLocal([3*e,-1*e]),this.deadForceTimer-=t}this.body.velocity[0]*=.95,this.body.velocity[1]*=.95,this.body.angularVelocity*=.95,this.group.position.x=-this.bodyPos[0],this.group.position.z=this.bodyPos[1],this.chassis.rotation.y=this.body.angle}},{key:"smokeUpdate",value:function(t){if(this.smokeDensity>0)if(this.smokeTimer>this.smokeCycle){if(!this.visible)return void(this.smokeTimer=0);x.a.emit({x:this.group.position.x+.05*(2*w.a.random()-1),y:.05,z:this.group.position.z+.05*(2*w.a.random()-1),type:1,amount:Math.min(2,Math.max(1,1*this.smokeDensity))}),this.smokeTimer=0}else this.smokeTimer+=t*this.smokeDensity;if(this.sandDensity>0)if(this.sandTimer>this.sandCycle){if(!this.visible)return void(this.sandTimer=0);var e=this.chassis.localToWorld(new THREE.Vector3(-.04,0,-.06)),n=this.chassis.localToWorld(new THREE.Vector3(.04,0,-.06));x.a.emit({x:e.x,y:0,z:e.z,type:0,amount:Math.min(6,Math.max(1,1*this.sandDensity))}),x.a.emit({x:n.x,y:0,z:n.z,type:0,amount:Math.min(6,Math.max(1,1*this.sandDensity))}),this.sandTimer=0}else this.sandTimer+=t*this.sandDensity;if(this.steerSmokeDensity>0)if(this.steerSmokeTimer>this.steerSmokeCycle){if(!this.visible)return void(this.steerSmokeTimer=0);var i=this.chassis.localToWorld(new THREE.Vector3(-.04,0,-.06)),o=this.chassis.localToWorld(new THREE.Vector3(.04,0,-.06));x.a.emit({x:i.x,y:0,z:i.z,type:4,amount:Math.min(6,Math.max(1,1*this.steerSmokeDensity))}),x.a.emit({x:o.x,y:0,z:o.z,type:4,amount:Math.min(6,Math.max(3,1*this.steerSmokeDensity))}),this.steerSmokeTimer=0}else this.steerSmokeTimer+=t*this.steerSmokeDensity}},{key:"update",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];p()(e.prototype.__proto__||a()(e.prototype),"update",this).call(this,t),this.visible=M.a.isPointVisible(this.group.position);var i=k.a.getRoadFromThreePos(this.group.position.x,this.group.position.z);this.onRoad=!!i,this.onSand=!i||15===i.c,i?15===i.c?(this.sandDensity=9*this.speed,this.speedMult=.8,this.isPlayer&&this.backWheel.setSideFriction(2.4)):(this.sandDensity=0,this.speedMult=1,this.isPlayer&&this.backWheel.setSideFriction(2.9)):(this.sandDensity=17*this.speed,this.speedMult=.7,this.isPlayer&&this.backWheel.setSideFriction(2.4)),this.speed=(Math.pow(this.bodyVel[0],2)+Math.pow(this.bodyVel[1],2))/2,this.limitSpeed(),this.angularVelocity=this.body.angularVelocity;var o=Math.abs(this.angularVelocity);if(this.steerSmokeDensity=.2*o*(o>1.6),this.smokeUpdate(t),this.dead)return void this.deadUpdate(t);if(this.target||this.waypoints.update(this.bodyPos,this.body.angle),n&&(this.frontWheel.steerValue=0,this.frontWheel.engineForce=0,this.backWheel.setBrakeForce(3)),!n)if(this.running&&this.target)this.goto(this.target[0],this.target[1]);else if((this.running||this.manualControls)&&this.waypoints.list.length>0){var r=this.waypoints.getClosest(-this.bodyPos[0],this.bodyPos[1]);this.goto(r.point)}else this.manualControls||(this.frontWheel.targetSteerValue=0,this.engineForce=0,this.backWheel.setBrakeForce(4));this.group.position.x=-this.bodyPos[0],this.group.position.z=this.bodyPos[1],this.chassis.rotation.y=this.body.angle,this.frontWheel.steerValue+=(this.frontWheel.targetSteerValue-this.frontWheel.steerValue)*(this.target?.4:this.lerpSteerValue),this.targetRot=this.body.angularVelocity/30*-(this.body.velocity[0]+this.body.velocity[1]),this.chassis.rotation.z+=.2*(this.targetRot-this.chassis.rotation.z),this.targetRot=this.body.angularVelocity/100*-(this.body.velocity[0]+this.body.velocity[1]),this.chassis.rotation.x+=.1*(this.targetRot-this.chassis.rotation.x)}},{key:"goto",value:function(t,e){var n=void 0===e,i=n?t.x:t,r=n?t.y:e,a=-Math.atan2(r-this.bodyPos[1],i+this.bodyPos[0])+Math.PI/2-this.body.angle;a%=2*Math.PI,Math.abs(a)>=Math.PI&&(a-=o()(a)*(2*Math.PI));var s=a;s>.6*Math.PI||s<.6*-Math.PI?(this.needsBackwardScore<35&&this.needsBackwardScore+1>=35&&(this.needsBackwardScore=60),this.needsBackwardScore=Math.min(80,this.needsBackwardScore+1)):this.needsBackwardScore=Math.max(0,this.needsBackwardScore-1),this.needsBackward=!(this.needsBackwardScore<35),this.running&&this.speed<.005?((this.antiObstacleScore<35&&this.antiObstacleScore+1>=35||this.antiObstacleScore<180&&this.antiObstacleScore+1>=120)&&(this.antiObstacleDir=(this.antiObstacleDir+1)%4,this.antiObstacleScore=80),this.antiObstacleScore=Math.min(240,this.antiObstacleScore+1)):this.antiObstacleScore=Math.max(0,this.antiObstacleScore-1),this.antiObstacle=!(this.antiObstacleScore<35),this.antiObstacle&&(s+=Math.PI*this.antiObstacleDir),s=Math.max(-this.maxSteer,Math.min(this.maxSteer,s));var u=1,c=1;this.antiObstacle&&(u=2*(this.antiObstacleDir>1)-1,c=this.antiObstacleDir%2*2-1),this.debugSteering&&(this.steeringArrow.group.rotation.y=this.body.angle+s),this.manualControls||(this.backWard,this.backWheel.setBrakeForce(1),this.antiObstacle&&this.backWheel.setBrakeForce(0),this.frontWheel.engineForce=this.engineBaseForce*(this.needsBackward?-.7:1)*u,this.frontWheel.targetSteerValue=s*(this.needsBackward?-1:1)*c)}},{key:"destroy",value:function(){this.body&&(this.body.propType="dead",this.body.impactCallback=void 0),p()(e.prototype.__proto__||a()(e.prototype),"destroy",this).call(this),this.chassis=null}},{key:"explode",value:function(){this.dead||(_.a.blast(this.group.position),this.dead=!0,this.body&&(this.body.propType="dead",this.body.impactCallback=void 0))}}]),e}(m.a);e.a=E},function(t,e,n){t.exports={default:n(179),__esModule:!0}},function(t,e,n){"use strict";var i=n(49),o=n.n(i),r=n(3),a=n.n(r),s=n(1),u=n.n(s),c=n(2),h=n.n(c),l=n(4),d=n.n(l),f=n(5),p=n.n(f),v=n(0),y=n(9),m=function(t){function e(){return u()(this,e),d()(this,(e.__proto__||a()(e)).apply(this,arguments))}return p()(e,t),h()(e,[{key:"setup",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t=o()({},{x:0,y:0,z:0,r:0},t),this.group=new THREE.Group;var e=t.color||"red";this.meshes.arrow=new THREE.Mesh(v.a.get("geo.box"),v.a.get("mat."+e)),this.meshes.base=new THREE.Mesh(v.a.get("geo.box"),v.a.get("mat."+e)),this.group.add(this.meshes.arrow),this.group.add(this.meshes.base),this.meshes.base.scale.set(3,1,.1),this.meshes.base.position.set(0,0,.3),this.group.scale.set(.02,.01,.2),this.group.position.set(t.x,t.y,t.z),this.group.rotation.y=t.r}}]),e}(y.a);e.a=m},function(t,e,n){"use strict";function i(){function t(t,e){return s.push({reg:new RegExp(t,"g"),to:e}),c}function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"string"==typeof t&&t.length>0&&(u=t,o[u]||(o[u]=[])),c}function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u&&"string"==typeof t&&t.length>0&&o[u].push({regex:new RegExp("(?:^| )("+t+")(?: |$)","g"),opts:r()({},a,e)}),c}function i(){var t=0,e={};for(var n in o)o[n].length>t&&(t=o[n].length),e[n]=o[n].length;return{orders:o,replacers:s,max:t,maxs:e}}var o={},s=[],u=null,c={add:n,order:e,toObj:i,replacer:t};return c}e.a=i;var o=n(49),r=n.n(o),a={continuous:!0,capture:!1}},function(t,e,n){"use strict";function i(){a.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),a.scene=new THREE.Scene;var t=new THREE.PlaneBufferGeometry(2,.8);t.translate(0,.6,0),a.material=r.a.getMaterial(),a.quad=new THREE.Mesh(t,a.material),a.quad.frustumCulled=!1,a.scene.add(a.quad)}function o(t){var e=s-t;e>Math.PI&&s>=0&&t<0?e=s-(Math.PI+(Math.PI+t)):e<-Math.PI&&s<0&&t>=0&&(e=s+(Math.PI+(Math.PI-t))),a.material.uniforms.angle.value-=e,a.material.uniforms.angle.needsUpdate=!0,s=t}var r=(n(0),n(207)),a={camera:null,scene:null,quad:null,material:null,setup:i,setAngle:o},s=0;e.a=a},function(t,e,n){"use strict";function i(){c.mount(h),l=c.refs.base,h.removeChild(l)}function o(){return h.appendChild(l),l.getBoundingClientRect(),c.show()}function r(){return new s.a(function(t){c.hide().then(function(){h.removeChild(l),t()})})}var a=n(29),s=n.n(a),u=n(211),c=new u.a,h=document.body,l=void 0;e.a={setup:i,show:o,hide:r}},function(t,e,n){"use strict";var i=n(1),o=n.n(i),r=n(2),a=n.n(r),s=n(217),u=n(218),c=n(219),h=function(){function t(e){var n=e.value,i=e.interpolation,r=void 0===i?"linear":i,a=e.precisionStop,s=void 0===a?.001:a,u=e.perfectStop,c=void 0!==u&&u,h=e.rigidity,l=void 0===h?.1:h,d=e.friction,f=void 0===d?10:d,p=e.mass,v=void 0===p?.01:p;o()(this,t),this.value=n,this.targetValue=n,this.stopped=!0,this.precisionStop=s,this.perfectStop=c,this.interpolationFn=this.getInterpolation(r),this.interpolationParams={rigidity:l,friction:f,mass:v}}return a()(t,[{key:"getInterpolation",value:function(t){switch(t){case"elastic":return u.a;case"bounce":return c.a;default:return s.a}}},{key:"to",value:function(t){this.targetValue=t,this.stopped&&this.start()}},{key:"start",value:function(){this.reset=!0,this.stopped=!1,this.lastTime=Date.now()-17}},{key:"update",value:function(){if(this.stopped)return!1;var t=Date.now(),e=this.value-this.targetValue;return this.value=this.interpolationFn.call(this,this.value,this.targetValue,this.interpolationParams,.01667,this.reset),this.reset&&(this.reset=!1),this.needStop(e)&&(this.perfectStop&&(this.value=this.targetValue),this.stop()),this.lastTime=t,this.value}},{key:"needStop",value:function(t){return Math.abs(t)<this.precisionStop&&(!!isNaN(this.speed)||Math.abs(this.speed)<this.precisionStop)}},{key:"stop",value:function(){this.stopped=!0}},{key:"destroy",value:function(){this.stop(),this.interpolationFn=null,this.interpolationParams=null}}]),t}();e.a=h},function(t,e,n){function i(t,e,n){t=s(t),e=a(e);var i=e?r(t):0;return e&&i<e?o(e-i,n)+t:t}var o=n(229),r=n(106),a=n(241),s=n(243);t.exports=i},function(t,e,n){function i(t){if("string"==typeof t)return t;if(a(t))return r(t,i)+"";if(s(t))return h?h.call(t):"";var e=t+"";return"0"==e&&1/t==-u?"-0":e}var o=n(65),r=n(231),a=n(232),s=n(93),u=1/0,c=o?o.prototype:void 0,h=c?c.toString:void 0;t.exports=i},function(t,e,n){function i(t){return r(t)?a(t):o(t)}var o=n(235),r=n(71),a=n(237);t.exports=i},function(t,e,n){n(108),t.exports=n(278)},function(t,e,n){"use strict";function i(){F.destroy(),s()}function o(){return new c.a(function(t,e){c.a.resolve().then(k.a.show).then(function(){return F.destroy()}).then(function(){return I.hydrate(document.querySelector(".homescreen"))}).then(function(){I.onstart=s}).then(function(){return I.show()}).then(k.a.hide).then(t).catch(e)})}function r(t){var e=new S.a({error:t});c.a.resolve().then(function(){return F.stopPerm()}).then(k.a.show).then(function(){return F.destroy()}).then(function(){return e.mount(document.body)}).then(function(){return e.show()}).then(k.a.hide)}function a(){x.a.setup(document.querySelector(".game-three")),x.a.addComponent(new T.a)}function s(){var t=p.a.get("lang"),e={0:"SD",1:"HD"};p.a.set("quality",e[p.a.get("quality")]||e[1]),c.a.resolve().then(a).then(function(){return!!f.a.quickstart||k.a.show()}).then(function(){return f.a.enableSpeech&&g.a.setLang(t)}).then(function(){return R.hydrate(document.querySelector(".game-gui"))}).then(x.a.start).then(function(){return f.a.quickstart?document.querySelector(".homescreen").parentNode.removeChild(document.querySelector(".homescreen")):I.destroy()}).then(function(){return!!f.a.quickstart||k.a.hide()})}Object.defineProperty(e,"__esModule",{value:!0});var u=n(29),c=n.n(u),h=n(88),l=(n.n(h),n(89)),d=n.n(l),f=n(6),p=n(0),v=n(8),y=n(138),m=n(140),g=n(45),b=n(141),x=n(7),w=n(35),k=n(102),M=n(212),_=n(213),E=n(220),S=n(244),T=n(245),C={fr:0,en:1};h.get("lang")&&C[h.get("lang")]?p.a.set("lang",h.get("lang")):p.a.set("lang",Object(y.a)()),p.a.set("langIndex",C[p.a.get("lang")]),p.a.set("quality",h.get("quality")||1);for(var P=document.getElementsByTagName("noscript"),O=0;O<P.length;O++)P[0].parentNode.removeChild(P[0]);P=void 0,v.a.setSeed(+new Date);var R=new E.a,I=new _.a,F=new M.a;I.onstart=s;var L=d()(function(){p.a.set("size",{w:window.innerWidth,h:window.innerHeight})},50);window.addEventListener("resize",L),p.a.set("size",{w:window.innerWidth,h:window.innerHeight}),c.a.resolve().then(k.a.setup).then(function(){return F.hydrate(document.querySelector(".preloader"))}).then(m.a.loadJS).then(function(){return c.a.all([m.a.loadImages(),m.a.loadBlobs(),m.a.loadTextures()])}).then(m.a.loadObjects).then(m.a.loadChunks).then(w.a.setup).then(function(){return F.beginPerm()}).then(function(){return f.a.enableSpeech&&g.a.start()}).then(function(){return f.a.enableSpeech&&b.a.start()}).then(function(){return F.stopPerm()}).then(function(){return f.a.quickstart?i():o()}).catch(r)},function(t,e,n){n(73),n(53),n(81),n(118),t.exports=n(12).Promise},function(t,e,n){var i=n(54),o=n(55);t.exports=function(t){return function(e,n){var r,a,s=String(o(e)),u=i(n),c=s.length;return u<0||u>=c?t?"":void 0:(r=s.charCodeAt(u),r<55296||r>56319||u+1===c||(a=s.charCodeAt(u+1))<56320||a>57343?t?s.charAt(u):r:t?s.slice(u,u+2):a-56320+(r-55296<<10)+65536)}}},function(t,e,n){"use strict";var i=n(59),o=n(37),r=n(44),a={};n(26)(a,n(14)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=i(a,{next:o(1,n)}),r(t,e+" Iterator")}},function(t,e,n){var i=n(20),o=n(22),r=n(33);t.exports=n(23)?Object.defineProperties:function(t,e){o(t);for(var n,a=r(e),s=a.length,u=0;s>u;)i.f(t,n=a[u++],e[n]);return t}},function(t,e,n){var i=n(24),o=n(60),r=n(114);t.exports=function(t){return function(e,n,a){var s,u=i(e),c=o(u.length),h=r(a,c);if(t&&n!=n){for(;c>h;)if((s=u[h++])!=s)return!0}else for(;c>h;h++)if((t||h in u)&&u[h]===n)return t||h||0;return!t&&-1}}},function(t,e,n){var i=n(54),o=Math.max,r=Math.min;t.exports=function(t,e){return t=i(t),t<0?o(t+e,0):r(t,e)}},function(t,e,n){"use strict";var i=n(116),o=n(117),r=n(38),a=n(24);t.exports=n(74)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,o(1)):"keys"==e?o(0,n):"values"==e?o(0,t[n]):o(0,[n,t[n]])},"values"),r.Arguments=r.Array,i("keys"),i("values"),i("entries")},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){"use strict";var i,o,r,a=n(42),s=n(15),u=n(30),c=n(82),h=n(19),l=n(31),d=n(56),f=n(119),p=n(120),v=n(121),y=n(86).set,m=n(123)(),g=s.TypeError,b=s.process,x=s.Promise,b=s.process,w="process"==c(b),k=function(){},M=!!function(){try{var t=x.resolve(1),e=(t.constructor={})[n(14)("species")]=function(t){t(k,k)};return(w||"function"==typeof PromiseRejectionEvent)&&t.then(k)instanceof e}catch(t){}}(),_=function(t,e){return t===e||t===x&&e===r},E=function(t){var e;return!(!l(t)||"function"!=typeof(e=t.then))&&e},S=function(t){return _(x,t)?new T(t):new o(t)},T=o=function(t){var e,n;this.promise=new t(function(t,i){if(void 0!==e||void 0!==n)throw g("Bad Promise constructor");e=t,n=i}),this.resolve=d(e),this.reject=d(n)},C=function(t){try{t()}catch(t){return{error:t}}},P=function(t,e){if(!t._n){t._n=!0;var n=t._c;m(function(){for(var i=t._v,o=1==t._s,r=0;n.length>r;)!function(e){var n,r,a=o?e.ok:e.fail,s=e.resolve,u=e.reject,c=e.domain;try{a?(o||(2==t._h&&I(t),t._h=1),!0===a?n=i:(c&&c.enter(),n=a(i),c&&c.exit()),n===e.promise?u(g("Promise-chain cycle")):(r=E(n))?r.call(n,s,u):s(n)):u(i)}catch(t){u(t)}}(n[r++]);t._c=[],t._n=!1,e&&!t._h&&O(t)})}},O=function(t){y.call(s,function(){var e,n,i,o=t._v;if(R(t)&&(e=C(function(){w?b.emit("unhandledRejection",o,t):(n=s.onunhandledrejection)?n({promise:t,reason:o}):(i=s.console)&&i.error&&i.error("Unhandled promise rejection",o)}),t._h=w||R(t)?2:1),t._a=void 0,e)throw e.error})},R=function(t){if(1==t._h)return!1;for(var e,n=t._a||t._c,i=0;n.length>i;)if(e=n[i++],e.fail||!R(e.promise))return!1;return!0},I=function(t){y.call(s,function(){var e;w?b.emit("rejectionHandled",t):(e=s.onrejectionhandled)&&e({promise:t,reason:t._v})})},F=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),P(e,!0))},L=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw g("Promise can't be resolved itself");(e=E(t))?m(function(){var i={_w:n,_d:!1};try{e.call(t,u(L,i,1),u(F,i,1))}catch(t){F.call(i,t)}}):(n._v=t,n._s=1,P(n,!1))}catch(t){F.call({_w:n,_d:!1},t)}}};M||(x=function(t){f(this,x,"Promise","_h"),d(t),i.call(this);try{t(u(L,this,1),u(F,this,1))}catch(t){F.call(this,t)}},i=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},i.prototype=n(124)(x.prototype,{then:function(t,e){var n=S(v(this,x));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=w?b.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&P(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),T=function(){var t=new i;this.promise=t,this.resolve=u(L,t,1),this.reject=u(F,t,1)}),h(h.G+h.W+h.F*!M,{Promise:x}),n(44)(x,"Promise"),n(125)("Promise"),r=n(12).Promise,h(h.S+h.F*!M,"Promise",{reject:function(t){var e=S(this);return(0,e.reject)(t),e.promise}}),h(h.S+h.F*(a||!M),"Promise",{resolve:function(t){if(t instanceof x&&_(t.constructor,this))return t;var e=S(this);return(0,e.resolve)(t),e.promise}}),h(h.S+h.F*!(M&&n(87)(function(t){x.all(t).catch(k)})),"Promise",{all:function(t){var e=this,n=S(e),i=n.resolve,o=n.reject,r=C(function(){var n=[],r=0,a=1;p(t,!1,function(t){var s=r++,u=!1;n.push(void 0),a++,e.resolve(t).then(function(t){u||(u=!0,n[s]=t,--a||i(n))},o)}),--a||i(n)});return r&&o(r.error),n.promise},race:function(t){var e=this,n=S(e),i=n.reject,o=C(function(){p(t,!1,function(t){e.resolve(t).then(n.resolve,i)})});return o&&i(o.error),n.promise}})},function(t,e){t.exports=function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var i=n(30),o=n(83),r=n(84),a=n(22),s=n(60),u=n(85),c={},h={},e=t.exports=function(t,e,n,l,d){var f,p,v,y,m=d?function(){return t}:u(t),g=i(n,l,e?2:1),b=0;if("function"!=typeof m)throw TypeError(t+" is not iterable!");if(r(m)){for(f=s(t.length);f>b;b++)if((y=e?g(a(p=t[b])[0],p[1]):g(t[b]))===c||y===h)return y}else for(v=m.call(t);!(p=v.next()).done;)if((y=o(v,g,p.value,e))===c||y===h)return y};e.BREAK=c,e.RETURN=h},function(t,e,n){var i=n(22),o=n(56),r=n(14)("species");t.exports=function(t,e){var n,a=i(t).constructor;return void 0===a||void 0==(n=i(a)[r])?e:o(n)}},function(t,e){t.exports=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var i=n(15),o=n(86).set,r=i.MutationObserver||i.WebKitMutationObserver,a=i.process,s=i.Promise,u="process"==n(39)(a);t.exports=function(){var t,e,n,c=function(){var i,o;for(u&&(i=a.domain)&&i.exit();t;){o=t.fn,t=t.next;try{o()}catch(i){throw t?n():e=void 0,i}}e=void 0,i&&i.enter()};if(u)n=function(){a.nextTick(c)};else if(r){var h=!0,l=document.createTextNode("");new r(c).observe(l,{characterData:!0}),n=function(){l.data=h=!h}}else if(s&&s.resolve){var d=s.resolve();n=function(){d.then(c)}}else n=function(){o.call(i,c)};return function(i){var o={fn:i,next:void 0};e&&(e.next=o),t||(t=o,n()),e=o}}},function(t,e,n){var i=n(26);t.exports=function(t,e,n){for(var o in e)n&&t[o]?t[o]=e[o]:i(t,o,e[o]);return t}},function(t,e,n){"use strict";var i=n(15),o=n(12),r=n(20),a=n(23),s=n(14)("species");t.exports=function(t){var e="function"==typeof o[t]?o[t]:i[t];a&&e&&!e[s]&&r.f(e,s,{configurable:!0,get:function(){return this}})}},function(t,e,n){function i(t,e,n){function i(e){var n=g,i=b;return g=b=void 0,_=e,w=t.apply(i,n)}function h(t){return _=t,k=setTimeout(f,e),E?i(t):w}function l(t){var n=t-M,i=t-_,o=e-n;return S?c(o,x-i):o}function d(t){var n=t-M,i=t-_;return void 0===M||n>=e||n<0||S&&i>=x}function f(){var t=r();if(d(t))return p(t);k=setTimeout(f,l(t))}function p(t){return k=void 0,T&&g?i(t):(g=b=void 0,w)}function v(){void 0!==k&&clearTimeout(k),_=0,g=M=b=k=void 0}function y(){return void 0===k?w:p(r())}function m(){var t=r(),n=d(t);if(g=arguments,b=this,M=t,n){if(void 0===k)return h(M);if(S)return k=setTimeout(f,e),i(M)}return void 0===k&&(k=setTimeout(f,e)),w}var g,b,x,w,k,M,_=0,E=!1,S=!1,T=!0;if("function"!=typeof t)throw new TypeError(s);return e=a(e)||0,o(n)&&(E=!!n.leading,S="maxWait"in n,x=S?u(a(n.maxWait)||0,e):x,T="trailing"in n?!!n.trailing:T),m.cancel=v,m.flush=y,m}var o=n(64),r=n(127),a=n(92),s="Expected a function",u=Math.max,c=Math.min;t.exports=i},function(t,e,n){var i=n(90),o=function(){return i.Date.now()};t.exports=o},function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(e,n(91))},function(t,e,n){function i(t){return null==t?void 0===t?u:s:c&&c in Object(t)?r(t):a(t)}var o=n(65),r=n(130),a=n(131),s="[object Null]",u="[object Undefined]",c=o?o.toStringTag:void 0;t.exports=i},function(t,e,n){function i(t){var e=a.call(t,u),n=t[u];try{t[u]=void 0;var i=!0}catch(t){}var o=s.call(t);return i&&(e?t[u]=n:delete t[u]),o}var o=n(65),r=Object.prototype,a=r.hasOwnProperty,s=r.toString,u=o?o.toStringTag:void 0;t.exports=i},function(t,e){function n(t){return o.call(t)}var i=Object.prototype,o=i.toString;t.exports=n},function(t,e){function n(t){return null!=t&&"object"==typeof t}t.exports=n},function(t,e,n){"use strict";function i(t){var e=t.x,n=t.y,i=t.tileSize,o=t.texSize,r=e/o,a=n/o,s=(e+i)/o,u=(n+i)/o,c=(new Float32Array([-.5,0,-.5,.5,0,-.5,.5,0,.5,-.5,0,.5]),new Uint32Array([0,2,1,0,3,2]),new Float32Array([r,a,s,a,s,u,r,u]),new THREE.PlaneGeometry(1,1,1,1));return c.rotateX(-Math.PI/2),c.rotateY(-Math.PI/2),c.faceVertexUvs[0][0][0].x=s,c.faceVertexUvs[0][0][0].y=a,c.faceVertexUvs[0][0][1].x=r,c.faceVertexUvs[0][0][1].y=a,c.faceVertexUvs[0][0][2].x=s,c.faceVertexUvs[0][0][2].y=u,c.faceVertexUvs[0][1][0].x=r,c.faceVertexUvs[0][1][0].y=a,c.faceVertexUvs[0][1][1].x=r,c.faceVertexUvs[0][1][1].y=u,c.faceVertexUvs[0][1][2].x=s,c.faceVertexUvs[0][1][2].y=u,c.uvsNeedUpdate=!0,c}e.a=i},function(t,e,n){"use strict";function i(){c=new THREE.ShaderMaterial({vertexShader:a.a,fragmentShader:u.a,uniforms:{texture:{type:"t",value:o.a.get("tex.road")}}})}var o=n(0),r=n(135),a=n.n(r),s=n(136),u=n.n(s),c=void 0;e.a={setup:i,getMaterial:function(){return c||i(),c}}},function(t,e){t.exports="#define GLSLIFY 1\n// varying float vFall;\nvarying vec2 vUv;\n// varying vec3 vPos;\nvarying float vDist;\n\nvoid main() {\n  // vec4 t = viewMatrix * modelMatrix * vec4( position, 1.0 );\n  // vec3 vPos = t.xyz;\n\n  vUv = uv;\n\n  float attenuate = 0.0003;\n  float spread = 21.0;\n  vec4 wpos = modelMatrix * vec4( position, 1.0 );\n  vec3 cpos = cameraPosition.xyz;\n\n  float dx = wpos.x - cpos.x;\n  float dz = wpos.z - cpos.z;\n  float p = (dx * dx + dz * dz);\n  vDist = p;\n\n  float distz = max(0., abs(attenuate - p) - spread);\n  wpos.y -= distz * distz * attenuate;\n\n  wpos.y += 0.02;\n  // vFall = 0.05 + wpos.y;\n\n  gl_Position = projectionMatrix * viewMatrix * wpos;\n}"},function(t,e){t.exports="#define GLSLIFY 1\nvarying float vDist;\nvarying vec2 vUv;\n// varying vec3 vPos;\nuniform sampler2D texture;\n\nvoid main() {\n  if (vDist > 29.5) discard;\n  gl_FragColor = texture2D(texture, vUv);\n  // gl_FragColor = vec4(vPos.x, vPos.y, vPos.z, 1.);\n  \n}"},function(t,e){function n(t){function e(e){(t=(0|e)%2147483647)<=0&&(t+=2147483646)}function n(){return t=48271*t%2147483647}function i(){return(n()-1)/2147483646}return e(t),{seed:e,nextInt:n,nextFloat:i}}t.exports=n},function(t,e,n){"use strict";function i(){return"fr"}var o=n(139);n.n(o);e.a=i},function(t,e){t.exports=function(){return navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.userLanguage?navigator.userLanguage:navigator.language}},function(t,e,n){"use strict";function i(){return new l.a(function(t,e){if(!f.a.vendors||f.a.vendors.length<1)return t();v(f.a.vendors,{success:function(){v(f.a.threeDependencies,{success:t,error:e,async:!1})},error:e})})}function o(){var t=[];for(var e in f.a.blobs)!function(e){var n=f.a.blobs[e];t.push(new l.a(function(t,i){var o=new window.XMLHttpRequest;o.open("GET",e,!0),o.responseType="blob",o.onload=function(){if(200===this.status){var e=this.response,i=window.URL.createObjectURL(e);p.a.set("blob."+n,i),t(i)}},o.onerror=i,o.send()}))}(e);return l.a.all(t)}function r(){var t=[];for(var e in f.a.images)!function(e){var n=f.a.images[e];t.push(new l.a(function(t){var i=document.createElement("img");i.onload=function(){p.a.set("img."+n,i),t()},i.src=e,i.complete&&(p.a.set("img."+n,i),t())}))}(e);return l.a.all(t)}function a(){}function s(){f.a.initCommonMaterials();var t=new THREE.TextureLoader,e=[];for(var n in f.a.textures)!function(n){var i=f.a.textures[n];e.push(new l.a(function(e,o){t.load(n,function(t){i(t),e()},d.a,function(){o(new Error("Error downloading "+n))})}))}(n);return l.a.all(e)}function u(){f.a.initCommonGeometries();var t=new THREE.JSONLoader,e=[];for(var n in f.a.objects)!function(n){var i=f.a.objects[n];e.push(new l.a(function(e,o){t.load(n,function(t,n){i(t,n),e()},d.a,function(){o(new Error("Error downloading "+n))})}))}(n);return l.a.all(e)}function c(){for(var t=[],e=0;e<f.a.chunks.count;e++)!function(e){t.push(new l.a(function(t,n){var i=new window.XMLHttpRequest;i.onreadystatechange=function(){if(4===this.readyState&&200===this.status)return f.a.chunks.onchunkload(e,JSON.parse(this.responseText)),t()},i.open("GET",f.a.chunks.folder+"/"+e+".json",!0),i.send()}))}(e);return l.a.all(t)}var h=n(29),l=n.n(h),d=n(21),f=n(6),p=n(0),v=window.loadjs,y={loadJS:i,loadTextures:s,loadObjects:u,loadChunks:c,loadImages:r,loadBlobs:o,loadCube:a};e.a=y},function(t,e,n){"use strict";function i(){window.AudioContext=window.AudioContext||window.webkitAudioContext,h=new AudioContext;try{navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,navigator.getUserMedia({audio:{mandatory:{googEchoCancellation:"false",googAutoGainControl:"false",googNoiseSuppression:"false",googHighpassFilter:"false"},optional:[]}},r,o)}catch(t){alert("getUserMedia threw exception :"+t)}}function o(){alert("Stream generation failed.")}function r(t){f=h.createMediaStreamSource(t),l=s(h),f.connect(l),a()}function a(){return d=window.requestAnimationFrame(a),l.volume}function s(t,e,n,i){var o=t.createScriptProcessor(512);return o.onaudioprocess=u,o.clipping=!1,o.lastClip=0,o.volume=0,o.clipLevel=e||.98,o.averaging=n||.95,o.clipLag=i||750,o.connect(t.destination),o.checkClipping=function(){return!!this.clipping&&(this.lastClip+this.clipLag<window.performance.now()&&(this.clipping=!1),this.clipping)},o.shutdown=function(){this.disconnect(),this.onaudioprocess=null},o}function u(t){for(var e=t.inputBuffer.getChannelData(0),n=e.length,i=0,o=void 0,r=0;r<n;r++)o=e[r],Math.abs(o)>=this.clipLevel&&(this.clipping=!0,this.lastClip=window.performance.now()),i+=o*o;var a=Math.sqrt(i/n);this.volume=Math.max(a,this.volume*this.averaging)}var c=n(46),h=(Object(c.a)(),null),l=null,d=null,f=null;e.a={start:i,getVolume:a}},function(t,e,n){!function(e,n){t.exports=n()}(0,function(){var t=function(){function e(t){return o.appendChild(t.dom),t}function n(t){for(var e=0;e<o.children.length;e++)o.children[e].style.display=e===t?"block":"none";i=t}var i=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",function(t){t.preventDefault(),n(++i%o.children.length)},!1);var r=(performance||Date).now(),a=r,s=0,u=e(new t.Panel("FPS","#0ff","#002")),c=e(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var h=e(new t.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:o,addPanel:e,showPanel:n,begin:function(){r=(performance||Date).now()},end:function(){s++;var t=(performance||Date).now();if(c.update(t-r,200),t>a+1e3&&(u.update(1e3*s/(t-a),100),a=t,s=0,h)){var e=performance.memory;h.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){r=this.end()},domElement:o,setMode:n}};return t.Panel=function(t,e,n){var i=1/0,o=0,r=Math.round,a=r(window.devicePixelRatio||1),s=80*a,u=48*a,c=3*a,h=2*a,l=3*a,d=15*a,f=74*a,p=30*a,v=document.createElement("canvas");v.width=s,v.height=u,v.style.cssText="width:80px;height:48px";var y=v.getContext("2d");return y.font="bold "+9*a+"px Helvetica,Arial,sans-serif",y.textBaseline="top",y.fillStyle=n,y.fillRect(0,0,s,u),y.fillStyle=e,y.fillText(t,c,h),y.fillRect(l,d,f,p),y.fillStyle=n,y.globalAlpha=.9,y.fillRect(l,d,f,p),{dom:v,update:function(u,m){i=Math.min(i,u),o=Math.max(o,u),y.fillStyle=n,y.globalAlpha=1,y.fillRect(0,0,s,d),y.fillStyle=e,y.fillText(r(u)+" "+t+" ("+r(i)+"-"+r(o)+")",c,h),y.drawImage(v,l+a,d,f-a,p,l,d,f-a,p),y.fillRect(l+f-a,d,a,p),y.fillStyle=n,y.globalAlpha=.9,y.fillRect(l+f-a,d,a,r((1-u/m)*p))}}},t})},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(5),d=n.n(l),f=n(0),p=n(7),v=n(9),y=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return d()(e,t),u()(e,[{key:"setup",value:function(t){var e=this;this.pos=t.position,this.body=t;var n=f.a.get("mat.wireframe"),i=f.a.get("geo.box");this.boxes=[],t.shapes.forEach(function(t){var o=new THREE.Mesh(i,n);o.scale.set(t.width,1,t.height),p.a.bodyCopy(t,o),e.group.add(o),e.boxes.push(o)})}},{key:"update",value:function(t){p.a.bodyCopy(this.body,this.group)}}]),e}(v.a);e.a=y},function(t,e,n){n(145),t.exports=n(12).Object.getPrototypeOf},function(t,e,n){var i=n(40),o=n(80);n(66)("getPrototypeOf",function(){return function(t){return o(i(t))}})},function(t,e,n){t.exports={default:n(147),__esModule:!0}},function(t,e,n){n(148);var i=n(12).Object;t.exports=function(t,e,n){return i.defineProperty(t,e,n)}},function(t,e,n){var i=n(19);i(i.S+i.F*!n(23),"Object",{defineProperty:n(20).f})},function(t,e,n){t.exports={default:n(150),__esModule:!0}},function(t,e,n){n(53),n(81),t.exports=n(67).f("iterator")},function(t,e,n){t.exports={default:n(152),__esModule:!0}},function(t,e,n){n(153),n(73),n(159),n(160),t.exports=n(12).Symbol},function(t,e,n){"use strict";var i=n(15),o=n(27),r=n(23),a=n(19),s=n(76),u=n(154).KEY,c=n(32),h=n(62),l=n(44),d=n(43),f=n(14),p=n(67),v=n(68),y=n(155),m=n(156),g=n(157),b=n(22),x=n(24),w=n(58),k=n(37),M=n(59),_=n(158),E=n(70),S=n(20),T=n(33),C=E.f,P=S.f,O=_.f,R=i.Symbol,I=i.JSON,F=I&&I.stringify,L=f("_hidden"),z=f("toPrimitive"),j={}.propertyIsEnumerable,B=h("symbol-registry"),A=h("symbols"),D=h("op-symbols"),H=Object.prototype,W="function"==typeof R,V=i.QObject,G=!V||!V.prototype||!V.prototype.findChild,U=r&&c(function(){return 7!=M(P({},"a",{get:function(){return P(this,"a",{value:7}).a}})).a})?function(t,e,n){var i=C(H,e);i&&delete H[e],P(t,e,n),i&&t!==H&&P(H,e,i)}:P,N=function(t){var e=A[t]=M(R.prototype);return e._k=t,e},Y=W&&"symbol"==typeof R.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof R},q=function(t,e,n){return t===H&&q(D,e,n),b(t),e=w(e,!0),b(n),o(A,e)?(n.enumerable?(o(t,L)&&t[L][e]&&(t[L][e]=!1),n=M(n,{enumerable:k(0,!1)})):(o(t,L)||P(t,L,k(1,{})),t[L][e]=!0),U(t,e,n)):P(t,e,n)},X=function(t,e){b(t);for(var n,i=m(e=x(e)),o=0,r=i.length;r>o;)q(t,n=i[o++],e[n]);return t},J=function(t,e){return void 0===e?M(t):X(M(t),e)},$=function(t){var e=j.call(this,t=w(t,!0));return!(this===H&&o(A,t)&&!o(D,t))&&(!(e||!o(this,t)||!o(A,t)||o(this,L)&&this[L][t])||e)},Q=function(t,e){if(t=x(t),e=w(e,!0),t!==H||!o(A,e)||o(D,e)){var n=C(t,e);return!n||!o(A,e)||o(t,L)&&t[L][e]||(n.enumerable=!0),n}},K=function(t){for(var e,n=O(x(t)),i=[],r=0;n.length>r;)o(A,e=n[r++])||e==L||e==u||i.push(e);return i},Z=function(t){for(var e,n=t===H,i=O(n?D:x(t)),r=[],a=0;i.length>a;)!o(A,e=i[a++])||n&&!o(H,e)||r.push(A[e]);return r};W||(R=function(){if(this instanceof R)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function(n){this===H&&e.call(D,n),o(this,L)&&o(this[L],t)&&(this[L][t]=!1),U(this,t,k(1,n))};return r&&G&&U(H,t,{configurable:!0,set:e}),N(t)},s(R.prototype,"toString",function(){return this._k}),E.f=Q,S.f=q,n(95).f=_.f=K,n(48).f=$,n(69).f=Z,r&&!n(42)&&s(H,"propertyIsEnumerable",$,!0),p.f=function(t){return N(f(t))}),a(a.G+a.W+a.F*!W,{Symbol:R});for(var tt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),et=0;tt.length>et;)f(tt[et++]);for(var tt=T(f.store),et=0;tt.length>et;)v(tt[et++]);a(a.S+a.F*!W,"Symbol",{for:function(t){return o(B,t+="")?B[t]:B[t]=R(t)},keyFor:function(t){if(Y(t))return y(B,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){G=!0},useSimple:function(){G=!1}}),a(a.S+a.F*!W,"Object",{create:J,defineProperty:q,defineProperties:X,getOwnPropertyDescriptor:Q,getOwnPropertyNames:K,getOwnPropertySymbols:Z}),I&&a(a.S+a.F*(!W||c(function(){var t=R();return"[null]"!=F([t])||"{}"!=F({a:t})||"{}"!=F(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!Y(t)){for(var e,n,i=[t],o=1;arguments.length>o;)i.push(arguments[o++]);return e=i[1],"function"==typeof e&&(n=e),!n&&g(e)||(e=function(t,e){if(n&&(e=n.call(this,t,e)),!Y(e))return e}),i[1]=e,F.apply(I,i)}}}),R.prototype[z]||n(26)(R.prototype,z,R.prototype.valueOf),l(R,"Symbol"),l(Math,"Math",!0),l(i.JSON,"JSON",!0)},function(t,e,n){var i=n(43)("meta"),o=n(31),r=n(27),a=n(20).f,s=0,u=Object.isExtensible||function(){return!0},c=!n(32)(function(){return u(Object.preventExtensions({}))}),h=function(t){a(t,i,{value:{i:"O"+ ++s,w:{}}})},l=function(t,e){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!r(t,i)){if(!u(t))return"F";if(!e)return"E";h(t)}return t[i].i},d=function(t,e){if(!r(t,i)){if(!u(t))return!0;if(!e)return!1;h(t)}return t[i].w},f=function(t){return c&&p.NEED&&u(t)&&!r(t,i)&&h(t),t},p=t.exports={KEY:i,NEED:!1,fastKey:l,getWeak:d,onFreeze:f}},function(t,e,n){var i=n(33),o=n(24);t.exports=function(t,e){for(var n,r=o(t),a=i(r),s=a.length,u=0;s>u;)if(r[n=a[u++]]===e)return n}},function(t,e,n){var i=n(33),o=n(69),r=n(48);t.exports=function(t){var e=i(t),n=o.f;if(n)for(var a,s=n(t),u=r.f,c=0;s.length>c;)u.call(t,a=s[c++])&&e.push(a);return e}},function(t,e,n){var i=n(39);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e,n){var i=n(24),o=n(95).f,r={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return o(t)}catch(t){return a.slice()}};t.exports.f=function(t){return a&&"[object Window]"==r.call(t)?s(t):o(i(t))}},function(t,e,n){n(68)("asyncIterator")},function(t,e,n){n(68)("observable")},function(t,e,n){t.exports={default:n(162),__esModule:!0}},function(t,e,n){n(163),t.exports=n(12).Object.setPrototypeOf},function(t,e,n){var i=n(19);i(i.S,"Object",{setPrototypeOf:n(164).set})},function(t,e,n){var i=n(31),o=n(22),r=function(t,e){if(o(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{i=n(30)(Function.call,n(70).f(Object.prototype,"__proto__").set,2),i(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return r(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:r}},function(t,e,n){t.exports={default:n(166),__esModule:!0}},function(t,e,n){n(167);var i=n(12).Object;t.exports=function(t,e){return i.create(t,e)}},function(t,e,n){var i=n(19);i(i.S,"Object",{create:n(59)})},function(t,e,n){n(169),t.exports=n(12).Object.keys},function(t,e,n){var i=n(40),o=n(33);n(66)("keys",function(){return function(t){return o(i(t))}})},function(t,e,n){"use strict";e.__esModule=!0;var i=n(171),o=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return(0,o.default)(t)}},function(t,e,n){t.exports={default:n(172),__esModule:!0}},function(t,e,n){n(53),n(173),t.exports=n(12).Array.from},function(t,e,n){"use strict";var i=n(30),o=n(19),r=n(40),a=n(83),s=n(84),u=n(60),c=n(174),h=n(85);o(o.S+o.F*!n(87)(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,o,l,d=r(t),f="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,y=void 0!==v,m=0,g=h(d);if(y&&(v=i(v,p>2?arguments[2]:void 0,2)),void 0==g||f==Array&&s(g))for(e=u(d.length),n=new f(e);e>m;m++)c(n,m,y?v(d[m],m):d[m]);else for(l=g.call(d),n=new f;!(o=l.next()).done;m++)c(n,m,y?a(l,v,[o.value,m],!0):o.value);return n.length=m,n}})},function(t,e,n){"use strict";var i=n(20),o=n(37);t.exports=function(t,e,n){e in t?i.f(t,e,o(0,n)):t[e]=n}},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(10),d=n.n(l),f=n(5),p=n.n(f),v=n(17),y=n(0),m=(n(7),n(9),n(97)),g=n(6),b=(n(36),n(16)),x=n(21),w=n(196),k=n.n(w),M=n(25),_=n(51),E=n(35),S=n(8),T=n(13),C=n(203),P=n(206),O=k.a.js,R=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return p()(e,t),u()(e,[{key:"setup",value:function(t){this.onDeath=t.onDeath||x.a,this.onRemoved=t.onRemoved||x.a,this.chassis=new THREE.Mesh(y.a.get("geo.cop"),T.a.getMaterial()),this.meshes.siren=new THREE.Mesh(y.a.get("geo.siren"),T.a.getMaterial()),this.chassis.add(this.meshes.siren),this.group.add(this.chassis),this.meshes.siren.position.y=0,this.group.position.y=.0195,this.timeAlive=0,this.timeDead=0,g.a.lofi&&(this.meshes.shadow.visible=!1),this.body=new p2.Body({mass:1.5,position:[-t.x||0,t.y||0],angle:t.angle}),this.body.propType="cop";var e=this;this.body.impactCallback=function(t){"player"!==t.impactType&&"cop"!==t.impactType||e.explode()};var n=new p2.Box({width:.13,height:.28});n.material=new p2.Material,this.body.addShape(n),y.a.set("car.p2material",n.material),this.vehicle=new p2.TopDownVehicle(this.body),this.frontWheel=this.vehicle.addWheel({localPosition:[0,.2]}),this.backWheel=this.vehicle.addWheel({localPosition:[0,-.2]}),this.improvise=!1,this.improvisationTreshold=3,this.running=!0,this.improvisationMode=1,this.debugSteering=!1,this.debugWaypoints=!1,this.manualControls=!1,this.id=t.id,this.maxSpeed=.9+.2*(2*S.a.random()-1),this.backWheelFriction=3.3,this.maxSteer=Math.PI/4,this.searching=!1,this.astar=new O,this.astar.setAcceptableTiles([1]),this.astarInstance=void 0,this.astar.setIterationsPerCalculation(10),this.pos=this.group.position,this.findTimer=0,this.findTimerStart=3e3,this.dist=0,E.a.addCop(this.id),this.sirenTimerMax=300,this.sirenTimer=this.sirenTimerMax,this.sirenPing=!0}},{key:"searchPlayer",value:function(){var t=this;void 0!==this.astarInstance&&this.astar.cancelPath(this.astarInstance),this.astar.setGrid(v.a.copyWalkMap());var e=y.a.get("player.position"),n=v.a.getWalkCoordFromThreePos(this.pos.x,this.pos.z),i=v.a.getWalkCoordFromThreePos(e[0],e[1]),o=v.a.getCurrentMiddleChunk(),r=o.chunkX,a=o.chunkY;if(o=void 0,0===v.a.getWalkMap()[i[1]][i[0]]){for(var s=v.a.getWalkMap(),u=0;u<30;u++){var c=Object(P.a)(u),h=i[1]+c[1],l=i[0]+c[0];if(s[h][l]){i[1]=h,i[0]=l;break}}s=null}try{this.astarInstance=this.astar.findPath(n[0],n[1],i[0],i[1],function(e){if(!e)return t.waypoints.cancelAll(),t.astarInstance=void 0,t.findTimer=t.findTimerStart,void(t.waypoints.improvise=!0);t.waypoints.improvise=!1,v.a.convertWalkPathToThreePos(e,{middleX:r,middleY:a}),t.waypoints.createFromPath(e),t.astarInstance=void 0,t.findTimer=t.findTimerStart})}catch(t){this.waypoints.cancelAll(),this.waypoints.improvise=!0,this.astarInstance=void 0,this.findTimer=this.findTimerStart}}},{key:"didDie",value:function(){E.a.removeCop(this.id),this.body.mass=1,this.body.updateMassProperties(),this.meshes.siren.material=C.a.getMaterial(),this.chassis.material=C.a.getMaterial();var t=1-(Math.min(9,Math.max(1,this.dist))-1)/8;this.smokeDensity=7,_.a.emit({x:this.group.position.x,y:.1,z:this.group.position.z,type:2,amount:30}),_.a.emit({x:this.group.position.x,y:.1,z:this.group.position.z,type:3,amount:25}),M.a.addCameraShake(.9*t),this.onDeath(this),this.astar.cancelPath(this.astarInstance)}},{key:"update",value:function(t){d()(e.prototype.__proto__||o()(e.prototype),"update",this).call(this,t);var n=y.a.get("player.dead"),i=y.a.get("player.position");this.dist=Math.pow(i[0]-this.group.position.x,2)+Math.pow(i[1]-this.group.position.z,2),this.dead||(E.a.updateCop(this.id,this.group.position,t),b.a.emit("cop.move",{id:this.id,position:[this.group.position.x,this.group.position.z]}),this.findTimer<1&&!this.target&&!n?void 0===this.astarInstance&&this.searchPlayer():this.findTimer-=t,!this.astarInstance||this.target||n||this.astar.calculate(),n&&!this.winner&&(this.winner=!0,this.waypoints.cancelAll(),this.waypoints.preLastReachPos=null,this.waypoints.lastReachPos=null,this.waypoints.improvise=!0,this.target=void 0),this.waypoints.list.length<3&&!1===this.waypoints.improvise&&this.dist<5?(this.waypoints.cancelAll(),this.waypoints.preLastReachPos=null,this.waypoints.lastReachPos=null,this.target=[i[0],i[1]],void 0!==this.astarInstance&&this.astar.cancelPath(this.astarInstance)):this.target=void 0,this.sirenTimer<=0?(this.sirenPing=!this.sirenPing,this.sirenTimer=this.sirenTimerMax,this.meshes.siren.rotation.y=this.sirenPing?0:Math.PI):this.sirenTimer-=t),this.dead?this.timeDead+=t:this.timeAlive+=t,!this.dead&&this.timeAlive>3e4&&this.explode(),this.dead&&this.dist>80?this.onRemoved(this):this.dead&&this.timeDead>1e4?this.onRemoved(this):this.timeAlive>8e3&&this.dist>130?this.onRemoved(this):this.timeAlive>12e3&&this.dist>80?this.onRemoved(this):this.dist>700&&this.onRemoved(this)}},{key:"destroy",value:function(){E.a.removeCop(this.id),void 0!==this.astarInstance&&this.astar.cancelPath(this.astarInstance),this.astar=void 0,this.pos=void 0,d()(e.prototype.__proto__||o()(e.prototype),"destroy",this).call(this)}}]),e}(m.a);e.a=R},function(t,e,n){t.exports={default:n(177),__esModule:!0}},function(t,e,n){n(178);var i=n(12).Object;t.exports=function(t,e){return i.getOwnPropertyDescriptor(t,e)}},function(t,e,n){var i=n(24),o=n(70).f;n(66)("getOwnPropertyDescriptor",function(){return function(t,e){return o(i(t),e)}})},function(t,e,n){n(180),t.exports=n(12).Math.sign},function(t,e,n){var i=n(19);i(i.S,"Math",{sign:n(181)})},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,e,n){"use strict";var i=n(49),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(186),h=n(188),l=n(50),d=n(16),f=n(189),p=function(){function t(e){a()(this,t),this.isPlayer=!!e.isPlayer,this.debug=!!e.debug,this.list=[],this.pos=[0,0],this.ang=0,this.improvise=e.improvise,this.improvisationTreshold=e.improvisationTreshold||3,this.improvisationMode=void 0!==e.improvisationMode?e.improvisationMode:0,this.chaoticImprovisation=!(1!==this.improvisationMode)}return u()(t,[{key:"improviseFrom",value:function(t,e,n){for(var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=0;o<n;o++){var r=Object(c.a)(t,e,void 0,this.chaoticImprovisation);r&&(this.addWaypoint({x:r.position[0],y:r.position[1],r:r.direction,relr:i?2:r.relativeDirection,type:i?1:r.type,improvised:!i}),i&&(i=!1)),e=r.direction,t=r.position}}},{key:"addWaypoint",value:function(t){var e={debug:this.debug};this.isPlayer&&!t.improvised&&d.a.emit("waypoints.add",{dir:t.relr,x:t.x,y:t.y});var n=new h.a(o()({},e,t));this.list.push(n)}},{key:"reachWaypoint",value:function(t){for(var e=0;e<=t;e++){if(this.isPlayer){var n=this.list[e];1===n.type&&d.a.emit("waypoints.reach",{x:n.x,y:n.y}),-1===n.type&&d.a.emit("stress.add",.14),-2===n.type&&d.a.emit("stress.add",.15)}this.list[e].destroy()}this.list.splice(0,t+1)}},{key:"cancelAll",value:function(){for(var t=this.list.length;t--;)this.cancelWaypoint(t)}},{key:"cancelWaypoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.list[t];n.destroy(),this.isPlayer&&!e&&1===n.type&&d.a.emit("waypoints.cancel",{x:n.x,y:n.y}),this.list.splice(t,1)}},{key:"getClosest",value:function(t,e){for(var n=void 0,i=null,o=0;o<this.list.length;o++){var r=this.list[o],a=t-r.x,s=e-r.y,u=Math.pow(a,2)+Math.pow(s,2);(null===i||u<i)&&(n=r,i=u)}return{point:n,distance:i}}},{key:"getPointToStartFrom",value:function(){var t=void 0,e=void 0,n=this.list.length;if(n>1){t=[this.list[n-1].x,this.list[n-1].y];var i=[this.list[n-2].x,this.list[n-2].y];e=Object(f.a)(i,t)}else if(n>0&&this.lastReachPos){t=[this.list[n-1].x,this.list[n-1].y];var o=this.lastReachPos;e=Object(f.a)(o,t)}else if(this.preLastReachPos){t=this.lastReachPos;var r=this.preLastReachPos;e=Object(f.a)(r,t)}else t=this.pos,e=this.getDirFromAngle(this.ang);return{pos:t,dir:e}}},{key:"getDirFromAngle",value:function(t){return Math.floor(Object(l.a)(-t+Math.PI+Math.PI/4,2*Math.PI)/(Math.PI/2))%4}},{key:"update",value:function(t,e){this.pos=[-t[0],t[1]],this.ang=e;for(var n=null,i=0;i<this.list.length;i++){var o=this.list[i],r=this.pos[0]-o.x,a=this.pos[1]-o.y,s=Math.pow(r,2)+Math.pow(a,2);if((null===n||s<n)&&(n=s),s<.5){this.preLastReachPos=i>0?[this.list[i-1].x,this.list[i-1].y]:this.lastReachPos,this.lastReachPos=[this.list[i].x,this.list[i].y],this.reachWaypoint(i);break}}if(n>10){for(var u=this.list.length;u--;)this.cancelWaypoint(u);this.preLastReachPos=null,this.lastReachPos=null}if(this.improvise&&this.list.length<this.improvisationTreshold){var c=this.getPointToStartFrom(),h=this.improvisationTreshold-this.list.length;this.improviseFrom(c.pos,c.dir,h)}}},{key:"makeOrders",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=this.pos,i=this.getDirFromAngle(this.ang),o=[],r=0;if(!(e.length<=0)){for(;e.length>0&&r<100;){var a=Object(c.a)(n,i,e[0]);if(!a)break;o.push({x:a.position[0],y:a.position[1],r:a.direction,relr:a.relativeDirection,type:a.type,improvised:1!==a.type}),1===a.type&&e.shift(),this.list[0]&&(this.list[0].x===a.position[0]&&this.list[0].y===a.position[1]?this.cancelWaypoint(0,!0):this.cancelWaypoint(0)),i=a.direction,n=a.position,r++}this.cancelAll(),o.forEach(function(e){return t.addWaypoint(e)}),o=null}}},{key:"createFromPath",value:function(t){var e=this,n=this.getPointToStartFrom(),i=n.pos;this.cancelAll(),this.preLastReachPos=null,this.lastReachPos=null,t.forEach(function(t){e.addWaypoint({x:t.x,y:t.y,r:Object(f.a)(i,[t.x,t.y]),type:0}),i=[t.x,t.y]})}},{key:"goStraight",value:function(){this.makeOrders([0])}},{key:"turnRight",value:function(){this.makeOrders([1])}},{key:"turnLeft",value:function(){this.makeOrders([3])}},{key:"turnBack",value:function(){for(var t=this.list.length;t--;)this.cancelWaypoint(t);var e=this.pos,n=this.lastReachPos&&this.preLastReachPos?Object(f.a)(this.lastReachPos,this.preLastReachPos):this.getDirFromAngle(this.ang-Math.PI),i=this.improvisationTreshold>3?this.improvisationTreshold:3;this.preLastReachPos=null,this.lastReachPos=null,this.improviseFrom(e,n,i,!0),this.preLastReachPos=[this.list[0].x,this.list[0].y],this.lastReachPos=[this.list[1].x,this.list[1].y]}}]),t}();e.a=p},function(t,e,n){n(184),t.exports=n(12).Object.assign},function(t,e,n){var i=n(19);i(i.S+i.F,"Object",{assign:n(185)})},function(t,e,n){"use strict";var i=n(33),o=n(69),r=n(48),a=n(40),s=n(78),u=Object.assign;t.exports=!u||n(32)(function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach(function(t){e[t]=t}),7!=u({},t)[n]||Object.keys(u({},e)).join("")!=i})?function(t,e){for(var n=a(t),u=arguments.length,c=1,h=o.f,l=r.f;u>c;)for(var d,f=s(arguments[c++]),p=h?i(f).concat(h(f)):i(f),v=p.length,y=0;v>y;)l.call(f,d=p[y++])&&(n[d]=f[d]);return n}:u},function(t,e,n){"use strict";function i(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=a.a.getRoadFromThreePos(t[0],t[1]);o&&(t[0]=Math.round(t[0]),t[1]=Math.round(t[1]));var h={top:e,right:(e+1)%4,bottom:(e+2)%4,left:(e+3)%4},l={},d=void 0;o&&(o.n[h.top]&&(l.straight=Object(u.a)(t,e,0)),o.n[h.right]&&(l.right=Object(u.a)(t,e,1)),o.n[h.left]&&(l.left=Object(u.a)(t,e,3)));var f=r()(l),p=f.length;return 0===p&&o&&o.n[h.bottom]?(d=Object(u.a)(t,e,2),d.type=-2,d):1===p?(d=l[f[0]],d.type=0,d):p>0?void 0!==n&&l[c[n]]?(d=l[c[n]],d.type=1,d):(d=!i&&o.n[h.top]?l.straight:l[f[s.a.randomInt(0,p-1)]],d.type=-1,d):(d=Object(u.a)(t,e,0),d.type=0,d)}e.a=i;var o=n(41),r=n.n(o),a=n(17),s=n(8),u=n(187),c={0:"straight",1:"right",2:"back",3:"left"}},function(t,e,n){"use strict";function i(t,e,n){var i=(e+n)%4,r=o[i];return{relativeDirection:n,direction:i,position:[t[0]+r[0],t[1]+r[1]]}}e.a=i;var o={0:[0,-1],1:[1,0],2:[0,1],3:[-1,0]}},function(t,e,n){"use strict";var i=n(1),o=n.n(i),r=n(2),a=n.n(r),s=(n(0),n(17),n(7)),u=n(99),c={"-2":"gray","-1":"red",0:"blue",1:"green"},h=function(){function t(e){o()(this,t),this.angle=e.r*-Math.PI/2,this.x=e.x,this.y=e.y,this.direction=e.r,this.type=e.type,this.debug=!!e.debug,this.debug&&(this.debugArrow=new u.a({x:this.x,y:.01,z:this.y,r:this.angle+Math.PI,color:c[e.type]}),s.a.getScene().add(this.debugArrow.group))}return a()(t,[{key:"destroy",value:function(){this.debug&&(s.a.getScene().remove(this.debugArrow),this.debugArrow.destroy())}}]),t}();e.a=h},function(t,e,n){"use strict";function i(t,e){return-1===e?0:1===t?1:1===e?2:-1===t?3:Object(s.a)(0,3)}function o(t,e){return i(-a()(t[0]-e[0]),-a()(t[1]-e[1]))}e.a=o;var r=n(98),a=n.n(r),s=n(190)},function(t,e,n){"use strict";function i(t,e){return Math.floor(Math.random()*(e-t+1))+t}e.a=i},function(t,e,n){"use strict";function i(){c=new THREE.ShaderMaterial({vertexShader:a.a,fragmentShader:u.a,uniforms:{texture:{type:"t",value:o.a.get("tex.smoke")}},transparent:!0})}var o=n(0),r=n(192),a=n.n(r),s=n(193),u=n.n(s),c=void 0;e.a={setup:i,getMaterial:function(){return c||i(),c}}},function(t,e){t.exports="#define GLSLIFY 1\nfloat when_eq_1540259130(float x, float y) {\n  return 1.0 - abs(sign(x - y));\n}\n\nvec2 when_eq_1540259130(vec2 x, vec2 y) {\n  return 1.0 - abs(sign(x - y));\n}\n\nvec3 when_eq_1540259130(vec3 x, vec3 y) {\n  return 1.0 - abs(sign(x - y));\n}\n\nvec4 when_eq_1540259130(vec4 x, vec4 y) {\n  return 1.0 - abs(sign(x - y));\n}\n\nvarying float vY;\nvarying float vLife;\nvarying float vType;\nvarying vec2 vRotation;\n\nattribute float life;\nattribute float scale;\nattribute vec3 bornData;\n\nvoid main() {\n  vType = bornData.x;\n  vLife = life;\n  vY = (modelMatrix * vec4(position, 1.0)).y;\n\n  float l = vLife * bornData.z;\n  float rscale = (\n    when_eq_1540259130(vType, 1.) * 1. * (1. - (max(0.1, abs(vLife - 0.5)) - 0.1) / 0.4)\n    + when_eq_1540259130(vType, 2.) * 2.0 * vLife\n    + when_eq_1540259130(vType, 3.) * 0.01 * l\n    + when_eq_1540259130(vType, 4.) * 0.6 * (1. - (max(0.05, abs(vLife - 0.5)) - 0.05) / 0.45) + 0.2\n  );\n\n  if (vType == 0.) {\n    rscale = 2. * (1. - (max(0.05, abs(vLife - 0.5)) - 0.05) / 0.45) + 0.2;\n  }\n\n  if (vLife > 0.) {\n    vRotation = vec2( cos(l + bornData.z), sin(l + bornData.z) );\n  }\n\n  float attenuate = 0.0005;\n  float spread = 20.;\n\n  vec4 wpos = modelMatrix * vec4( position, 1.0 );\n\tvec3 vPos = wpos.xyz;\n  vec3 cpos = cameraPosition.xyz;\n\n  float dx = wpos.x - cpos.x;\n  float dz = wpos.z - cpos.z;\n  float p = (dx * dx + dz * dz);\n\n  float distz = max(0., abs(attenuate - p) - spread);\n  wpos.y -= distz * distz * attenuate;\n\n  vec4 mvPosition = viewMatrix * wpos;\n  gl_PointSize = scale * rscale * ( 100.0 / -mvPosition.z );\n  gl_Position = projectionMatrix * mvPosition;\n}"},function(t,e){t.exports="#define GLSLIFY 1\nvarying float vY;\nvarying float vLife;\nvarying float vType;\nvarying vec2 vRotation;\n\nuniform sampler2D texture;\n\nvoid main() {\n  if (vLife <= 0. || vY < 0.) discard;\n\n  float mid = 0.5;\n  vec2 rotated = vec2(\n    vRotation.x * (gl_PointCoord.x - mid) + vRotation.y * (gl_PointCoord.y - mid) + mid,\n    vRotation.x * (gl_PointCoord.y - mid) - vRotation.y * (gl_PointCoord.x - mid) + mid\n  );\n\n  vec4 color = texture2D(texture, rotated);\n\n  if (color.r == 1. && color.g == 0.) discard;\n  if (vType == 0.) {\n    color.r = color.r + (1. - color.r) * 0.9;\n    color.g = color.g + (1. - color.g) * 0.4;\n    color.b = color.b - (1. - color.b) * 0.7;\n  }\n  if (vType == 1.) {\n    float life = (1. - vLife) * 0.1;\n    color = vec4(color.rgb - life, 1.0);\n  }\n  if (vType == 2.) {\n    float life = max(0., (vLife + 0.03) * 2. - 1.);\n    float life2 = max(0., (vLife + 0.03) * 4. - 3.);\n    color.r = color.r + (1. - color.r) * (life);\n    color.g = color.g + (1. - color.g) * (life2);\n  }\n  if (vType == 3.) {\n    color = vec4(color.rgb * 0.7, 1.0);\n  }\n  if (vType == 4.) {\n    color = vec4(color.rgb + 0.4, 0.8);\n  }\n  gl_FragColor = clamp(color, 0., 1.);\n}"},function(t,e,n){"use strict";var i=n(100),o=Object(i.a)();o.replacer("droite-gauche","droite gauche").replacer("gauche-droite","gauche droite").replacer("france","fonce").replacer("annonce|ok morse|cadence","avance").replacer("aux lentilles|râle entier|argentine","ralenti").replacer("accès|auxerre|quelle heure","accélère").replacer("accroché|accrocher","à gauche"),o.order("goRight").add("tourner à droite|tourne à droite|à droite|droite|20 droites"),o.order("goStraight").add("continue|continuer|tous droits|vas tout droit|tout droit|tous droit|droit devant|avance|tu dois|toulon"),o.order("goLeft").add("tourner à gauche|tourne à gauche|à gauche|gauche|à cause"),o.order("goManual").add("passe-moi le volant|je prends le volant|je conduis",{continuous:!1}),o.order("turnBack").add("fais demi-tour|demi-tour|demi moore"),o.order("start").add("allume le moteur|mets le contact",{continuous:!1}).add("bernard|neymar|démarre|demarrer|démarrer|avance|avancer"),o.order("stop").add("coupe le (moteur|contact)",{continuous:!1}).add("stop toi|stop|arrête|arrêter|arrête-toi"),o.order("speedUp").add("accélèrer|accélère|plus vite|foncer|foncer|va plus vite|augmente la vitesse"),o.order("speedDown").add("ralenti|ralentir|ralentis|moins vite|en entier"),o.order("radioOn").add("allume la radio|mets la radio|radio|mets du son|active la radio",{continuous:!1}),e.a=o.toObj()},function(t,e,n){"use strict";var i=n(100),o=Object(i.a)();o.replacer("black","back").replacer("street","straight"),o.order("goRight").add("turn right|go right|right"),o.order("goStraight").add("go straight|straight"),o.order("goLeft").add("go left|turn left|left"),o.order("turnBack").add("turn back|go back"),o.order("start").add("start the car",{continuous:!1}).add("start"),o.order("stop").add("stop the car",{continuous:!1}).add("stop"),o.order("goManual").add("i drive|i will drive|i take the lead|give me the controller|gimme the controller",{continuous:!1}),o.order("speedUp").add("speed up|faster"),o.order("speedDown").add("speed down|slower|speed o"),o.order("radioOn").add("put the radio on|turn on the radio",{continuous:!1}),e.a=o.toObj()},function(t,e,n){var i={},o=n(197),r=n(198),a=n(199);t.exports=i;var s=1;i.js=function(){var t,e,n,u=!1,c={},h={},l={},d={},f=!0,p={},v=[],y=Number.MAX_VALUE,m=!1;this.setAcceptableTiles=function(t){t instanceof Array?n=t:!isNaN(parseFloat(t))&&isFinite(t)&&(n=[t])},this.enableSync=function(){u=!0},this.disableSync=function(){u=!1},this.enableDiagonals=function(){m=!0},this.disableDiagonals=function(){m=!1},this.setGrid=function(e){t=e;for(var n=0;n<t.length;n++)for(var i=0;i<t[0].length;i++)h[t[n][i]]||(h[t[n][i]]=1)},this.setTileCost=function(t,e){h[t]=e},this.setAdditionalPointCost=function(t,e,n){void 0===l[e]&&(l[e]={}),l[e][t]=n},this.removeAdditionalPointCost=function(t,e){void 0!==l[e]&&delete l[e][t]},this.removeAllAdditionalPointCosts=function(){l={}},this.setDirectionalCondition=function(t,e,n){void 0===d[e]&&(d[e]={}),d[e][t]=n},this.removeAllDirectionalConditions=function(){d={}},this.setIterationsPerCalculation=function(t){y=t},this.avoidAdditionalPoint=function(t,e){void 0===c[e]&&(c[e]={}),c[e][t]=1},this.stopAvoidingAdditionalPoint=function(t,e){void 0!==c[e]&&delete c[e][t]},this.enableCornerCutting=function(){f=!0},this.disableCornerCutting=function(){f=!1},this.stopAvoidingAllAdditionalPoints=function(){c={}},this.findPath=function(e,i,r,c,h){var l=function(t){u?h(t):setTimeout(function(){h(t)})};if(void 0===n)throw new Error("You can't set a path without first calling setAcceptableTiles() on EasyStar.");if(void 0===t)throw new Error("You can't set a path without first calling setGrid() on EasyStar.");if(e<0||i<0||r<0||c<0||e>t[0].length-1||i>t.length-1||r>t[0].length-1||c>t.length-1)throw new Error("Your start or end point is outside the scope of your grid.");if(e===r&&i===c)return void l([]);for(var d=t[c][r],f=!1,y=0;y<n.length;y++)if(d===n[y]){f=!0;break}if(!1===f)return void l(null);var m=new o;m.openList=new a(function(t,e){return t.bestGuessDistance()-e.bestGuessDistance()}),m.isDoneCalculating=!1,m.nodeHash={},m.startX=e,m.startY=i,m.endX=r,m.endY=c,m.callback=l,m.openList.push(k(m,m.startX,m.startY,null,1));var g=s++;return p[g]=m,v.push(g),g},this.cancelPath=function(t){return t in p&&(delete p[t],!0)},this.calculate=function(){if(0!==v.length&&void 0!==t&&void 0!==n)for(e=0;e<y;e++){if(0===v.length)return;u&&(e=0);var i=v[0],o=p[i];if(void 0!==o)if(0!==o.openList.size()){var r=o.openList.pop();if(o.endX!==r.x||o.endY!==r.y)r.list=0,r.y>0&&g(o,r,0,-1,1*w(r.x,r.y-1)),r.x<t[0].length-1&&g(o,r,1,0,1*w(r.x+1,r.y)),r.y<t.length-1&&g(o,r,0,1,1*w(r.x,r.y+1)),r.x>0&&g(o,r,-1,0,1*w(r.x-1,r.y)),m&&(r.x>0&&r.y>0&&(f||b(t,n,r.x,r.y-1)&&b(t,n,r.x-1,r.y))&&g(o,r,-1,-1,1.4*w(r.x-1,r.y-1)),r.x<t[0].length-1&&r.y<t.length-1&&(f||b(t,n,r.x,r.y+1)&&b(t,n,r.x+1,r.y))&&g(o,r,1,1,1.4*w(r.x+1,r.y+1)),r.x<t[0].length-1&&r.y>0&&(f||b(t,n,r.x,r.y-1)&&b(t,n,r.x+1,r.y))&&g(o,r,1,-1,1.4*w(r.x+1,r.y-1)),r.x>0&&r.y<t.length-1&&(f||b(t,n,r.x,r.y+1)&&b(t,n,r.x-1,r.y))&&g(o,r,-1,1,1.4*w(r.x-1,r.y+1)));else{var a=[];a.push({x:r.x,y:r.y});for(var s=r.parent;null!=s;)a.push({x:s.x,y:s.y}),s=s.parent;a.reverse();var c=a;o.callback(c),delete p[i],v.shift()}}else o.callback(null),delete p[i],v.shift();else v.shift()}};var g=function(e,i,o,r,a){var s=i.x+o,u=i.y+r;if((void 0===c[u]||void 0===c[u][s])&&b(t,n,s,u,i)){var h=k(e,s,u,i,a);void 0===h.list?(h.list=1,e.openList.push(h)):i.costSoFar+a<h.costSoFar&&(h.costSoFar=i.costSoFar+a,h.parent=i,e.openList.updateItem(h))}},b=function(t,e,n,i,o){var r=d[i]&&d[i][n];if(r){var a=x(o.x-n,o.y-i);if(!function(){for(var t=0;t<r.length;t++)if(r[t]===a)return!0;return!1}())return!1}for(var s=0;s<e.length;s++)if(t[i][n]===e[s])return!0;return!1},x=function(t,e){if(0===t&&-1===e)return i.TOP;if(1===t&&-1===e)return i.TOP_RIGHT;if(1===t&&0===e)return i.RIGHT;if(1===t&&1===e)return i.BOTTOM_RIGHT;if(0===t&&1===e)return i.BOTTOM;if(-1===t&&1===e)return i.BOTTOM_LEFT;if(-1===t&&0===e)return i.LEFT;if(-1===t&&-1===e)return i.TOP_LEFT;throw new Error("These differences are not valid: "+t+", "+e)},w=function(e,n){return l[n]&&l[n][e]||h[t[n][e]]},k=function(t,e,n,i,o){if(void 0!==t.nodeHash[n]){if(void 0!==t.nodeHash[n][e])return t.nodeHash[n][e]}else t.nodeHash[n]={};var a=M(e,n,t.endX,t.endY);if(null!==i)var s=i.costSoFar+o;else s=0;var u=new r(i,e,n,s,a);return t.nodeHash[n][e]=u,u},M=function(t,e,n,i){if(m){var o=Math.abs(t-n),r=Math.abs(e-i);return o<r?1.4*o+r:1.4*r+o}var o=Math.abs(t-n),r=Math.abs(e-i);return o+r}},i.TOP="TOP",i.TOP_RIGHT="TOP_RIGHT",i.RIGHT="RIGHT",i.BOTTOM_RIGHT="BOTTOM_RIGHT",i.BOTTOM="BOTTOM",i.BOTTOM_LEFT="BOTTOM_LEFT",i.LEFT="LEFT",i.TOP_LEFT="TOP_LEFT"},function(t,e){t.exports=function(){this.pointsToAvoid={},this.startX,this.callback,this.startY,this.endX,this.endY,this.nodeHash={},this.openList}},function(t,e){t.exports=function(t,e,n,i,o){this.parent=t,this.x=e,this.y=n,this.costSoFar=i,this.simpleDistanceToTarget=o,this.bestGuessDistance=function(){return this.costSoFar+this.simpleDistanceToTarget}}},function(t,e,n){t.exports=n(200)},function(t,e,n){var i,o,r;(function(){var n,a,s,u,c,h,l,d,f,p,v,y,m,g,b;s=Math.floor,p=Math.min,a=function(t,e){return t<e?-1:t>e?1:0},f=function(t,e,n,i,o){var r;if(null==n&&(n=0),null==o&&(o=a),n<0)throw new Error("lo must be non-negative");for(null==i&&(i=t.length);n<i;)r=s((n+i)/2),o(e,t[r])<0?i=r:n=r+1;return[].splice.apply(t,[n,n-n].concat(e)),e},h=function(t,e,n){return null==n&&(n=a),t.push(e),g(t,0,t.length-1,n)},c=function(t,e){var n,i;return null==e&&(e=a),n=t.pop(),t.length?(i=t[0],t[0]=n,b(t,0,e)):i=n,i},d=function(t,e,n){var i;return null==n&&(n=a),i=t[0],t[0]=e,b(t,0,n),i},l=function(t,e,n){var i;return null==n&&(n=a),t.length&&n(t[0],e)<0&&(i=[t[0],e],e=i[0],t[0]=i[1],b(t,0,n)),e},u=function(t,e){var n,i,o,r,u,c;for(null==e&&(e=a),r=function(){c=[];for(var e=0,n=s(t.length/2);0<=n?e<n:e>n;0<=n?e++:e--)c.push(e);return c}.apply(this).reverse(),u=[],i=0,o=r.length;i<o;i++)n=r[i],u.push(b(t,n,e));return u},m=function(t,e,n){var i;if(null==n&&(n=a),-1!==(i=t.indexOf(e)))return g(t,0,i,n),b(t,i,n)},v=function(t,e,n){var i,o,r,s,c;if(null==n&&(n=a),o=t.slice(0,e),!o.length)return o;for(u(o,n),c=t.slice(e),r=0,s=c.length;r<s;r++)i=c[r],l(o,i,n);return o.sort(n).reverse()},y=function(t,e,n){var i,o,r,s,h,l,d,v,y;if(null==n&&(n=a),10*e<=t.length){if(r=t.slice(0,e).sort(n),!r.length)return r;for(o=r[r.length-1],d=t.slice(e),s=0,l=d.length;s<l;s++)i=d[s],n(i,o)<0&&(f(r,i,0,null,n),r.pop(),o=r[r.length-1]);return r}for(u(t,n),y=[],h=0,v=p(e,t.length);0<=v?h<v:h>v;0<=v?++h:--h)y.push(c(t,n));return y},g=function(t,e,n,i){var o,r,s;for(null==i&&(i=a),o=t[n];n>e&&(s=n-1>>1,r=t[s],i(o,r)<0);)t[n]=r,n=s;return t[n]=o},b=function(t,e,n){var i,o,r,s,u;for(null==n&&(n=a),o=t.length,u=e,r=t[e],i=2*e+1;i<o;)s=i+1,s<o&&!(n(t[i],t[s])<0)&&(i=s),t[e]=t[i],e=i,i=2*e+1;return t[e]=r,g(t,u,e,n)},n=function(){function t(t){this.cmp=null!=t?t:a,this.nodes=[]}return t.push=h,t.pop=c,t.replace=d,t.pushpop=l,t.heapify=u,t.updateItem=m,t.nlargest=v,t.nsmallest=y,t.prototype.push=function(t){return h(this.nodes,t,this.cmp)},t.prototype.pop=function(){return c(this.nodes,this.cmp)},t.prototype.peek=function(){return this.nodes[0]},t.prototype.contains=function(t){return-1!==this.nodes.indexOf(t)},t.prototype.replace=function(t){return d(this.nodes,t,this.cmp)},t.prototype.pushpop=function(t){return l(this.nodes,t,this.cmp)},t.prototype.heapify=function(){return u(this.nodes,this.cmp)},t.prototype.updateItem=function(t){return m(this.nodes,t,this.cmp)},t.prototype.clear=function(){return this.nodes=[]},t.prototype.empty=function(){return 0===this.nodes.length},t.prototype.size=function(){return this.nodes.length},t.prototype.clone=function(){var e;return e=new t,e.nodes=this.nodes.slice(0),e},t.prototype.toArray=function(){return this.nodes.slice(0)},t.prototype.insert=t.prototype.push,t.prototype.top=t.prototype.peek,t.prototype.front=t.prototype.peek,t.prototype.has=t.prototype.contains,t.prototype.copy=t.prototype.clone,t}(),function(n,a){o=[],i=a,void 0!==(r="function"==typeof i?i.apply(e,o):i)&&(t.exports=r)}(0,function(){return n})}).call(this)},function(t,e){t.exports="#define GLSLIFY 1\nvarying float vFall;\nvarying vec2 vUv;\n// varying vec3 vPos;\n\nvoid main() {\n  vec4 t = viewMatrix * modelMatrix * vec4( position, 1.0 );\n  // vec3 vPos = t.xyz;\n\n  vUv = uv;\n\n  float attenuate = 0.0005;\n  float spread = 20.;\n\n  vec4 wpos = modelMatrix * vec4( position, 1.0 );\n  vec3 cpos = cameraPosition.xyz;\n\n  float dx = wpos.x - cpos.x;\n  float dz = wpos.z - cpos.z;\n  float p = (dx * dx + dz * dz);\n\n  float distz = max(0., abs(attenuate - p) - spread);\n  wpos.y -= distz * distz * attenuate;\n\n  vFall = 0.08 + wpos.y;\n\n  gl_Position = projectionMatrix * viewMatrix * wpos;\n}"},function(t,e){t.exports="#define GLSLIFY 1\nvarying vec2 vUv;\n// varying vec3 vPos;\nvarying float vFall;\nuniform sampler2D texture;\n\nvoid main() {\n  if (vFall < -0.4) discard;\n  gl_FragColor = texture2D(texture, vUv);\n}"},function(t,e,n){"use strict";function i(){c=new THREE.ShaderMaterial({vertexShader:a.a,fragmentShader:u.a,uniforms:{texture:{type:"t",value:o.a.get("tex.props")}}})}var o=n(0),r=n(204),a=n.n(r),s=n(205),u=n.n(s),c=void 0;e.a={setup:i,getMaterial:function(){return c||i(),c}}},function(t,e){t.exports="#define GLSLIFY 1\nvarying float vFall;\nvarying vec2 vUv;\n// varying vec3 vPos;\n\nvoid main() {\n  // vec4 t = viewMatrix * modelMatrix * vec4( position, 1.0 );\n  // vec3 vPos = t.xyz;\n\n  vUv = uv;\n  vUv.x += .17578125;\n\n  float attenuate = 0.0005;\n  float spread = 20.;\n\n  vec4 wpos = modelMatrix * vec4( position, 1.0 );\n  vec3 cpos = cameraPosition.xyz;\n\n  float dx = wpos.x - cpos.x;\n  float dz = wpos.z - cpos.z;\n  float p = (dx * dx + dz * dz);\n\n  float distz = max(0., abs(attenuate - p) - spread);\n  wpos.y -= distz * distz * attenuate;\n\n  vFall = 0.08 + wpos.y;\n\n  gl_Position = projectionMatrix * viewMatrix * wpos;\n}"},function(t,e){t.exports="#define GLSLIFY 1\nvarying vec2 vUv;\n// varying vec3 vPos;\nvarying float vFall;\nuniform sampler2D texture;\n\nvoid main() {\n  if (vFall < -0.3) discard;\n  gl_FragColor = texture2D(texture, vUv);\n}"},function(t,e,n){"use strict";function i(t){var e=Math.floor((Math.sqrt(t+1)-1)/2)+1,n=8*e*(e-1)/2,i=2*e,o=(1+t-n)%(8*e),r=[0,0,e];switch(Math.floor(o/(2*e))){case 0:r[0]=o-e,r[1]=-e;break;case 1:r[0]=e,r[1]=o%i-e;break;case 2:r[0]=e-o%i,r[1]=e;break;case 3:r[0]=-e,r[1]=e-o%i}return r}e.a=i},function(t,e,n){"use strict";function i(){c=new THREE.ShaderMaterial({vertexShader:a.a,fragmentShader:u.a,uniforms:{texture:{type:"t",value:o.a.get("tex.landscape")},angle:{type:"f",value:0}},depthTest:!1,depthWrite:!1})}var o=n(0),r=n(208),a=n.n(r),s=n(209),u=n.n(s),c=void 0;e.a={setup:i,getMaterial:function(){return c||i(),c}}},function(t,e){t.exports="#define GLSLIFY 1\nvarying vec2 vUv;\nvarying float vX;\n\nvoid main() {\n  vUv = uv;\n  vX = position.x;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},function(t,e){t.exports="#define GLSLIFY 1\nuniform sampler2D texture;\nuniform float angle;\n\nvarying float vX;\nvarying vec2 vUv;\n\nvoid main() {\n  vec2 uv = vUv;\n  uv.x = mod(uv.x * 3. + -angle * 2.1, 1.);\n  float ny = uv.y - 0.1;\n  uv.y = mod(ny, 1.);\n\n  uv.y -= abs(cos(vX)) * 0.15 - 0.15;\n\n  gl_FragColor = texture2D(texture, uv);\n  if (ny > 1.0 || ny < 0.0) gl_FragColor = vec4(0.549, 0.820, 0.612, 1.);\n  // gl_FragColor = vec4(vUv.x, vUv.y, 0., 1.);\n}"},function(t,e,n){"use strict";function i(t){var e=[],n=document.createElement("div");n.style.zIndex="10000",n.style.position="fixed",n.style.top="48px",n.style.left="0",n.style.width="70px",n.style.padding="5px",n.style.background="#0a102d",n.style.color="#7dfaf1",n.style.fontFamily="Arial, sans-serif",n.style.fontSize="8px";for(var i=0;i<9;i++)e[i]=document.createElement("p"),e[i].style.padding="1px 0",e[i].style.margin="0",e[i].style.lineHeight="9px",0!==i&&4!==i||(e[i].style.background="#091e37",e[i].style.padding="3px 0",4===i&&(e[i].style.margin="10px 0 0px 0")),n.appendChild(e[i]),e[i].innerHTML="-";document.body.appendChild(n);var o=Date.now();return{update:function(){if(!(Date.now()-o<1e3/30)){o=Date.now();var n=0;e[n++].textContent="Memory",e[n++].textContent="Programs: "+t.info.programs.length,e[n++].textContent="Geometries: "+t.info.memory.geometries,e[n++].textContent="Textures: "+t.info.memory.textures,e[n++].textContent="Render",e[n++].textContent="Calls: "+t.info.render.calls,e[n++].textContent="Vertices: "+t.info.render.vertices,e[n++].textContent="Faces: "+t.info.render.faces,e[n++].textContent="Points: "+t.info.render.points}}}}e.a=i},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(5),d=n.n(l),f=n(18),p=(n.n(f),n(11)),v=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return d()(e,t),u()(e,[{key:"render",value:function(){var t=document.createElement("section");t.classList.add("transition-overlay");for(var e=0;e<5;e++){var n=document.createElement("div");n.classList.add("overlay-panel"),t.appendChild(n)}return t}},{key:"show",value:function(){return this.refs.base.classList.add("visible"),this.refs.base.classList.remove("hidden"),this.timer(1e3)}},{key:"hide",value:function(){return this.refs.base.classList.remove("visible"),this.refs.base.classList.add("hidden"),this.timer(1e3)}},{key:"didMount",value:function(t){}}]),e}(p.a);e.a=v},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(5),d=n.n(l),f=n(18),p=n.n(f),v=n(11),y=n(28),m=n(0),g=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return d()(e,t),u()(e,[{key:"animateLoadingText",value:function(t){var e=t.textContent.trim();t.innerHTML="";for(var n=0;n<e.length;n++){var i=e[n],o=document.createElement("span");o.classList.add("loading-char"),o.textContent=i,t.appendChild(o)}}},{key:"renderPermissionMessage",value:function(){var t=document.createElement("div");t.classList.add("preloader-permission");var e=document.createElement("div");return e.classList.add("permission-message"),e.textContent=y.a[m.a.get("lang")]["preloader.permission"],e.dataset.filltxt=y.a[m.a.get("lang")]["preloader.permission"],t.appendChild(e),t}},{key:"permissionMessage",value:function(){this.refs.base.removeChild(this.refs.loading),this.refs.loading=void 0,this.refs.permissions=this.renderPermissionMessage(),this.refs.permmsg=this.refs.permissions.querySelector(".permission-message"),this.refs.base.appendChild(this.refs.permissions),this.anims.permissions=p()({targets:this.refs.permmsg,opacity:[0,1],scale:[.1,1],rotate:[-5,0],duration:1e3})}},{key:"refreshMessage",value:function(){this.refs.refresh=document.createElement("div"),this.refs.refresh.classList.add("permission-refresh"),this.refs.refresh.innerHTML=y.a[m.a.get("lang")]["preloader.refresh"],this.refs.refresh.dataset.filltxt=y.a[m.a.get("lang")]["preloader.refresh.nolink"],this.refs.permmsg.appendChild(this.refs.refresh),this.anims.refresh=p()({targets:this.refs.permmsg,scale:[.7,1],rotate:[4,0],duration:1200,elasticity:500})}},{key:"beginPerm",value:function(){var t=this;this.permTimer=window.setTimeout(function(){t.permTimer=null,t.permissionMessage(),t.beginRefresh()},300)}},{key:"beginRefresh",value:function(){var t=this;this.refreshTimer=window.setTimeout(function(){t.refreshTimer=null,t.refreshMessage()},3500)}},{key:"stopPerm",value:function(){this.permTimer&&window.clearTimeout(this.permTimer),this.refreshTimer&&window.clearTimeout(this.refreshTimer)}},{key:"didMount",value:function(t){this.refs.loading=t.querySelector(".preloader-loading"),this.refs.loading.textContent=y.a[m.a.get("lang")]["preloader.loading"],this.animateLoadingText(this.refs.loading)}}]),e}(v.a);e.a=g},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(5),d=n.n(l),f=n(88),p=(n.n(f),n(11)),v=n(214),y=n(216),m=n(0),g=n(18),b=n.n(g),x=n(21),w={0:"fr",1:"en"},k=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return d()(e,t),u()(e,[{key:"didInit",value:function(){var t=this;this.onstart=x.a,this.options=new v.a({language:{data:"home.lang",choice:m.a.get("langIndex")},quality:{data:"home.quality",choice:m.a.get("quality")}}),this.button=new y.a({label:"home.cta"}),this.button.onclick=function(){t.onstart()},this.options.components.language.onchange=function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];f.set("lang",w[t]),m.a.set("lang",w[t])},this.options.components.quality.onchange=function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];f.set("quality",t),m.a.set("quality",t)}}},{key:"didMount",value:function(t){this.refs.logo=document.createElement("div"),this.refs.logo.classList.add("homescreen-logo"),t.appendChild(this.refs.logo),this.refs.menu=document.createElement("div"),this.refs.menu.classList.add("homescreen-menu"),t.appendChild(this.refs.menu),this.options.mount(this.refs.menu),this.button.mount(this.refs.menu);for(var e in this.options.components){this.options.components[e].refs.base.style.opacity=0}this.button.refs.base.style.opacity=0}},{key:"show",value:function(){var t=this;this.timer(250).then(function(){var e=document.createElement("img");e.src=m.a.get("blob.logo"),t.refs.logo.appendChild(e),t.refs.logoImg=e,t.timer(800).then(function(){return t.showMenu()})})}},{key:"showMenu",value:function(){var t=this;this.anims.logo=b()({targets:this.refs.logoImg,translateY:["0","-110px"],scale:[1,.95],duration:800}),this.timer(100,function(){t.anims.language=b()({targets:t.options.components.language.refs.base,translateY:["80px","0"],opacity:[0,1],duration:800})}),this.timer(180,function(){t.anims.quality=b()({targets:t.options.components.quality.refs.base,translateY:["100px","0"],opacity:[0,1],duration:800})}),this.timer(250,function(){t.anims.button=b()({targets:t.button.refs.base,translateY:["120px","0"],opacity:[0,1],duration:800})})}},{key:"willUnmount",value:function(){this.button.destroy(),this.options.destroy(),this.options=void 0}}]),e}(p.a);e.a=k},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(5),d=n.n(l),f=n(11),p=n(215),v=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return d()(e,t),u()(e,[{key:"didInit",value:function(t){this.options=t,this.components={};for(var e in this.options)this.components[e]=new p.a(this.options[e])}},{key:"render",value:function(){var t=document.createElement("div");return t.classList.add("menu-options"),t}},{key:"didMount",value:function(t){for(var e in this.components)this.components[e].mount(t)}},{key:"willUnmount",value:function(){for(var t in this.components)this.components[t].destroy();this.options=void 0,this.components=void 0}}]),e}(f.a);e.a=v},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(5),d=n.n(l),f=n(11),p=n(18),v=n.n(p),y=n(21),m=n(28),g=n(0),b=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return d()(e,t),u()(e,[{key:"didInit",value:function(t){this.locCode=t.data,this.choices=m.a[g.a.get("lang")][this.locCode],this.current=0|t.choice,this.value=this.choices[this.current],this.onchange=y.a}},{key:"render",value:function(){var t=document.createElement("div");t.classList.add("options-option");var e=document.createElement("div");e.className="option-bt option-rightbt",e.textContent=">",e.dataset.filltxt=">";var n=document.createElement("div");n.className="option-bt option-leftbt",n.textContent="<",n.dataset.filltxt="<";var i=document.createElement("div");return i.classList.add("option-current"),i.textContent=this.value,i.dataset.filltxt=this.value,this.refs.left=n,this.refs.right=e,this.refs.current=i,t.appendChild(n),t.appendChild(i),t.appendChild(e),t}},{key:"didMount",value:function(t){this.bindFuncs(["prev","next","langChange"]),this.refs.left.addEventListener("click",this.prev),this.refs.right.addEventListener("click",this.next),g.a.watch("lang",this.langChange)}},{key:"next",value:function(){this.current=this.current+1<this.choices.length?this.current+1:0,this.updateText()}},{key:"prev",value:function(){this.current=this.current>0?this.current-1:this.choices.length-1,this.updateText()}},{key:"langChange",value:function(){this.choices=m.a[g.a.get("lang")][this.locCode],this.value=this.choices[this.current],this.refs.current.textContent=this.value,this.refs.current.dataset.filltxt=this.value}},{key:"updateText",value:function(){this.value=this.choices[this.current],this.onchange(this.current,this.value),this.refs.current.textContent=this.value,this.refs.current.dataset.filltxt=this.value,this.anims.current&&(this.anims.current.pause(),this.anims.current=void 0),this.anims.current=v()({targets:this.refs.current,scale:[1.3,1],rotate:[-3,0],duration:800,elasticity:700})}},{key:"willUnmount",value:function(){this.refs.left.removeEventListener("click",this.next),this.refs.left.removeEventListener("click",this.prev),g.a.unwatch("lang",this.langChange)}}]),e}(f.a);e.a=b},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(5),d=n.n(l),f=n(11),p=n(0),v=n(34),y=n(103),m=n(28),g=n(21),b=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return d()(e,t),u()(e,[{key:"didInit",value:function(t){this.locCode=t.label,this.currentOff=[0,0],this.targetOff=[0,0],this.pressed=0,this.onclick=g.a,this.ix=new y.a({value:0,interpolation:"elastic",rigidity:.2,friction:10}),this.iy=new y.a({value:0,interpolation:"elastic",rigidity:.2,friction:10})}},{key:"render",value:function(){this.refs.front=document.createElement("div"),this.refs.front.classList.add("button-front"),this.refs.front.textContent=m.a[p.a.get("lang")][this.locCode],this.refs.front.dataset.filltxt=m.a[p.a.get("lang")][this.locCode],this.refs.front.style.backgroundImage="url("+p.a.get("blob.cta")+")",this.refs.back=document.createElement("div"),this.refs.back.classList.add("button-back"),this.refs.back.style.backgroundImage="url("+p.a.get("blob.cta.shadow")+")",this.refs.ground=document.createElement("div"),this.refs.ground.classList.add("button-ground"),this.refs.ground.style.backgroundImage="url("+p.a.get("blob.cta.ground")+")";var t=document.createElement("div");return t.classList.add("button"),t.appendChild(this.refs.ground),t.appendChild(this.refs.back),t.appendChild(this.refs.front),t}},{key:"didMount",value:function(t){this.bindFuncs(["move","out","down","up","click","update","langChange"]),t.addEventListener("mousemove",this.move),t.addEventListener("mouseout",this.out),t.addEventListener("mousedown",this.down),t.addEventListener("mouseup",this.up),t.addEventListener("click",this.click),p.a.watch("lang",this.langChange),v.a.add(this.update)}},{key:"langChange",value:function(){this.refs.front.textContent=m.a[p.a.get("lang")][this.locCode],this.refs.front.dataset.filltxt=m.a[p.a.get("lang")][this.locCode]}},{key:"click",value:function(){this.onclick()}},{key:"out",value:function(t){this.ix.to(0),this.iy.to(0),this.ix.interpolationParams.rigidity=.1,this.iy.interpolationParams.rigidity=.1}},{key:"move",value:function(t){var e=t?t.clientX:this.mx,n=t?t.clientY:this.my;t&&(this.mx=t.clientX,this.my=t.clientY);var i=this.refs.base.getBoundingClientRect();this.ix.interpolationParams.rigidity=.2,this.iy.interpolationParams.rigidity=.2,this.ix.to(.12*-(i.left-e+i.width/2)*(1-this.pressed)),this.iy.to(.12*-(i.top-n+i.height/2)-3*(1-this.pressed))}},{key:"down",value:function(){this.pressed=1,this.move()}},{key:"up",value:function(){this.pressed=0,this.move()}},{key:"update",value:function(){this.refs&&this.refs.front&&(this.ix.update(),this.iy.update(),this.refs.front.style.transform="translate3d("+this.ix.value+"px, "+this.iy.value+"px, 0) rotate("+-this.ix.value*this.iy.value*.05+"deg)",this.refs.back.style.transform="translate3d("+.2*this.ix.value+"px, "+.2*this.iy.value+"px, 0) rotate("+.8*-this.ix.value*this.iy.value*.05+"deg)")}},{key:"willUnmount",value:function(){this.update=g.a,v.a.remove(this.update),p.a.unwatch("lang",this.langChange),this.refs.base.removeEventListener("click",this.click),this.refs.base.removeEventListener("mousemove",this.move),this.refs.base.removeEventListener("mouseout",this.out),this.refs.base.removeEventListener("mousedown",this.down),this.refs.base.removeEventListener("mouseup",this.up)}}]),e}(f.a);e.a=b},function(t,e,n){"use strict";e.a=function(t,e,n){return t-(t-e)/n.friction}},function(t,e,n){"use strict";e.a=function(t,e,n,i,o){o&&(this.speed=0);var r=t-e,a=-r/(n.friction/100),s=-n.rigidity*this.speed,u=(a+s)/n.mass;return this.speed+=u*i,t+this.speed*i}},function(t,e,n){"use strict";e.a=function(t,e,n,i,o){o&&(this.speed=0);var r=t-e,a=-r/(n.friction/100),s=-n.rigidity*this.speed,u=(a+s)/n.mass;this.speed+=u*i;var c=t+this.speed*i;return c-e>=0?(this.speed=-this.speed,e):c}},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(5),d=n.n(l),f=n(11),p=n(221),v=n(223),y=n(225),m=n(228),g=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return d()(e,t),u()(e,[{key:"didInit",value:function(){this.bubbles=[],this.status=new p.a,this.bubbleManager=new v.a,this.radarWrapper=new y.a,this.score=new m.a}},{key:"didMount",value:function(t){this.bubbleManager.mount(t),this.radarWrapper.mount(t),this.status.mount(t),this.score.mount(t)}},{key:"willUnmount",value:function(){}}]),e}(f.a);e.a=g},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(5),d=n.n(l),f=n(0),p=n(11),v=n(222),y=n(52),m=n(34),g=["hidden","transparent","visible"],b=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return d()(e,t),u()(e,[{key:"didInit",value:function(){this.panic=null,this.face=new v.a}},{key:"render",value:function(){var t=document.createElement("section");t.className="gui-status";var e=document.createElement("div");e.className="status-stressbar",t.appendChild(e),this.refs.stressbar=e;var n=document.createElement("div");n.className="stressbar-level",e.appendChild(n),this.refs.stresslevel=n;var i=f.a.get("img.gui.left").cloneNode();return i.className="stressbar-img",e.appendChild(i),this.refs.stressimg=i,this.panic=!1,t}},{key:"didMount",value:function(t){this.bindFuncs(["statusChange","update"]),this.face.mount(t),f.a.watch("status.status",this.statusChange),f.a.set("status.status","hidden"),m.a.add(this.update)}},{key:"update",value:function(t){if(y.a.panic&&!this.panic){this.refs.stresslevel.classList.add("panic"),this.refs.stressbar.removeChild(this.refs.stressimg);var e=f.a.get("img.gui.left.panic").cloneNode();e.className="stressbar-img",this.refs.stressbar.appendChild(e),this.refs.stressimg=e,this.panic=!0}else if(!y.a.panic&&this.panic){this.refs.stresslevel.classList.remove("panic"),this.refs.stressbar.removeChild(this.refs.stressimg);var n=f.a.get("img.gui.left").cloneNode();n.className="stressbar-img",this.refs.stressbar.appendChild(n),this.refs.stressimg=n,this.panic=!1}this.refs.stresslevel.style.transform="scaleY("+y.a.value+")"}},{key:"statusChange",value:function(t){var e=this.refs.base;g.forEach(function(n){t===n?e.classList.add(n):e.classList.remove(n)})}},{key:"willUnmount",value:function(t){m.a.remove(this.update),f.a.unwatch("status.status",this.statusChange)}}]),e}(p.a);e.a=b},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(5),d=n.n(l),f=n(0),p=n(11),v=n(52),y=n(34),m=n(18),g=n.n(m),b=n(16),x=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return d()(e,t),u()(e,[{key:"didInit",value:function(){this.player=f.a.get("player.vehicle"),this.lifeId=0,this.stressId=0,this.bumpTimerMax=1e3,this.bumpTimer=0,this.tang=0,this.ang=0}},{key:"render",value:function(){var t=document.createElement("div");return t.className="status-face",t}},{key:"swapFace",value:function(){this.refs.img&&this.refs.base.removeChild(this.refs.img),this.anims.swap&&(this.anims.swap.pause(),this.anims.swap=null);var t=f.a.get("img.face."+this.lifeId+"."+this.stressId).cloneNode();t.className="face-img",this.refs.base.appendChild(t),this.refs.img=t,this.anims.swap=g()({targets:t,scale:[2.3,2],skewY:[10,0],elasticity:700,duration:1e3})}},{key:"didMount",value:function(t){this.swapFace(),this.bindFuncs(["update","onDamage"]),b.a.on("player.damage",this.onDamage),y.a.add(this.update)}},{key:"onDamage",value:function(){this.bumpTimer=this.bumpTimerMax}},{key:"update",value:function(t){if(!this.player)return void(this.player=f.a.get("player.vehicle"));this.tang=.05*-this.player.body.angularVelocity,this.ang+=.3*(this.tang-this.ang),this.refs.base.style.transform="rotate("+this.ang+"rad)";var e=this.stressId,n=this.lifeId;this.bumpTimer>0?(this.bumpTimer===this.bumpTimerMax&&(this.stressId=2),this.bumpTimer-=t):v.a.panic?this.stressId=2:v.a.value<.3?this.stressId=0:v.a.value<.75?this.stressId=1:this.stressId=2,this.player.lifeIndice>.8?this.lifeId=0:this.player.lifeIndice>.3?this.lifeId=1:this.lifeId=2,e===this.stressId&&n===this.lifeId||this.swapFace()}},{key:"willUnmount",value:function(t){y.a.remove(this.update)}}]),e}(p.a);e.a=x},function(t,e,n){"use strict";var i=n(41),o=n.n(i),r=n(3),a=n.n(r),s=n(1),u=n.n(s),c=n(2),h=n.n(c),l=n(4),d=n.n(l),f=n(5),p=n.n(f),v=n(16),y=n(11),m=n(224),g=n(0),b=n(36),x=0,w=function(t){function e(){return u()(this,e),d()(this,(e.__proto__||a()(e)).apply(this,arguments))}return p()(e,t),h()(e,[{key:"didInit",value:function(){this.bindFuncs(["onOrder"]),this.bubbles={},b.a.on(":all",this.onOrder)}},{key:"render",value:function(){var t=document.createElement("section");return t.className="gui-bubbles",t}},{key:"onOrder",value:function(t){g.a.get("player.dead")||("goManual"===t.type&&this.autoBubble("manual",6),"speedUp"===t.type&&this.autoBubble("speedup",4),"speedDown"===t.type&&this.autoBubble("speeddown",5),"radioOn"===t.type&&this.autoBubble("radio",7))}},{key:"autoBubble",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;t+=++x,!this.bubbles[t]&&this.refs.base&&(this.addBubble(t,e),setTimeout(function(){n.deleteBubble(t)},i))}},{key:"addBubble",value:function(t,e){!this.bubbles[t]&&this.refs.base&&(this.offsetBubbles(),this.bubbles[t]=new m.a({type:e}),this.bubbles[t].mount(this.refs.base))}},{key:"deleteBubble",value:function(t){if(this.bubbles[t]&&this.refs.base){var e=this.bubbles[t];delete this.bubbles[t],this.offsetBubbles(-1),e.hide().then(function(){return e.destroy()})}}},{key:"addWaypoint",value:function(t){if(!g.a.get("player.dead")){var e=t.x+"."+t.y;this.addBubble(e,t.dir)}}},{key:"offsetBubbles",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=0,n=o()(this.bubbles).length;for(var i in this.bubbles){var r=n-e+t;this.bubbles[i].offset(r),e++}}},{key:"reachWaypoint",value:function(t){var e=t.x+"."+t.y;this.deleteBubble(e)}},{key:"cancelWaypoint",value:function(t){var e=t.x+"."+t.y;if(this.bubbles[e]&&this.refs.base){var n=this.bubbles[e];delete this.bubbles[e],this.offsetBubbles(-1),n.hide().then(function(){return n.destroy()})}}},{key:"reset",value:function(){var t=this;o()(this.bubbles).forEach(function(e){var n=t.bubbles[e];delete t.bubbles[e],n.hide().then(function(){return n.destroy()})})}},{key:"didMount",value:function(){this.bindFuncs(["addWaypoint","reachWaypoint","cancelWaypoint","reset"]),v.a.on("waypoints.add",this.addWaypoint),v.a.on("waypoints.reach",this.reachWaypoint),v.a.on("waypoints.cancel",this.cancelWaypoint),v.a.on("bubbles.reset",this.reset)}},{key:"willUnmount",value:function(){v.a.off("waypoints.add",this.addWaypoint),v.a.off("waypoints.reach",this.reachWaypoint),v.a.off("waypoints.cancel",this.cancelWaypoint),v.a.off("bubbles.reset",this.reset)}}]),e}(y.a);e.a=w},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(5),d=n.n(l),f=n(11),p=n(0),v=n(18),y=n.n(v),m=(n(8),{0:"straight",1:"right",2:"uturn",3:"left",4:"speedup",5:"speeddown",6:"wheel",7:"radio"}),g=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return d()(e,t),u()(e,[{key:"didInit",value:function(t){this.type=m[t.type]}},{key:"render",value:function(){var t=document.createElement("div");t.className="bubbles-bubble";var e=p.a.get("img.bubble."+this.type).cloneNode();return t.appendChild(e),t}},{key:"show",value:function(){this.anims.show=y()({targets:this.refs.base,translateY:[0,0],opacity:[0,1],rotate:[-20,0],scale:["*=0.5",1],duration:800})}},{key:"hide",value:function(){this.anims.show&&(this.anims.show.pause(),delete this.anims.show),this.anims.offset&&(this.anims.offset.pause(),delete this.anims.offset);var t=y.a.getValue(this.refs.base,"translateY"),e=y.a.getValue(this.refs.base,"rotate");return this.anims.hide=y()({targets:this.refs.base,translateY:t,translateX:-60,opacity:0,rotate:[e,0],duration:400,easing:"easeInOutQuad"}),this.anims.hide.finished}},{key:"offset",value:function(t){this.anims.show&&(this.anims.show.pause(),delete this.anims.show),this.anims.offset&&(this.anims.offset.pause(),delete this.anims.offset),this.anims.offset=y()({targets:this.refs.base,translateY:-65*t+5*(t-1),rotate:3*t,scale:1-.1*t,duration:800})}},{key:"didMount",value:function(){this.show()}}]),e}(f.a);e.a=g},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(5),d=n.n(l),f=n(0),p=n(11),v=n(226),y=n(227),m=["hidden","transparent","visible"],g=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return d()(e,t),u()(e,[{key:"didInit",value:function(){this.radar=new v.a,this.minimap=new y.a}},{key:"render",value:function(){var t=document.createElement("section");return t.className="gui-radar-wrapper",t}},{key:"didMount",value:function(t){this.bindFuncs(["statusChange"]),this.minimap.mount(t),this.radar.mount(t),f.a.watch("radar.status",this.statusChange),f.a.set("radar.status","hidden")}},{key:"statusChange",value:function(t){var e=this.refs.base;m.forEach(function(n){t===n?e.classList.add(n):e.classList.remove(n)})}},{key:"willUnmount",value:function(t){f.a.unwatch("radar.status",this.statusChange),this.minimap.destroy(),this.radar.destroy()}}]),e}(p.a);e.a=g},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(5),d=n.n(l),f=n(0),p=n(11),v=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return d()(e,t),u()(e,[{key:"render",value:function(){var t=document.createElement("section");t.className="gui-radar";var e=f.a.get("img.gui.right").cloneNode();return t.appendChild(e),t}}]),e}(p.a);e.a=v},function(t,e,n){"use strict";function i(t,e){t=document.createElementNS("http://www.w3.org/2000/svg",t);for(var n in e)"class"===n?(Array.isArray(e[n])?e[n]:[e[n]]).forEach(function(e){return t.classList.add(e)}):t.setAttributeNS(null,n,e[n]);return t}function o(t,e){t=document.createElement(t);for(var n in e)"class"===n?(Array.isArray(e[n])?e[n]:[e[n]]).forEach(function(e){return t.classList.add(e)}):t[n]=e[n];return t}function r(t){t&&t.parentNode&&t.parentNode.removeChild(t)}var a=n(49),s=n.n(a),u=n(3),c=n.n(u),h=n(1),l=n.n(h),d=n(2),f=n.n(d),p=n(4),v=n.n(p),y=n(5),m=n.n(y),g=n(11),b=n(17),x=n(0),w=n(16),k=function(t,e){return"chunk_"+t+"_"+e},M=function(t){return"translateX("+t.x+"px) translateY("+t.y+"px)"},_={width:150,height:150,viewDistance:5,lockNorth:!1},E=function(t){function e(){return l()(this,e),v()(this,(e.__proto__||c()(e)).apply(this,arguments))}return m()(e,t),f()(e,[{key:"didInit",value:function(t){t=s()({},_,t||{}),this.bindFuncs(["onPlayerMove","onPlayerRotate","onCopAdded","onCopMove","onCopRemoved","reset"]),this.width=t.width,this.height=t.height,this.viewDistance=t.viewDistance+!(1&t.viewDistance),this.chunkDistFromCenter=(this.viewDistance-1)/2,this.previousChunk=[0,0],this.currentChunk=[0,0],this.chunkSize=b.a.getChunkSize(),this.chunkSVGWidth=this.width/this.viewDistance*1.3,this.chunkSVGHeight=this.height/this.viewDistance*1.3,this.playerPos=[0,0],this.playerAng=0,this.lockNorth=t.lockNorth}},{key:"render",value:function(){var t=o("section",{class:"gui-minimap"});t.style.width=this.width+"px",t.style.height=this.height+"px",this.refs.car=o("div",{id:"car",class:"gui-minimap-car"}),this.refs.container=o("div",{class:"gui-minimap-container"}),t.appendChild(this.refs.car),t.appendChild(this.refs.container);for(var e=-this.chunkDistFromCenter;e<=this.chunkDistFromCenter;e++)for(var n=-this.chunkDistFromCenter;n<=this.chunkDistFromCenter;n++)this.addChunk(this.currentChunk[0]+e,this.currentChunk[1]+n);return t}},{key:"reset",value:function(){if(this.previousChunk=[0,0],this.currentChunk=[0,0],this.playerPos=[0,0],this.playerAng=0,this.refs.chunks){for(var t in this.refs.chunks)r(this.refs.chunks[t]);this.refs.chunks=[]}if(this.refs.cops){for(var e in this.refs.cops)r(this.refs.cops[e]);this.refs.cops=[]}for(var n=-this.chunkDistFromCenter;n<=this.chunkDistFromCenter;n++)for(var i=-this.chunkDistFromCenter;i<=this.chunkDistFromCenter;i++)this.addChunk(this.currentChunk[0]+n,this.currentChunk[1]+i);this.update()}},{key:"update",value:function(){this.currentChunk=[Math.floor((Math.round(this.playerPos[0])+this.chunkSize/2)/this.chunkSize),Math.floor((Math.round(this.playerPos[1])+this.chunkSize/2)/this.chunkSize)];var t=this.currentChunk[0]-this.previousChunk[0],e=this.currentChunk[1]-this.previousChunk[1];if(t||e){if(0!==t){for(var n=this.previousChunk[0]-this.chunkDistFromCenter*t,i=this.currentChunk[0]+this.chunkDistFromCenter*t,o=this.previousChunk[1]-this.chunkDistFromCenter,r=this.currentChunk[1]+this.chunkDistFromCenter,a=o;a<=r;a++)this.removeChunk(n,a),this.addChunk(i,a);this.previousChunk[0]=this.currentChunk[0]}if(0!==e)for(var s=this.previousChunk[1]-this.chunkDistFromCenter*e,u=this.currentChunk[1]+this.chunkDistFromCenter*e,c=this.previousChunk[0]-this.chunkDistFromCenter,h=this.currentChunk[0]+this.chunkDistFromCenter,l=c;l<=h;l++)this.removeChunk(l,s),this.addChunk(l,u);this.previousChunk=this.currentChunk.slice()}}},{key:"addChunk",value:function(t,e){this.refs.chunks||(this.refs.chunks=[]);var n=k(t,e);if(!this.refs.chunks[n]){var o=b.a.getChunkFromPool(t,e);if(o){var r=i("svg",{class:"gui-minimap-chunk",width:this.chunkSVGWidth,height:this.chunkSVGHeight,viewBox:"-0.01 -0.01 "+(this.chunkSize+.01)+" "+(this.chunkSize+.01)});r.style.left=Math.floor(-t*this.chunkSVGWidth-this.chunkSVGWidth/2)+"px",r.style.top=Math.floor(-e*this.chunkSVGHeight-this.chunkSVGHeight/2)+"px",r.innerHTML=o.svg,this.refs.container.appendChild(r),this.refs.chunks[n]=r}}}},{key:"removeChunk",value:function(t,e){var n=k(t,e);r(this.refs.chunks[n]),this.refs.chunks[n]=null,delete this.refs.chunks[n]}},{key:"onPlayerMove",value:function(t){this.playerPos=t,this.refs.container.style.transform=M({x:this.playerPos[0]/this.chunkSize*this.chunkSVGWidth,y:this.playerPos[1]/this.chunkSize*this.chunkSVGHeight}),this.update()}},{key:"onPlayerRotate",value:function(t){this.playerAng=t,this.lockNorth&&(this.refs.base.style.transform="rotate("+this.playerAng+"rad)"),this.refs.car.style.transform="rotate("+-this.playerAng+"rad)"}},{key:"onCopAdded",value:function(t){var e=t.id,n=t.position;this.refs.cops||(this.refs.cops=[]);var i=o("div",{class:"gui-minimap-cop"});i.style.transform=M({x:n[0]/this.chunkSize*this.chunkSVGWidth,y:n[1]/this.chunkSize*this.chunkSVGHeight}),this.refs.container.appendChild(i),this.refs.cops[e]=i}},{key:"onCopMove",value:function(t){var e=t.id,n=t.position;this.refs.cops[e]&&(this.refs.cops[e].style.transform=M({x:-n[0]/this.chunkSize*this.chunkSVGWidth,y:-n[1]/this.chunkSize*this.chunkSVGHeight}))}},{key:"onCopRemoved",value:function(t){var e=t.id;r(this.refs.cops[e]),this.refs.cops[e]=null}},{key:"didMount",value:function(t){x.a.watch("player.position",this.onPlayerMove),x.a.watch("player.angle",this.onPlayerRotate),w.a.on("cop.added",this.onCopAdded),w.a.on("cop.move",this.onCopMove),w.a.on("cop.removed",this.onCopRemoved),w.a.on("minimap.reset",this.reset)}},{key:"willUnmount",value:function(){x.a.unwatch("player.position",this.onPlayerMove),x.a.unwatch("player.angle",this.onPlayerRotate),w.a.off("cop.added",this.onCopAdded),w.a.off("cop.move",this.onCopMove),w.a.off("cop.removed",this.onCopRemoved),w.a.off("minimap.reset",this.reset)}}]),e}(g.a);e.a=E},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(5),d=n.n(l),f=n(0),p=n(11),v=n(104),y=n.n(v),m=["hidden","transparent","visible"],g=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return d()(e,t),u()(e,[{key:"render",value:function(){var t=document.createElement("section");t.className="gui-score";var e=document.createElement("div");return e.className="score-content",this.refs.score=e,this.updateScore(0),t.appendChild(e),t}},{key:"updateScore",value:function(t){var e=y()(""+t,5,"0")+(+t>2?"pts":"pt");this.refs.score.textContent=e,this.refs.score.dataset.filltxt=e}},{key:"onScore",value:function(t){this.updateScore(t)}},{key:"didMount",value:function(t){this.bindFuncs(["statusChange","onScore"]),f.a.watch("score.value",this.onScore),f.a.watch("score.status",this.statusChange),f.a.set("score.status","hidden")}},{key:"statusChange",value:function(t){var e=this.refs.base;m.forEach(function(n){t===n?e.classList.add(n):e.classList.remove(n)})}},{key:"willUnmount",value:function(t){f.a.unwatch("score.status",this.statusChange)}}]),e}(p.a);e.a=g},function(t,e,n){function i(t,e){e=void 0===e?" ":r(e);var n=e.length;if(n<2)return n?o(e,t):e;var i=o(e,h(t/u(e)));return s(e)?a(c(i),0,t).join(""):i.slice(0,t)}var o=n(230),r=n(105),a=n(233),s=n(71),u=n(106),c=n(238),h=Math.ceil;t.exports=i},function(t,e){function n(t,e){var n="";if(!t||e<1||e>i)return n;do{e%2&&(n+=t),(e=o(e/2))&&(t+=t)}while(e);return n}var i=9007199254740991,o=Math.floor;t.exports=n},function(t,e){function n(t,e){for(var n=-1,i=null==t?0:t.length,o=Array(i);++n<i;)o[n]=e(t[n],n,t);return o}t.exports=n},function(t,e){var n=Array.isArray;t.exports=n},function(t,e,n){function i(t,e,n){var i=t.length;return n=void 0===n?i:n,!e&&n>=i?t:o(t,e,n)}var o=n(234);t.exports=i},function(t,e){function n(t,e,n){var i=-1,o=t.length;e<0&&(e=-e>o?0:o+e),n=n>o?o:n,n<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var r=Array(o);++i<o;)r[i]=t[i+e];return r}t.exports=n},function(t,e,n){var i=n(236),o=i("length");t.exports=o},function(t,e){function n(t){return function(e){return null==e?void 0:e[t]}}t.exports=n},function(t,e){function n(t){for(var e=l.lastIndex=0;l.test(t);)++e;return e}var i="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",o="\\ud83c[\\udffb-\\udfff]",r="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",s="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",u="(?:\\u200d(?:"+["[^\\ud800-\\udfff]",r,a].join("|")+")[\\ufe0e\\ufe0f]?"+s+")*",c="[\\ufe0e\\ufe0f]?"+s+u,h="(?:"+["[^\\ud800-\\udfff]"+i+"?",i,r,a,"[\\ud800-\\udfff]"].join("|")+")",l=RegExp(o+"(?="+o+")|"+h+c,"g");t.exports=n},function(t,e,n){function i(t){return r(t)?a(t):o(t)}var o=n(239),r=n(71),a=n(240);t.exports=i},function(t,e){function n(t){return t.split("")}t.exports=n},function(t,e){function n(t){return t.match(l)||[]}var i="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",o="\\ud83c[\\udffb-\\udfff]",r="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",s="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",u="(?:\\u200d(?:"+["[^\\ud800-\\udfff]",r,a].join("|")+")[\\ufe0e\\ufe0f]?"+s+")*",c="[\\ufe0e\\ufe0f]?"+s+u,h="(?:"+["[^\\ud800-\\udfff]"+i+"?",i,r,a,"[\\ud800-\\udfff]"].join("|")+")",l=RegExp(o+"(?="+o+")|"+h+c,"g");t.exports=n},function(t,e,n){function i(t){var e=o(t),n=e%1;return e===e?n?e-n:e:0}var o=n(242);t.exports=i},function(t,e,n){function i(t){if(!t)return 0===t?t:0;if((t=o(t))===r||t===-r){return(t<0?-1:1)*a}return t===t?t:0}var o=n(92),r=1/0,a=1.7976931348623157e308;t.exports=i},function(t,e,n){function i(t){return null==t?"":o(t)}var o=n(105);t.exports=i},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(5),d=n.n(l),f=n(11),p=n(18),v=n.n(p),y=n(0),m=n(28),g={"Web Speech API unavailable.":"webspeech","not-allowed":"notallowed"},b=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return d()(e,t),u()(e,[{key:"didInit",value:function(t){this.error=t.error||{},this.trueMsg=this.error.message||"",this.type=g[this.error.message]||g[this.error.error]||"unknown"}},{key:"render",value:function(){var t=document.createElement("section");t.classList.add("error");var e=document.createElement("div");e.classList.add("error-message");var n=document.createElement("p");n.classList.add("message-title"),n.textContent=m.a[y.a.get("lang")]["error."+this.type],n.dataset.filltxt=m.a[y.a.get("lang")]["error."+this.type];var i=document.createElement("p");return i.classList.add("message-subtitle"),"unknown"===this.type&&this.trueMsg?(i.textContent=this.trueMsg,i.dataset.filltxt=this.trueMsg):(i.textContent=m.a[y.a.get("lang")]["error."+this.type+".subtitle"]||"",i.dataset.filltxt=m.a[y.a.get("lang")]["error."+this.type+".subtitle"]||""),n.style.opacity=0,i.style.opacity=0,this.refs.title=n,this.refs.subtitle=i,this.refs.message=e,e.appendChild(n),e.appendChild(i),t.appendChild(e),t}},{key:"show",value:function(){var t=this;this.anims.title=v()({targets:this.refs.message,translateY:["-50%","-50%"],translateX:["-50%","-50%"],scale:[.6,1],duration:800,opacity:[1,1]}),this.timer(120).then(function(){t.anims.title=v()({targets:t.refs.title,translateY:[80,0],skewY:[-6,0],duration:800,opacity:[1,1]})}),this.timer(190).then(function(){t.anims.subtitle=v()({targets:t.refs.subtitle,translateY:[100,0],skewY:[6,0],duration:800,opacity:[1,1]})})}}]),e}(f.a);e.a=b},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(10),d=n.n(l),f=n(5),p=n.n(f),v=(n(246),n(9)),y=(n(7),n(247)),m=n(265),g=n(270),b=n(25),x=n(96),w=n(51),k=n(47),M=n(0),_=n(16),E=n(274),S=n(45),T=n(36),C=n(6),P=n(17),O=n(8),R=n(35),I=n(52),F=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return p()(e,t),u()(e,[{key:"setup",value:function(){var t=this;this.bindFuncs(["tutorialEnd","orderOnce","onDead","reboot"]),x.a.setup(),this.ground=this.addComponent(new g.a),this.playerCar=this.addComponent(new m.a),this.terrain=this.addComponent(new y.a),this.score=0,this.firstframe=!0,b.a.setTarget(this.playerCar),w.a.setup(),this.resize(M.a.get("size")),E.a.mount(),setTimeout(function(){C.a.quickstart?(t.reboot(),C.a.manualDrive&&(setTimeout(function(){return M.a.set("order.once",!0)},10),t.timerBeforeCopSpawn=0)):t.gameOverlay(),R.a.startBg(),R.a.updateBgVolume(.06,!0)},1),this.scoreNeedsUpdate=!1,M.a.watch("order.once",this.orderOnce),M.a.watch("player.dead",this.onDead),_.a.on("reboot",this.reboot);var e={reset:function(){t.reboot()}};k.a.add(e,"reset")}},{key:"tutorialEnd",value:function(){_.a.off("tutorial.end",this.tutorialEnd),S.a.isRecognizing()||"start"===S.a.getPending()||(C.a.enableSpeech&&S.a.setLang(M.a.get("lang")),S.a.start()),C.a.enableSpeech&&T.a.setLang(M.a.get("lang")),C.a.enableSpeech&&T.a.listen(),b.a.normalView(),this.camIntro=!1,this.timerBeforeWakeup=4e3,M.a.set("radar.status","visible"),M.a.set("status.status","visible"),M.a.set("score.status","visible")}},{key:"orderOnce",value:function(){R.a.updateBgVolume(.17),this.scoreNeedsUpdate=!0,this.timerBeforeWakeup=null,E.a.onWakeup(),M.a.unwatch("order.once",this.orderOnce),this.timerBeforeCopSpawn=4e3}},{key:"gameOverlay",value:function(){S.a.isRecognizing()&&"stop"!==S.a.getPending()&&S.a.stop(),this.intro=!0,this.camIntro=!0,b.a.bankView(!0),this.timerBeforeTuto=2e3,this.timerBeforeWakeup=null,this.timerBeforeCopSpawn=null,_.a.on("tutorial.end",this.tutorialEnd)}},{key:"introUpdate",value:function(t){null!==this.timerBeforeCopSpawn&&(this.timerBeforeCopSpawn<=0?(this.timerBeforeCopSpawn=null,x.a.setSpawn(!0),this.intro=!1):this.timerBeforeCopSpawn-=t),null!==this.timerBeforeTuto&&(this.timerBeforeTuto<=0?(E.a.startTutorial(),this.timerBeforeTuto=null):this.timerBeforeTuto-=t),null!==this.timerBeforeWakeup&&(this.timerBeforeWakeup<=0?(E.a.wakeup(),this.timerBeforeWakeup=null):this.timerBeforeWakeup-=t),this.camIntro&&b.a.specialTarget.dist<.2&&(b.a.specialTarget.dist+=5e-4)}},{key:"update",value:function(t){if(this.scoreNeedsUpdate){this.score=this.score+t/60;var n=Math.floor(this.score);n!==this.score&&M.a.set("score.value",n)}d()(e.prototype.__proto__||o()(e.prototype),"update",this).call(this,t),x.a.update(t),w.a.update(t),b.a.update(t),this.intro&&this.introUpdate(t),this.firstframe&&(setTimeout(function(){return R.a.startBank()},100),this.firstframe=!1)}},{key:"onDead",value:function(t){t&&(this.scoreNeedsUpdate=!1,R.a.updateBgVolume(.032),E.a.gameOver(M.a.get("score.value")))}},{key:"reboot",value:function(){I.a.remove(1),this.score=0,R.a.startBg(),R.a.updateBgVolume(.06,!0),this.scoreNeedsUpdate=!1,M.a.set("score.value",this.score),O.a.setSeed(+new Date),T.a.unlisten(),P.a.reset(),x.a.setSpawn(!1),this.playerCar.reset(),_.a.emit("minimap.reset"),b.a.setTarget(this.playerCar),b.a.normalView(!0),M.a.unwatch("order.once",this.orderOnce),M.a.set("order.once",!1),M.a.watch("order.once",this.orderOnce),this.timerBeforeTuto=null,this.timerBeforeCopSpawn=null,this.intro=!0,this.tutorialEnd()}},{key:"resize",value:function(t){d()(e.prototype.__proto__||o()(e.prototype),"resize",this).call(this,t);var n=t.h/750*(M.a.get("pixelratio")/2);w.a.setScale(n)}}]),e}(v.a);e.a=F},function(t,e,n){"use strict"},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(10),d=n.n(l),f=n(5),p=n.n(f),v=n(17),y=n(9),m=(n(7),n(248)),g=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return p()(e,t),u()(e,[{key:"setup",value:function(){this.chunkAdded=this.chunkAdded.bind(this),this.chunkRemoved=this.chunkRemoved.bind(this),v.a.on("chunk-added",this.chunkAdded),v.a.on("chunk-removed",this.chunkRemoved),this.chunks={},v.a.init()}},{key:"removeChunk",value:function(t){this.chunks[t].destroy(),this.group.remove(this.chunks[t].group),this.chunks[t]=void 0,delete this.chunks[t]}},{key:"addChunk",value:function(t,e){var n=new m.a(e);this.chunks[t]=n,this.group.add(n.group),n.group.position.x=e.x,n.group.position.z=e.y}},{key:"chunkAdded",value:function(t){this.chunks[t.id]&&this.removeChunk(t.id),this.addChunk(t.id,t)}},{key:"chunkRemoved",value:function(t){this.chunks[t.id]&&this.removeChunk(t.id,t)}},{key:"update",value:function(t){for(var e in this.chunks)this.chunks[e].update(t)}},{key:"destroy",value:function(){d()(e.prototype.__proto__||o()(e.prototype),"destroy",this).call(this),v.a.off("chunk-added",this.chunkAdded),v.a.off("chunk-removed",this.chunkAdded)}}]),e}(y.a);e.a=g},function(t,e,n){"use strict";function i(t,e){var n=[];for(var i in e){var o=e[i],r=new g.a(o,e);n.push(r)}var a=new THREE.Geometry;n.forEach(function(t){a.mergeMesh(t.group),t.destroy(),t=void 0}),n=void 0,j[t]=(new THREE.BufferGeometry).fromGeometry(a)}var o=n(3),r=n.n(o),a=n(1),s=n.n(a),u=n(2),c=n.n(u),h=n(4),l=n.n(h),d=n(10),f=n.n(d),p=n(5),v=n.n(p),y=n(0),m=(n(17),n(9)),g=(n(7),n(249)),b=n(250),x=n(251),w=n(252),k=n(253),M=n(254),_=n(255),E=n(256),S=n(257),T=n(258),C=n(259),P=n(260),O=n(261),R=n(262),I=n(263),F=n(264),L={1:{Instance:x.a},2:{Instance:w.a},3:{Instance:k.a},4:{Instance:M.a},5:{Instance:b.a},6:{Instance:_.a},7:{Instance:C.a},8:{Instance:P.a},9:{Instance:O.a},10:{Instance:R.a},11:{Instance:I.a}},z={1:{Instance:E.a},2:{Instance:S.a},3:{Instance:T.a},4:{Instance:F.a}},j={},B=function(t){function e(){return s()(this,e),l()(this,(e.__proto__||r()(e)).apply(this,arguments))}return v()(e,t),c()(e,[{key:"setup",value:function(t){var e=this;t.buildings.forEach(function(n){var i=n[2];if(L[i]){var o={x:n[0],y:n[1],cx:t.x,cy:t.y};L[i].opts&&(o=L[i].opts(o)),e.addComponent(new L[i].Instance(o))}}),t.props.forEach(function(n){var i=n[2];if(z[i]){var o={x:n[0],y:n[1],cx:t.x,cy:t.y};z[i].opts&&(o=z[i].opts(o)),e.addComponent(new z[i].Instance(o))}}),j[t.poolId]||i(t.poolId,t.road),this.meshes.roads=new THREE.Mesh(j[t.poolId],y.a.get("mat.road")),this.group.add(this.meshes.roads)}},{key:"update",value:function(t){f()(e.prototype.__proto__||r()(e.prototype),"update",this).call(this,t)}},{key:"destroy",value:function(){f()(e.prototype.__proto__||r()(e.prototype),"destroy",this).call(this)}}]),e}(m.a);e.a=B},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(10),d=n.n(l),f=n(5),p=n.n(f),v=n(0),y=(n(17),n(9)),m=(n(7),{0:[0,-1],1:[1,0],2:[0,1],3:[-1,0]}),g=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return p()(e,t),u()(e,[{key:"setup",value:function(t,e){var n=15===t.c,i=n?t.t+5:t.t;if(3===i){var o=t.n[t.r+1]%4?1:3,r=m[(t.r+o)%4];15===e[t.p[0]+r[0]+"."+(t.p[1]+r[1])].c&&(i=10)}this.group=new THREE.Mesh(v.a.get("geo.roads")[i],v.a.get("mat.road")),this.group.rotation.y=t.r*Math.PI/2,this.group.position.x=t.p[0]+.5,this.group.position.z=t.p[1]+.5}},{key:"update",value:function(t){d()(e.prototype.__proto__||o()(e.prototype),"update",this).call(this,t)}},{key:"destroy",value:function(){}}]),e}(y.a);e.a=g},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(10),d=n.n(l),f=n(5),p=n.n(f),v=(n(6),n(0)),y=(n(7),n(9)),m=n(8),g=n(13),b=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return p()(e,t),u()(e,[{key:"setup",value:function(t){var e=t.x,n=t.y,i=t.cx,o=t.cy;this.group=new THREE.Mesh(v.a.get("geo.house"),g.a.getMaterial());var r=e+.5,a=n+.5,s=m.a.random()*Math.PI*2+Math.PI;this.body=new p2.Body({position:[-(i+r),o+a],angle:s}),this.body.propType="prop",this.shapeA=this.body.addShape(new p2.Box({width:.4,height:.34}),[.01,-.03]),this.shapeB=this.body.addShape(new p2.Box({width:.03,height:.03}),[.36,.45]),this.group.position.x=-this.body.position[0]-i,this.group.position.y=.012,this.group.position.z=this.body.position[1]-o,this.group.rotation.y=this.body.angle}},{key:"update",value:function(t){}},{key:"destroy",value:function(){d()(e.prototype.__proto__||o()(e.prototype),"destroy",this).call(this)}}]),e}(y.a);e.a=b},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(10),d=n.n(l),f=n(5),p=n.n(f),v=(n(6),n(0)),y=(n(7),n(9)),m=(n(8),n(13)),g=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return p()(e,t),u()(e,[{key:"setup",value:function(t){var e=t.x,n=t.y,i=t.cx,o=t.cy;this.group=new THREE.Mesh(v.a.get("geo.bank"),m.a.getMaterial());var r=e+.5,a=n+.5,s=Math.PI/2;this.body=new p2.Body({position:[-(i+r),o+a],angle:s}),this.body.propType="prop",this.shapeA=this.body.addShape(new p2.Box({width:.7,height:.7}),[0,0]),this.group.position.x=-this.body.position[0]-i,this.group.position.y=.012,this.group.position.z=this.body.position[1]-o,this.group.rotation.y=this.body.angle,v.a.set("prop.bank",this.group)}},{key:"update",value:function(t){}},{key:"destroy",value:function(){d()(e.prototype.__proto__||o()(e.prototype),"destroy",this).call(this)}}]),e}(y.a);e.a=g},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(10),d=n.n(l),f=n(5),p=n.n(f),v=(n(6),n(0)),y=(n(7),n(9)),m=n(8),g=n(13),b=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return p()(e,t),u()(e,[{key:"setup",value:function(t){var e=t.x,n=t.y,i=t.cx,o=t.cy;this.group=new THREE.Mesh(v.a.get("geo.farm"),g.a.getMaterial());var r=e+.5,a=n+.5,s=m.a.random()*Math.PI*2;this.body=new p2.Body({position:[-(i+r),o+a],angle:s}),this.body.propType="prop",this.shapeA=this.body.addShape(new p2.Box({width:.79,height:.555}),[-.03,.085]),this.shapeB=this.body.addShape(new p2.Box({width:.18,height:.18}),[-.03,-.32]),this.group.position.x=-this.body.position[0]-i,this.group.position.y=.012,this.group.position.z=this.body.position[1]-o,this.group.rotation.y=this.body.angle}},{key:"update",value:function(t){}},{key:"destroy",value:function(){d()(e.prototype.__proto__||o()(e.prototype),"destroy",this).call(this)}}]),e}(y.a);e.a=b},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(10),d=n.n(l),f=n(5),p=n.n(f),v=(n(6),n(0)),y=(n(7),n(9)),m=n(8),g=n(13),b=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return p()(e,t),u()(e,[{key:"setup",value:function(t){var e=t.x,n=t.y,i=t.cx,o=t.cy;this.group=new THREE.Mesh(v.a.get("geo.hangar"),g.a.getMaterial());var r=e+.5,a=n+.5,s=m.a.random()*Math.PI*2+Math.PI/2;this.body=new p2.Body({position:[-(i+r),o+a],angle:s}),this.body.propType="prop",this.shapeA=this.body.addShape(new p2.Box({width:.85,height:.72}),[.01,-.07]),this.shapeB=this.body.addShape(new p2.Box({width:.15,height:.15}),[-.34,.35]),this.group.position.x=-this.body.position[0]-i,this.group.position.y=.012,this.group.position.z=this.body.position[1]-o,this.group.rotation.y=this.body.angle}},{key:"update",value:function(t){}},{key:"destroy",value:function(){d()(e.prototype.__proto__||o()(e.prototype),"destroy",this).call(this)}}]),e}(y.a);e.a=b},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(10),d=n.n(l),f=n(5),p=n.n(f),v=(n(6),n(0)),y=(n(7),n(9)),m=n(8),g=n(13),b=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return p()(e,t),u()(e,[{key:"setup",value:function(t){var e=t.x,n=t.y,i=t.cx,o=t.cy;this.group=new THREE.Mesh(v.a.get("geo.station"),g.a.getMaterial());var r=e+.5,a=n+.5,s=m.a.random()*Math.PI*2+Math.PI/2;this.body=new p2.Body({position:[-(i+r),o+a],angle:s}),this.body.propType="prop",this.shapeA=this.body.addShape(new p2.Box({width:.79,height:.36}),[.01,-.2]),this.shapeB=this.body.addShape(new p2.Box({width:.33,height:.09}),[0,.33]),this.group.position.x=-this.body.position[0]-i,this.group.position.y=.012,this.group.position.z=this.body.position[1]-o,this.group.rotation.y=this.body.angle}},{key:"update",value:function(t){}},{key:"destroy",value:function(){d()(e.prototype.__proto__||o()(e.prototype),"destroy",this).call(this)}}]),e}(y.a);e.a=b},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(10),d=n.n(l),f=n(5),p=n.n(f),v=(n(6),n(0)),y=(n(7),n(9)),m=n(8),g=n(13),b=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return p()(e,t),u()(e,[{key:"setup",value:function(t){var e=t.x,n=t.y,i=t.cx,o=t.cy;this.group=new THREE.Mesh(v.a.get("geo.trashyard"),g.a.getMaterial());var r=e+.5,a=n+.5,s=m.a.random()*Math.PI*2+Math.PI;this.body=new p2.Body({position:[-(i+r),o+a],angle:s}),this.body.propType="prop",this.shapeA=this.body.addShape(new p2.Box({width:.8,height:.8}),[-0,-0]),this.group.position.x=-this.body.position[0]-i,this.group.position.y=.012,this.group.position.z=this.body.position[1]-o,this.group.rotation.y=this.body.angle}},{key:"update",value:function(t){}},{key:"destroy",value:function(){d()(e.prototype.__proto__||o()(e.prototype),"destroy",this).call(this)}}]),e}(y.a);e.a=b},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(10),d=n.n(l),f=n(5),p=n.n(f),v=(n(6),n(0)),y=(n(7),n(9)),m=n(8),g=n(13),b={0:"medium",1:"small"},x=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return p()(e,t),u()(e,[{key:"setup",value:function(t){var e=t.x,n=t.y,i=t.cx,o=t.cy,r=m.a.hash2dInt(e+i,n+o,0,1);this.group=new THREE.Mesh(v.a.get("geo.rock."+b[r]),g.a.getMaterial());var a=e+.5,s=n+.5,u=m.a.random()*Math.PI*2+Math.PI/2;this.body=new p2.Body({position:[-(i+a),o+s],angle:u}),this.body.propType="prop",0===r?this.shapeA=this.body.addShape(new p2.Box({width:.35,height:.35}),[0,-.1],-.3):1===r&&(this.shapeA=this.body.addShape(new p2.Box({width:.65,height:.7}),[0,0],-.6)),this.group.position.x=-this.body.position[0]-i,this.group.position.y=.012,this.group.position.z=this.body.position[1]-o,this.group.rotation.y=this.body.angle}},{key:"update",value:function(t){}},{key:"destroy",value:function(){d()(e.prototype.__proto__||o()(e.prototype),"destroy",this).call(this)}}]),e}(y.a);e.a=x},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(10),d=n.n(l),f=n(5),p=n.n(f),v=(n(6),n(0)),y=(n(7),n(9)),m=(n(8),n(13)),g=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return p()(e,t),u()(e,[{key:"setup",value:function(t){var e=t.x,n=t.y,i=t.cx,o=t.cy;this.group=new THREE.Mesh(v.a.get("geo.cactus"),m.a.getMaterial());var r=e+.5,a=n+.5;this.body=new p2.Body({position:[-(i+r),o+a],angle:0}),this.body.propType="prop",this.shapeA=this.body.addShape(new p2.Box({width:.27,height:.27}),[0,0]),this.group.position.x=-this.body.position[0]-i,this.group.position.y=.012,this.group.position.z=this.body.position[1]-o,this.group.rotation.y=this.body.angle,v.a.set("prop.bank",this.group)}},{key:"update",value:function(t){}},{key:"destroy",value:function(){d()(e.prototype.__proto__||o()(e.prototype),"destroy",this).call(this)}}]),e}(y.a);e.a=g},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(10),d=n.n(l),f=n(5),p=n.n(f),v=(n(6),n(0)),y=(n(7),n(9)),m=(n(8),n(13)),g=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return p()(e,t),u()(e,[{key:"setup",value:function(t){var e=t.x,n=t.y,i=t.cx,o=t.cy;this.group=new THREE.Mesh(v.a.get("geo.nature2x"),m.a.getMaterial());var r=e+.5,a=n+.5;this.body=new p2.Body({position:[-(i+r),o+a],angle:0}),this.body.propType="prop",this.shapeA=this.body.addShape(new p2.Box({width:1.4,height:1.5}),[.4,-.5]),this.group.position.x=-this.body.position[0]-i,this.group.position.y=.012,this.group.position.z=this.body.position[1]-o,this.group.rotation.y=this.body.angle,v.a.set("prop.bank",this.group)}},{key:"update",value:function(t){}},{key:"destroy",value:function(){d()(e.prototype.__proto__||o()(e.prototype),"destroy",this).call(this)}}]),e}(y.a);e.a=g},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(10),d=n.n(l),f=n(5),p=n.n(f),v=(n(6),n(0)),y=(n(7),n(9)),m=n(8),g=n(13),b=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return p()(e,t),u()(e,[{key:"setup",value:function(t){var e=t.x,n=t.y,i=t.cx,o=t.cy;this.group=new THREE.Mesh(v.a.get("geo.ad"),g.a.getMaterial());var r=e+.5,a=n+.5,s=m.a.random()*Math.PI*2+Math.PI;this.body=new p2.Body({position:[-(i+r),o+a],angle:s}),this.body.propType="prop",this.shapeA=this.body.addShape(new p2.Box({width:.06,height:.06}),[0,0]),this.group.position.x=-this.body.position[0]-i,this.group.position.y=.012,this.group.position.z=this.body.position[1]-o,this.group.rotation.y=this.body.angle}},{key:"update",value:function(t){}},{key:"destroy",value:function(){d()(e.prototype.__proto__||o()(e.prototype),"destroy",this).call(this)}}]),e}(y.a);e.a=b},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(10),d=n.n(l),f=n(5),p=n.n(f),v=(n(6),n(0)),y=(n(7),n(9)),m=(n(8),n(13)),g=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return p()(e,t),u()(e,[{key:"setup",value:function(t){var e=t.x,n=t.y,i=t.cx,o=t.cy;this.group=new THREE.Mesh(v.a.get("geo.sign"),m.a.getMaterial());var r=e+.5,a=n+.5;this.body=new p2.Body({position:[-(i+r),o+a],angle:-1.35}),this.body.propType="prop",this.shapeA=this.body.addShape(new p2.Box({width:.03,height:.03}),[0,-.25]),this.shapeB=this.body.addShape(new p2.Box({width:.03,height:.03}),[0,.25]),this.group.position.x=-this.body.position[0]-i,this.group.position.y=.012,this.group.position.z=this.body.position[1]-o,this.group.rotation.y=this.body.angle}},{key:"update",value:function(t){}},{key:"destroy",value:function(){d()(e.prototype.__proto__||o()(e.prototype),"destroy",this).call(this)}}]),e}(y.a);e.a=g},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(10),d=n.n(l),f=n(5),p=n.n(f),v=(n(6),n(0)),y=(n(7),n(9)),m=n(8),g=n(13),b=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return p()(e,t),u()(e,[{key:"setup",value:function(t){var e=t.x,n=t.y,i=t.cx,o=t.cy;this.group=new THREE.Mesh(v.a.get("geo.accident"),g.a.getMaterial());var r=e+.5,a=n+.5,s=m.a.random()*Math.PI*2+Math.PI;this.body=new p2.Body({position:[-(i+r),o+a],angle:s}),this.body.propType="prop",this.shapeA=this.body.addShape(new p2.Box({width:.36,height:.16}),[0,.26],-.6),this.group.position.x=-this.body.position[0]-i,this.group.position.y=.012,this.group.position.z=this.body.position[1]-o,this.group.rotation.y=this.body.angle}},{key:"update",value:function(t){}},{key:"destroy",value:function(){d()(e.prototype.__proto__||o()(e.prototype),"destroy",this).call(this)}}]),e}(y.a);e.a=b},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(10),d=n.n(l),f=n(5),p=n.n(f),v=(n(6),n(0)),y=(n(7),n(9)),m=n(8),g=n(13),b=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return p()(e,t),u()(e,[{key:"setup",value:function(t){var e=t.x,n=t.y,i=t.cx,o=t.cy;this.group=new THREE.Mesh(v.a.get("geo.motel"),g.a.getMaterial());var r=e+.5,a=n+.5,s=m.a.random()*Math.PI*2+Math.PI;this.body=new p2.Body({position:[-(i+r),o+a],angle:s}),this.body.propType="prop",this.shapeA=this.body.addShape(new p2.Box({width:.82,height:.56}),[0,0]),this.group.position.x=-this.body.position[0]-i,this.group.position.y=.012,this.group.position.z=this.body.position[1]-o,this.group.rotation.y=this.body.angle}},{key:"update",value:function(t){}},{key:"destroy",value:function(){d()(e.prototype.__proto__||o()(e.prototype),"destroy",this).call(this)}}]),e}(y.a);e.a=b},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(10),d=n.n(l),f=n(5),p=n.n(f),v=(n(6),n(0)),y=(n(7),n(9)),m=n(8),g=n(13),b=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return p()(e,t),u()(e,[{key:"setup",value:function(t){var e=t.x,n=t.y,i=t.cx,o=t.cy;this.group=new THREE.Mesh(v.a.get("geo.cigarette"),g.a.getMaterial());var r=e+.5,a=n+.5,s=m.a.random()*Math.PI*2+Math.PI;this.body=new p2.Body({position:[-(i+r),o+a],angle:s}),this.body.propType="prop",this.shapeA=this.body.addShape(new p2.Box({width:.06,height:.06}),[0,0]),this.group.position.x=-this.body.position[0]-i,this.group.position.y=.012,this.group.position.z=this.body.position[1]-o,this.group.rotation.y=this.body.angle}},{key:"update",value:function(t){}},{key:"destroy",value:function(){d()(e.prototype.__proto__||o()(e.prototype),"destroy",this).call(this)}}]),e}(y.a);e.a=b},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(10),d=n.n(l),f=n(5),p=n.n(f),v=(n(6),n(0)),y=(n(7),n(9)),m=(n(8),n(13)),g=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return p()(e,t),u()(e,[{key:"setup",value:function(t){var e=t.x,n=t.y,i=t.cx,o=t.cy;this.group=new THREE.Mesh(v.a.get("geo.rock.2x"),m.a.getMaterial());var r=e+.5,a=n+.5;this.body=new p2.Body({position:[-(i+r),o+a],angle:0}),this.body.propType="prop",this.body.addShape(new p2.Box({width:.85,height:.9}),[.12,-.7],-.4),this.body.addShape(new p2.Box({width:.89,height:.5}),[.75,.15],0),this.body.addShape(new p2.Box({width:.5,height:.5}),[1.15,-.95],-.4),this.group.position.x=-this.body.position[0]-i,this.group.position.y=.012,this.group.position.z=this.body.position[1]-o,this.group.rotation.y=this.body.angle}},{key:"update",value:function(t){}},{key:"destroy",value:function(){d()(e.prototype.__proto__||o()(e.prototype),"destroy",this).call(this)}}]),e}(y.a);e.a=g},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(10),d=n.n(l),f=n(5),p=n.n(f),v=n(41),y=n.n(v),m=n(17),g=n(0),b=(n(7),n(9),n(97)),x=n(6),w=n(36),k=n(266),M=n(25),_=n(51),E=n(47),S=n(35),T=n(52),C=n(16),P=n(267),O={0:0,1:1.5},R={0:.068,1:.8},I={0:2.9,1:3.5},F={0:Math.PI/3.1,1:Math.PI/3.1},L=y()(O).length,z=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return p()(e,t),u()(e,[{key:"setup",value:function(t){this.chassis=new THREE.Mesh(g.a.get("geo.bandit"),P.a.getMaterial()),this.group.add(this.chassis),this.group.position.y=.0195,this.meshes.shadow=new THREE.Mesh(g.a.get("geo.plane"),g.a.get("mat.shadow"));var e=this.meshes.shadow;e.scale.set(.11,.205,1),e.rotation.x=-Math.PI/2,e.position.set(0,.001,0),this.group.add(this.meshes.shadow),x.a.lofi&&(this.meshes.shadow.visible=!1),this.body=new p2.Body({mass:2,position:[0,.1]}),this.body.propType="player",this.body.impactCallback=this.onImpact.bind(this);var n=new p2.Box({width:.1,height:.21});n.material=new p2.Material,this.body.addShape(n),g.a.set("car.p2material",n.material),this.vehicle=new p2.TopDownVehicle(this.body),this.frontWheel=this.vehicle.addWheel({localPosition:[0,.2]}),this.backWheel=this.vehicle.addWheel({localPosition:[0,-.2]}),this.improvise=!0,this.improvisationTreshold=3,this.running=!1,this.improvisationMode=0,this.debugSteering=!1,this.debugWaypoints=!1,this.manualControls=!1,g.a.set("player.position",[0,0]),g.a.set("player.angle",0),g.a.set("player.vehicle",this),g.a.set("player.body",this.body),this.onOrder=this.onOrder.bind(this),w.a.on(":all",this.onOrder),this.maxLife=40,this.life=this.maxLife,this.lifeIndice=this.life/this.maxLife,P.a.setLife(1),E.a.add(this,"damage").name("Damage Player"),this.frontWheel.steerValue=0,this.frontWheel.targetSteerValue=0,this.backWheel.steerValue=0,this.backWheel.targetSteerValue=0,this.engineForce=0,this.backWheel.setBrakeForce(3),x.a.manualDrive?(Object(k.a)(this.frontWheel,this.backWheel),this.manualControls=!0):this.manualControls=!1,this.isPlayer=!0,this.speedLevel=0,this.updateSteerValue()}},{key:"onImpact",value:function(t){"cop"===t.impactType?(this.damage(10),C.a.emit("stress.add",.04)):C.a.emit("stress.add",.02)}},{key:"damage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;this.life=Math.max(0,this.life-t),this.lifeIndice=this.life/this.maxLife,this.smokeDensity=5*(1-this.lifeIndice),P.a.setLife(this.lifeIndice),C.a.emit("player.damage"),this.life<=0&&this.explode()}},{key:"didDie",value:function(){this.smokeDensity=15,_.a.emit({x:this.group.position.x,y:.1,z:this.group.position.z,type:2,amount:55}),_.a.emit({x:this.group.position.x,y:.1,z:this.group.position.z,type:3,amount:25}),M.a.addCameraShake(1.2),g.a.set("player.dead",!0)}},{key:"limitSpeed",value:function(){d()(e.prototype.__proto__||o()(e.prototype),"limitSpeed",this).call(this,O[this.speedLevel])}},{key:"update",value:function(t){T.a.panic?T.a.remove(.004):0===this.speedLevel?T.a.remove(6e-4):1===this.speedLevel&&T.a.add(.001),d()(e.prototype.__proto__||o()(e.prototype),"update",this).call(this,t,T.a.panic),this.meshes.shadow.rotation.z=this.chassis.rotation.y,g.a.set("player.velocity",this.body.velocity),g.a.set("player.position",[this.group.position.x,this.group.position.z]),g.a.set("player.angle",this.chassis.rotation.y),m.a.updateCenter(this.group.position.x,this.group.position.z),S.a.updateEngine(this.body.velocity,this.body.angularVelocity,this.speedLevel,!!this.dead)}},{key:"onOrder",value:function(t){return"start"===t.type?(g.a.get("order.once")||g.a.set("order.once",!0),this.manualControls=!1,void(this.running=!0)):("goStraight"===t.type&&(g.a.get("order.once")||g.a.set("order.once",!0),this.manualControls=!1,this.running=!0,this.waypoints.goStraight()),"goLeft"===t.type&&(g.a.get("order.once")||g.a.set("order.once",!0),this.manualControls=!1,this.running=!0,this.waypoints.turnLeft()),"goRight"===t.type&&(g.a.get("order.once")||g.a.set("order.once",!0),this.manualControls=!1,this.running=!0,this.waypoints.turnRight()),"turnBack"===t.type&&(g.a.get("order.once")||g.a.set("order.once",!0),this.manualControls=!1,this.running=!0,this.waypoints.turnBack()),"stop"===t.type?void(this.running=!1):("goManual"===t.type&&(this.frontWheel.steerValue=0,this.frontWheel.targetSteerValue=0,this.backWheel.steerValue=0,this.backWheel.targetSteerValue=0,this.engineForce=0,this.backWheel.setBrakeForce(3),this.manualControls=!0,Object(k.a)(this.frontWheel,this.backWheel)),"speedUp"===t.type&&(this.speedLevel=this.speedLevel>=L-1?L-1:this.speedLevel+1,this.updateSteerValue()),void("speedDown"===t.type&&(this.speedLevel=this.speedLevel<=0?0:this.speedLevel-1,this.updateSteerValue()))))}},{key:"updateSteerValue",value:function(){this.lerpSteerValue=R[this.speedLevel],this.backWheelFriction=I[this.speedLevel],this.maxSteer=F[this.speedLevel]}},{key:"reset",value:function(){this.body.position[0]=0,this.body.position[1]=0,this.group.position.x=0,this.group.position.z=0,this.body.velocity[0]=0,this.body.velocity[1]=0,this.frontWheel.targetSteerValue=0,this.frontWheel.steerValue=0,this.engineForce=0,this.frontWheel.engineForce=0,this.body.angle=0,this.body.angularVelocity=0,this.chassis.rotation.y=0,this.chassis.rotation.x=0,this.chassis.rotation.z=0,g.a.set("player.velocity",this.body.velocity),g.a.set("player.position",[this.group.position.x,this.group.position.z]),g.a.set("player.angle",this.chassis.rotation.y),g.a.set("player.dead",!1),this.life=this.maxLife,this.lifeIndice=this.life/this.maxLife,P.a.setLife(1),this.alreadyDead=!1,this.dead=!1,this.running=!1,this.smokeDensity=0,this.smokeTimer=0,this.sandDensity=0,this.sandTimer=0,this.steerSmokeDensity=0,this.steerSmokeTimer=0,this.speed=0,this.speedLevel=0,this.updateSteerValue(),this.needsBackwardScore=0,this.needsBackward=!1,this.antiObstacleScore=0,this.antiObstacle=!1,this.antiObstacleDir=1,this.body.propType="player",this.body.impactCallback=this.onImpact.bind(this),this.waypoints.cancelAll(),this.waypoints.preLastReachPos=null,this.waypoints.lastReachPos=null}},{key:"destroy",value:function(){w.a.off(":all",this.onOrder),d()(e.prototype.__proto__||o()(e.prototype),"destroy",this).call(this)}}]),e}(b.a);e.a=z},function(t,e,n){"use strict";function i(t,e){function n(){t.targetSteerValue=o*(i[37]-i[39]),e.targetSteerValue=o*(i[37]-i[39]),t.engineForce=5*i[38],e.setBrakeForce(3),i[40]&&(e.getSpeed()>.1?e.setBrakeForce(5):(e.setBrakeForce(0),t.engineForce=-2))}var i={37:0,39:0,38:0,40:0},o=Math.PI/3.6;document.addEventListener("keydown",function(t){i[t.keyCode]=1,n()}),document.addEventListener("keyup",function(t){i[t.keyCode]=0,n()})}e.a=i},function(t,e,n){"use strict";function i(){h=new THREE.ShaderMaterial({vertexShader:s.a,fragmentShader:c.a,uniforms:{texture:{type:"t",value:r.a.get("tex.vehicles")},life:{type:"f",value:1}}})}function o(t){h.uniforms.life.value=t,h.uniforms.life.needsUpdate=!0}var r=n(0),a=n(268),s=n.n(a),u=n(269),c=n.n(u),h=void 0;e.a={setup:i,getMaterial:function(){return h||i(),h},setLife:o}},function(t,e){t.exports="#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main() {\n  vec4 t = viewMatrix * modelMatrix * vec4( position, 1.0 );\n\n  vUv = uv;\n\n  float attenuate = 0.0005;\n  float spread = 20.;\n\n  vec4 wpos = modelMatrix * vec4( position, 1.0 );\n  vec3 cpos = cameraPosition.xyz;\n\n  float dx = wpos.x - cpos.x;\n  float dz = wpos.z - cpos.z;\n  float p = (dx * dx + dz * dz);\n\n  float distz = max(0., abs(attenuate - p) - spread);\n  wpos.y -= distz * distz * attenuate;\n\n  // vFall = 0.08 + wpos.y;\n\n  gl_Position = projectionMatrix * viewMatrix * wpos;\n}"},function(t,e){t.exports="#define GLSLIFY 1\nvarying vec2 vUv;\nuniform sampler2D texture;\nuniform float life;\n\nvoid main() {\n  float offset = max(sign(life), 0.0) * 0.5;\n\n  vec4 cleanCar = texture2D(texture, vUv);\n  vec4 badCar = texture2D(texture, vec2(vUv.x + 0.5, vUv.y - offset));\n  vec4 dmgMap = texture2D(texture, vec2(vUv.x, vUv.y - 0.5));\n\n  float t = (1. - max(sign(dmgMap.r - life), 0.0));\n\n  gl_FragColor = cleanCar * t + (1. - t) * badCar;\n}"},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(10),d=n.n(l),f=n(5),p=n.n(f),v=(n(6),n(0)),y=(n(7),n(9)),m=n(271),g=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return p()(e,t),u()(e,[{key:"setup",value:function(){this.group=new THREE.Mesh(new THREE.PlaneBufferGeometry(20,20,20,20),m.a.getMaterial()),this.group.rotation.x=-Math.PI/2,this.group.position.set(0,.01,0)}},{key:"update",value:function(t){var e=v.a.get("player.position");this.group.position.x=e[0],this.group.position.z=e[1]}},{key:"destroy",value:function(){d()(e.prototype.__proto__||o()(e.prototype),"destroy",this).call(this)}}]),e}(y.a);e.a=g},function(t,e,n){"use strict";function i(){c=new THREE.ShaderMaterial({vertexShader:r.a,fragmentShader:s.a,uniforms:{texture:{type:"t",value:u.a.get("tex.props")}}})}var o=n(272),r=n.n(o),a=n(273),s=n.n(a),u=n(0),c=void 0;e.a={setup:i,getMaterial:function(){return c||i(),c}}},function(t,e){t.exports="#define GLSLIFY 1\nvarying vec3 vPos;\n\nvoid main() {\n  vec4 wpos = modelMatrix * vec4( position, 1.0 );\n  vec3 cpos = cameraPosition.xyz;\n\n  vPos = wpos.xyz;\n\n  float attenuate = 0.00038;\n  float spread = 20.;\n\n  float dx = wpos.x - cpos.x;\n  float dz = wpos.z - cpos.z;\n  float p = (dx * dx + dz * dz);\n\n  float distz = max(0., abs(attenuate - p) - spread);\n  wpos.y -= distz * distz * attenuate;\n\n  gl_Position = projectionMatrix * viewMatrix * wpos;\n}"},function(t,e){t.exports="#define GLSLIFY 1\nvarying vec3 vPos;\nuniform sampler2D texture;\n\nfloat random (vec2 s, float offset) {\n  return fract(sin(dot(mod(s.xy, 50.) + offset,vec2(12.9898,78.233)))*43758.5453123);\n}\n\nvoid main() {\n  // if (vFall < 0.) discard;\n\n  vec2 uv = vec2(0, 0);\n  uv.x = mod(vPos.x * 0.08, .0625);\n  uv.y = mod(vPos.z * 0.08, .0625) + .3125;\n\n  gl_FragColor = texture2D(texture, uv);\n\n  // vec3 sand = vec3(1.000, 0.855, 0.282);\n\n  // vec2 uv = vPos.xz;\n\n  // vec2 px = floor(uv * 50.0);\n  // float r1 = random(px, 1000.);\n\n  // float c1 = max(0., step(r1, 0.02)) * 0.4;\n\n  // vec2 px2 = floor(uv * 80.);\n  // float r2 = random(px2, 3000.);\n\n  // float c2 = max(0., r2 - 0.6) * 0.5;\n\n  // vec3 color = sand +\n  //   vec3(0., -c2 * 0.2, c2 * -0.8) +\n  //   vec3(0., -c1 * 0.2, -c1 * 0.6);\n\n  // gl_FragColor = vec4(color, 1.);\n}"},function(t,e,n){"use strict";function i(){k||(k=new y.a)}function o(){k||i(),k.mount(document.querySelector(".game-gui"))}function r(){k.show()}function a(){k.hide()}function s(){M&&M.hide().then(function(){return M.destroy()}),k.refs.base.classList.remove("visible"),v.a.set("radar.status","visible"),v.a.set("status.status","visible"),v.a.set("score.status","visible"),window.setTimeout(function(){return b.a.emit("tutorial.end")},500)}function u(){M=new g.a({class:"introduction-popin",label:"intro.gps",skip:"intro.button.skip",next:"intro.button.next"}),M.mount(k.refs.base),M.show();var t=M;M.onnext=function(){t.hide().then(function(){return t.destroy()}),c()},M.onskip=function(){s()}}function c(){M=new g.a({class:"introduction-popin",label:"intro.police",skip:"intro.button.skip",next:"intro.button.next"}),M.mount(k.refs.base),M.show(),v.a.set("radar.status","visible");var t=M;M.onnext=function(){t.hide().then(function(){return t.destroy()}),h()},M.onskip=function(){s()}}function h(){M=new g.a({class:"introduction-popin",label:"intro.stress",next:"intro.button.start"}),M.mount(k.refs.base),M.show(),v.a.set("radar.status","transparent"),v.a.set("status.status","visible");var t=M;M.onnext=function(){t.hide().then(function(){return t.destroy()}),s()},M.onskip=function(){s()}}function l(){k.refs.base.classList.add("visible"),u()}function d(){_&&(M&&M.hide().then(function(){return M.destroy()}),k.refs.base.classList.remove("visible"),_=!1)}function f(){_=!0,k.refs.base.classList.add("visible"),M=new g.a({class:"introduction-popin",label:"intro.wakeup"}),M.mount(k.refs.base),M.show()}function p(t){setTimeout(function(){v.a.set("radar.status","hidden"),v.a.set("status.status","hidden"),v.a.set("score.status","hidden"),b.a.emit("bubbles.reset"),k.refs.base.classList.add("visible");var e=new w.a({score:t});e.mount(k.refs.base),e.onrestart=function(){x.a.show().then(function(){return b.a.emit("reboot")}).then(function(){return e.destroy()}).then(function(){return k.refs.base.classList.remove("visible")}).then(function(){return x.a.hide()})},e.show()},1e3)}var v=n(0),y=(n(25),n(275)),m=n(21),g=n(276),b=(n(36),n(45),n(6),n(16)),x=n(102),w=n(277),k=void 0,M=void 0,_=(m.a,!1);e.a={gameOver:p,onWakeup:d,wakeup:f,setup:i,mount:o,show:r,hide:a,startTutorial:l}},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(5),d=n.n(l),f=n(18),p=(n.n(f),n(11)),v=(n(72),function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return d()(e,t),u()(e,[{key:"didInit",value:function(){}},{key:"render",value:function(){var t=document.createElement("section");return t.classList.add("gui-introduction"),t}},{key:"show",value:function(){}},{key:"hide",value:function(){}},{key:"didMount",value:function(t){}}]),e}(p.a));e.a=v},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(5),d=n.n(l),f=n(18),p=n.n(f),v=n(11),y=n(72),m=n(0),g=n(28),b=n(21),x=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return d()(e,t),u()(e,[{key:"didInit",value:function(t){this.class=t.class,this.label=t.label,this.nextlabel=t.next,this.skiplabel=t.skip,this.onskip=b.a,this.onnext=b.a,this.skiplabel&&(this.skip=new y.a({label:this.skiplabel,class:"button button-skip"})),this.nextlabel&&(this.next=new y.a({label:this.nextlabel,class:"button button-next"}))}},{key:"render",value:function(){var t=document.createElement("div");t.className=this.class;var e=document.createElement("p");e.classList.add("popin-message"),e.innerHTML=g.a[m.a.get("lang")][this.label],e.dataset.filltxt=g.a[m.a.get("lang")][this.label+".escaped"]||g.a[m.a.get("lang")][this.label];var n=document.createElement("div");return n.classList.add("popin-buttons"),t.appendChild(e),t.appendChild(n),this.refs.msg=e,this.refs.buttons=n,t}},{key:"show",value:function(){return this.refs.base.classList.add("touchable"),this.anims.msg=p()({targets:this.refs.msg,translateY:["100px","0"],opacity:[0,1],duration:800}),this.skip&&(this.anims.skip=p()({targets:this.skip.refs.base,translateY:["100px","0"],opacity:[0,1],duration:800,delay:70})),this.next&&(this.anims.next=p()({targets:this.next.refs.base,translateY:["100px","0"],opacity:[0,1],duration:800,delay:140})),this.next?this.anims.next.finished:this.skip?this.anims.skip.finished:this.anims.msg.finished}},{key:"hide",value:function(){return this.refs.base.classList.remove("touchable"),this.anims.msg=p()({targets:this.refs.msg,translateY:[0,-30],opacity:[1,0],duration:500,easing:"easeOutExpo"}),this.skip&&(this.anims.skip=p()({targets:this.skip.refs.base,translateY:[0,-30],opacity:[1,0],duration:500,delay:70,easing:"easeOutExpo"})),this.next&&(this.anims.next=p()({targets:this.next.refs.base,translateY:[0,-30],opacity:[1,0],duration:500,delay:140,easing:"easeOutExpo"})),this.next?this.anims.next.finished:this.skip?this.anims.skip.finished:this.anims.msg.finished}},{key:"didMount",value:function(t){var e=this;this.skip&&(this.skip.onclick=function(){e.onskip()},this.skip.mount(this.refs.buttons)),this.next&&(this.next.onclick=function(){e.onnext()},this.next.mount(this.refs.buttons))}},{key:"willUnmount",value:function(t){this.onskip=b.a,this.onnext=b.a,this.skip&&(this.skip.onclick=b.a,this.skip.destroy(this.refs.buttons)),this.next&&(this.next.onclick=b.a,this.next.destroy(this.refs.buttons))}}]),e}(v.a);e.a=x},function(t,e,n){"use strict";var i=n(3),o=n.n(i),r=n(1),a=n.n(r),s=n(2),u=n.n(s),c=n(4),h=n.n(c),l=n(5),d=n.n(l),f=n(18),p=n.n(f),v=n(11),y=n(72),m=n(0),g=n(28),b=n(21),x=n(104),w=n.n(x),k=function(t){function e(){return a()(this,e),h()(this,(e.__proto__||o()(e)).apply(this,arguments))}return d()(e,t),u()(e,[{key:"didInit",value:function(t){this.score=t.score,this.class="gameover-popin",this.onskip=b.a,this.onnext=b.a,this.restart=new y.a({label:"over.cta",class:"button button-restart"})}},{key:"render",value:function(){var t=document.createElement("div");t.className=this.class;var e=document.createElement("p");e.classList.add("popin-title"),e.innerHTML=g.a[m.a.get("lang")]["over.title"],e.dataset.filltxt=g.a[m.a.get("lang")]["over.title"];var n=document.createElement("p");n.classList.add("popin-score");var i=w()(""+this.score,5,"0")+(+this.score>2?"pts":"pt");n.innerHTML=i,n.dataset.filltxt=i;var o=document.createElement("p");o.classList.add("popin-subtitle");var r=void 0;return r=this.score<500?g.a[m.a.get("lang")]["over.sub"][0]:this.score<2e3?g.a[m.a.get("lang")]["over.sub"][1]:g.a[m.a.get("lang")]["over.sub"][2],o.innerHTML=r,o.dataset.filltxt=r,t.appendChild(e),t.appendChild(n),t.appendChild(o),this.refs.title=e,this.refs.score=n,this.refs.subtitle=o,t}},{key:"show",value:function(){this.refs.base.classList.add("touchable"),this.anims.title=p()({targets:this.refs.title,scale:[3,1],rotate:["-45deg","0"],opacity:[0,1],duration:800}),this.anims.score=p()({targets:this.refs.score,translateY:["100px","0"],opacity:[0,1],duration:800,delay:470}),this.anims.subtitle=p()({targets:this.refs.subtitle,translateY:["100px","0"],opacity:[0,1],duration:800,delay:540}),this.anims.restart=p()({targets:this.restart.refs.base,translateY:["100px","0"],opacity:[0,1],duration:800,delay:610})}},{key:"hide",value:function(){this.refs.base.classList.remove("touchable")}},{key:"didMount",value:function(t){var e=this;this.restart.onclick=function(){e.onrestart()},this.restart.mount(t)}},{key:"willUnmount",value:function(t){this.onrestart=b.a,this.restart.onclick=b.a,this.restart.destroy()}}]),e}(v.a);e.a=k},function(t,e){}]);
//# sourceMappingURL=9524e3b35c30e32e1383.js.map